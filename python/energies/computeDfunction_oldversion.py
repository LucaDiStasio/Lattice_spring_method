# Autogenerated with SMOP 
from smop.core import *
# 

    
@function
def computeDfunction(t=None,N=None,Nx=None,Ny=None,lattice=None,vel=None,dsthandle=None,dshhandle=None,dbehandle=None,indicesbulk=None,indicesinternalbulk=None,indicesF1=None,indicesF2=None,indicesF3=None,indicesF4=None,indicesF5=None,indicesF6=None,indicesinternalF1=None,indicesinternalF2=None,indicesinternalF3=None,indicesinternalF4=None,indicesinternalF5=None,indicesinternalF6=None,indicesE1=None,indicesE2=None,indicesE3=None,indicesE4=None,indicesE5=None,indicesE6=None,indicesE7=None,indicesE8=None,indicesE9=None,indicesE10=None,indicesE11=None,indicesE12=None,indicesinternalE1=None,indicesinternalE2=None,indicesinternalE3=None,indicesinternalE4=None,indicesinternalE5=None,indicesinternalE6=None,indicesinternalE7=None,indicesinternalE8=None,indicesinternalE9=None,indicesinternalE10=None,indicesinternalE11=None,indicesinternalE12=None,indicesC1=None,indicesC2=None,indicesC3=None,indicesC4=None,indicesC5=None,indicesC6=None,indicesC7=None,indicesC8=None,indicesinternalC1=None,indicesinternalC2=None,indicesinternalC3=None,indicesinternalC4=None,indicesinternalC5=None,indicesinternalC6=None,indicesinternalC7=None,indicesinternalC8=None,*args,**kwargs):
    varargin = computeDfunction.varargin
    nargin = computeDfunction.nargin

    ##
#        Project: Fluid - structure interaction on deformable surfaces
#         Author: Luca Di Stasio
#    Institution: ETH Zrich
#                 Institute for Building Materials
# Research group: Computational Physics for Engineering Materials
#        Version: 0.1
#  Creation date: July 2nd, 2014
#    Last update: July 2nd, 2014
    
    #    Description: 
#          Input: 
#         Output:
    
    ##
    
    Dfuncp=zeros(N,1)
    ##
    
    # ---> structural springs
    
    Dfuncp[indicesbulk,:]=multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesbulk + 1,7:9] + lattice[indicesbulk,7:9])),t]),sum((multiply(sum((multiply((vel[indicesbulk,:] - vel[indicesbulk + 1,:]),(((lattice[indicesbulk + 1,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + 1,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))),2),(((lattice[indicesbulk + 1,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + 1,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesbulk - 1,7:9] + lattice[indicesbulk,7:9])),t]),sum((multiply(sum((multiply((vel[indicesbulk,:] - vel[indicesbulk - 1,:]),(((lattice[indicesbulk - 1,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk - 1,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))),2),(((lattice[indicesbulk - 1,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk - 1,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesbulk + Nx,7:9] + lattice[indicesbulk,7:9])),t]),sum((multiply(sum((multiply((vel[indicesbulk,:] - vel[indicesbulk + Nx,:]),(((lattice[indicesbulk + Nx,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + Nx,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))),2),(((lattice[indicesbulk + Nx,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + Nx,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesbulk - Nx,7:9] + lattice[indicesbulk,7:9])),t]),sum((multiply(sum((multiply((vel[indicesbulk,:] - vel[indicesbulk - Nx,:]),(((lattice[indicesbulk - Nx,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk - Nx,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))),2),(((lattice[indicesbulk - Nx,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk - Nx,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesbulk + dot(Nx,Ny),7:9] + lattice[indicesbulk,7:9])),t]),sum((multiply(sum((multiply((vel[indicesbulk,:] - vel[indicesbulk + dot(Nx,Ny),:]),(((lattice[indicesbulk + dot(Nx,Ny),7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + dot(Nx,Ny),7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))),2),(((lattice[indicesbulk + dot(Nx,Ny),7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + dot(Nx,Ny),7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesbulk - dot(Nx,Ny),7:9] + lattice[indicesbulk,7:9])),t]),sum((multiply(sum((multiply((vel[indicesbulk,:] - vel[indicesbulk - dot(Nx,Ny),:]),(((lattice[indicesbulk - dot(Nx,Ny),7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk - dot(Nx,Ny),7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))),2),(((lattice[indicesbulk - dot(Nx,Ny),7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk - dot(Nx,Ny),7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesF1,:]=multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesF1 + 1,7:9] + lattice[indicesF1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF1,:] - vel[indicesF1 + 1,:]),(((lattice[indicesF1 + 1,7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 + 1,7:9] - lattice[indicesF1,7:9]) ** 2,2)))))),2),(((lattice[indicesF1 + 1,7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 + 1,7:9] - lattice[indicesF1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesF1 - 1,7:9] + lattice[indicesF1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF1,:] - vel[indicesF1 - 1,:]),(((lattice[indicesF1 - 1,7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 - 1,7:9] - lattice[indicesF1,7:9]) ** 2,2)))))),2),(((lattice[indicesF1 - 1,7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 - 1,7:9] - lattice[indicesF1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesF1 + Nx,7:9] + lattice[indicesF1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF1,:] - vel[indicesF1 + Nx,:]),(((lattice[indicesF1 + Nx,7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 + Nx,7:9] - lattice[indicesF1,7:9]) ** 2,2)))))),2),(((lattice[indicesF1 + Nx,7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 + Nx,7:9] - lattice[indicesF1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesF1 - Nx,7:9] + lattice[indicesF1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF1,:] - vel[indicesF1 - Nx,:]),(((lattice[indicesF1 - Nx,7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 - Nx,7:9] - lattice[indicesF1,7:9]) ** 2,2)))))),2),(((lattice[indicesF1 - Nx,7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 - Nx,7:9] - lattice[indicesF1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesF1 + dot(Nx,Ny),7:9] + lattice[indicesF1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF1,:] - vel[indicesF1 + dot(Nx,Ny),:]),(((lattice[indicesF1 + dot(Nx,Ny),7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 + dot(Nx,Ny),7:9] - lattice[indicesF1,7:9]) ** 2,2)))))),2),(((lattice[indicesF1 + dot(Nx,Ny),7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 + dot(Nx,Ny),7:9] - lattice[indicesF1,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesF2,:]=multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesF2 + 1,7:9] + lattice[indicesF2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF2,:] - vel[indicesF2 + 1,:]),(((lattice[indicesF2 + 1,7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 + 1,7:9] - lattice[indicesF2,7:9]) ** 2,2)))))),2),(((lattice[indicesF2 + 1,7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 + 1,7:9] - lattice[indicesF2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesF2 - 1,7:9] + lattice[indicesF2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF2,:] - vel[indicesF2 - 1,:]),(((lattice[indicesF2 - 1,7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 - 1,7:9] - lattice[indicesF2,7:9]) ** 2,2)))))),2),(((lattice[indicesF2 - 1,7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 - 1,7:9] - lattice[indicesF2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesF2 + Nx,7:9] + lattice[indicesF2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF2,:] - vel[indicesF2 + Nx,:]),(((lattice[indicesF2 + Nx,7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 + Nx,7:9] - lattice[indicesF2,7:9]) ** 2,2)))))),2),(((lattice[indicesF2 + Nx,7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 + Nx,7:9] - lattice[indicesF2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesF2 + dot(Nx,Ny),7:9] + lattice[indicesF2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF2,:] - vel[indicesF2 + dot(Nx,Ny),:]),(((lattice[indicesF2 + dot(Nx,Ny),7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 + dot(Nx,Ny),7:9] - lattice[indicesF2,7:9]) ** 2,2)))))),2),(((lattice[indicesF2 + dot(Nx,Ny),7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 + dot(Nx,Ny),7:9] - lattice[indicesF2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesF2 - dot(Nx,Ny),7:9] + lattice[indicesF2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF2,:] - vel[indicesF2 - dot(Nx,Ny),:]),(((lattice[indicesF2 - dot(Nx,Ny),7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 - dot(Nx,Ny),7:9] - lattice[indicesF2,7:9]) ** 2,2)))))),2),(((lattice[indicesF2 - dot(Nx,Ny),7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 - dot(Nx,Ny),7:9] - lattice[indicesF2,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesF3,:]=multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesF3 - 1,7:9] + lattice[indicesF3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF3,:] - vel[indicesF3 - 1,:]),(((lattice[indicesF3 - 1,7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 - 1,7:9] - lattice[indicesF3,7:9]) ** 2,2)))))),2),(((lattice[indicesF3 - 1,7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 - 1,7:9] - lattice[indicesF3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesF3 + Nx,7:9] + lattice[indicesF3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF3,:] - vel[indicesF3 + Nx,:]),(((lattice[indicesF3 + Nx,7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 + Nx,7:9] - lattice[indicesF3,7:9]) ** 2,2)))))),2),(((lattice[indicesF3 + Nx,7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 + Nx,7:9] - lattice[indicesF3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesF3 - Nx,7:9] + lattice[indicesF3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF3,:] - vel[indicesF3 - Nx,:]),(((lattice[indicesF3 - Nx,7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 - Nx,7:9] - lattice[indicesF3,7:9]) ** 2,2)))))),2),(((lattice[indicesF3 - Nx,7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 - Nx,7:9] - lattice[indicesF3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesF3 + dot(Nx,Ny),7:9] + lattice[indicesF3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF3,:] - vel[indicesF3 + dot(Nx,Ny),:]),(((lattice[indicesF3 + dot(Nx,Ny),7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 + dot(Nx,Ny),7:9] - lattice[indicesF3,7:9]) ** 2,2)))))),2),(((lattice[indicesF3 + dot(Nx,Ny),7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 + dot(Nx,Ny),7:9] - lattice[indicesF3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesF3 - dot(Nx,Ny),7:9] + lattice[indicesF3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF3,:] - vel[indicesF3 - dot(Nx,Ny),:]),(((lattice[indicesF3 - dot(Nx,Ny),7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 - dot(Nx,Ny),7:9] - lattice[indicesF3,7:9]) ** 2,2)))))),2),(((lattice[indicesF3 - dot(Nx,Ny),7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 - dot(Nx,Ny),7:9] - lattice[indicesF3,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesF4,:]=multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesF4 + 1,7:9] + lattice[indicesF4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF4,:] - vel[indicesF4 + 1,:]),(((lattice[indicesF4 + 1,7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 + 1,7:9] - lattice[indicesF4,7:9]) ** 2,2)))))),2),(((lattice[indicesF4 + 1,7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 + 1,7:9] - lattice[indicesF4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesF4 - 1,7:9] + lattice[indicesF4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF4,:] - vel[indicesF4 - 1,:]),(((lattice[indicesF4 - 1,7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 - 1,7:9] - lattice[indicesF4,7:9]) ** 2,2)))))),2),(((lattice[indicesF4 - 1,7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 - 1,7:9] - lattice[indicesF4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesF4 - Nx,7:9] + lattice[indicesF4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF4,:] - vel[indicesF4 - Nx,:]),(((lattice[indicesF4 - Nx,7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 - Nx,7:9] - lattice[indicesF4,7:9]) ** 2,2)))))),2),(((lattice[indicesF4 - Nx,7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 - Nx,7:9] - lattice[indicesF4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesF4 + dot(Nx,Ny),7:9] + lattice[indicesF4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF4,:] - vel[indicesF4 + dot(Nx,Ny),:]),(((lattice[indicesF4 + dot(Nx,Ny),7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 + dot(Nx,Ny),7:9] - lattice[indicesF4,7:9]) ** 2,2)))))),2),(((lattice[indicesF4 + dot(Nx,Ny),7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 + dot(Nx,Ny),7:9] - lattice[indicesF4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesF4 - dot(Nx,Ny),7:9] + lattice[indicesF4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF4,:] - vel[indicesF4 - dot(Nx,Ny),:]),(((lattice[indicesF4 - dot(Nx,Ny),7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 - dot(Nx,Ny),7:9] - lattice[indicesF4,7:9]) ** 2,2)))))),2),(((lattice[indicesF4 - dot(Nx,Ny),7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 - dot(Nx,Ny),7:9] - lattice[indicesF4,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesF5,:]=multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesF5 + 1,7:9] + lattice[indicesF5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF5,:] - vel[indicesF5 + 1,:]),(((lattice[indicesF5 + 1,7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 + 1,7:9] - lattice[indicesF5,7:9]) ** 2,2)))))),2),(((lattice[indicesF5 + 1,7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 + 1,7:9] - lattice[indicesF5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesF5 + Nx,7:9] + lattice[indicesF5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF5,:] - vel[indicesF5 + Nx,:]),(((lattice[indicesF5 + Nx,7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 + Nx,7:9] - lattice[indicesF5,7:9]) ** 2,2)))))),2),(((lattice[indicesF5 + Nx,7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 + Nx,7:9] - lattice[indicesF5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesF5 - Nx,7:9] + lattice[indicesF5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF5,:] - vel[indicesF5 - Nx,:]),(((lattice[indicesF5 - Nx,7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 - Nx,7:9] - lattice[indicesF5,7:9]) ** 2,2)))))),2),(((lattice[indicesF5 - Nx,7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 - Nx,7:9] - lattice[indicesF5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesF5 + dot(Nx,Ny),7:9] + lattice[indicesF5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF5,:] - vel[indicesF5 + dot(Nx,Ny),:]),(((lattice[indicesF5 + dot(Nx,Ny),7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 + dot(Nx,Ny),7:9] - lattice[indicesF5,7:9]) ** 2,2)))))),2),(((lattice[indicesF5 + dot(Nx,Ny),7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 + dot(Nx,Ny),7:9] - lattice[indicesF5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesF5 - dot(Nx,Ny),7:9] + lattice[indicesF5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF5,:] - vel[indicesF5 - dot(Nx,Ny),:]),(((lattice[indicesF5 - dot(Nx,Ny),7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 - dot(Nx,Ny),7:9] - lattice[indicesF5,7:9]) ** 2,2)))))),2),(((lattice[indicesF5 - dot(Nx,Ny),7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 - dot(Nx,Ny),7:9] - lattice[indicesF5,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesF6,:]=multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesF6 + 1,7:9] + lattice[indicesF6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF6,:] - vel[indicesF6 + 1,:]),(((lattice[indicesF6 + 1,7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 + 1,7:9] - lattice[indicesF6,7:9]) ** 2,2)))))),2),(((lattice[indicesF6 + 1,7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 + 1,7:9] - lattice[indicesF6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesF6 - 1,7:9] + lattice[indicesF6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF6,:] - vel[indicesF6 - 1,:]),(((lattice[indicesF6 - 1,7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 - 1,7:9] - lattice[indicesF6,7:9]) ** 2,2)))))),2),(((lattice[indicesF6 - 1,7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 - 1,7:9] - lattice[indicesF6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesF6 + Nx,7:9] + lattice[indicesF6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF6,:] - vel[indicesF6 + Nx,:]),(((lattice[indicesF6 + Nx,7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 + Nx,7:9] - lattice[indicesF6,7:9]) ** 2,2)))))),2),(((lattice[indicesF6 + Nx,7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 + Nx,7:9] - lattice[indicesF6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesF6 - Nx,7:9] + lattice[indicesF6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF6,:] - vel[indicesF6 - Nx,:]),(((lattice[indicesF6 - Nx,7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 - Nx,7:9] - lattice[indicesF6,7:9]) ** 2,2)))))),2),(((lattice[indicesF6 - Nx,7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 - Nx,7:9] - lattice[indicesF6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesF6 - dot(Nx,Ny),7:9] + lattice[indicesF6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF6,:] - vel[indicesF6 - dot(Nx,Ny),:]),(((lattice[indicesF6 - dot(Nx,Ny),7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 - dot(Nx,Ny),7:9] - lattice[indicesF6,7:9]) ** 2,2)))))),2),(((lattice[indicesF6 - dot(Nx,Ny),7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 - dot(Nx,Ny),7:9] - lattice[indicesF6,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesE1,:]=multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE1 + 1,7:9] + lattice[indicesE1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE1,:] - vel[indicesE1 + 1,:]),(((lattice[indicesE1 + 1,7:9] - lattice[indicesE1,7:9])) / (sqrt(sum((lattice[indicesE1 + 1,7:9] - lattice[indicesE1,7:9]) ** 2,2)))))),2),(((lattice[indicesE1 + 1,7:9] - lattice[indicesE1,7:9])) / (sqrt(sum((lattice[indicesE1 + 1,7:9] - lattice[indicesE1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE1 - 1,7:9] + lattice[indicesE1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE1,:] - vel[indicesE1 - 1,:]),(((lattice[indicesE1 - 1,7:9] - lattice[indicesE1,7:9])) / (sqrt(sum((lattice[indicesE1 - 1,7:9] - lattice[indicesE1,7:9]) ** 2,2)))))),2),(((lattice[indicesE1 - 1,7:9] - lattice[indicesE1,7:9])) / (sqrt(sum((lattice[indicesE1 - 1,7:9] - lattice[indicesE1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE1 + Nx,7:9] + lattice[indicesE1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE1,:] - vel[indicesE1 + Nx,:]),(((lattice[indicesE1 + Nx,7:9] - lattice[indicesE1,7:9])) / (sqrt(sum((lattice[indicesE1 + Nx,7:9] - lattice[indicesE1,7:9]) ** 2,2)))))),2),(((lattice[indicesE1 + Nx,7:9] - lattice[indicesE1,7:9])) / (sqrt(sum((lattice[indicesE1 + Nx,7:9] - lattice[indicesE1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE1 + dot(Nx,Ny),7:9] + lattice[indicesE1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE1,:] - vel[indicesE1 + dot(Nx,Ny),:]),(((lattice[indicesE1 + dot(Nx,Ny),7:9] - lattice[indicesE1,7:9])) / (sqrt(sum((lattice[indicesE1 + dot(Nx,Ny),7:9] - lattice[indicesE1,7:9]) ** 2,2)))))),2),(((lattice[indicesE1 + dot(Nx,Ny),7:9] - lattice[indicesE1,7:9])) / (sqrt(sum((lattice[indicesE1 + dot(Nx,Ny),7:9] - lattice[indicesE1,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesE2,:]=multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE2 - 1,7:9] + lattice[indicesE2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE2,:] - vel[indicesE2 - 1,:]),(((lattice[indicesE2 - 1,7:9] - lattice[indicesE2,7:9])) / (sqrt(sum((lattice[indicesE2 - 1,7:9] - lattice[indicesE2,7:9]) ** 2,2)))))),2),(((lattice[indicesE2 - 1,7:9] - lattice[indicesE2,7:9])) / (sqrt(sum((lattice[indicesE2 - 1,7:9] - lattice[indicesE2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE2 + Nx,7:9] + lattice[indicesE2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE2,:] - vel[indicesE2 + Nx,:]),(((lattice[indicesE2 + Nx,7:9] - lattice[indicesE2,7:9])) / (sqrt(sum((lattice[indicesE2 + Nx,7:9] - lattice[indicesE2,7:9]) ** 2,2)))))),2),(((lattice[indicesE2 + Nx,7:9] - lattice[indicesE2,7:9])) / (sqrt(sum((lattice[indicesE2 + Nx,7:9] - lattice[indicesE2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE2 - Nx,7:9] + lattice[indicesE2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE2,:] - vel[indicesE2 - Nx,:]),(((lattice[indicesE2 - Nx,7:9] - lattice[indicesE2,7:9])) / (sqrt(sum((lattice[indicesE2 - Nx,7:9] - lattice[indicesE2,7:9]) ** 2,2)))))),2),(((lattice[indicesE2 - Nx,7:9] - lattice[indicesE2,7:9])) / (sqrt(sum((lattice[indicesE2 - Nx,7:9] - lattice[indicesE2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE2 + dot(Nx,Ny),7:9] + lattice[indicesE2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE2,:] - vel[indicesE2 + dot(Nx,Ny),:]),(((lattice[indicesE2 + dot(Nx,Ny),7:9] - lattice[indicesE2,7:9])) / (sqrt(sum((lattice[indicesE2 + dot(Nx,Ny),7:9] - lattice[indicesE2,7:9]) ** 2,2)))))),2),(((lattice[indicesE2 + dot(Nx,Ny),7:9] - lattice[indicesE2,7:9])) / (sqrt(sum((lattice[indicesE2 + dot(Nx,Ny),7:9] - lattice[indicesE2,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesE3,:]=multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE3 + 1,7:9] + lattice[indicesE3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE3,:] - vel[indicesE3 + 1,:]),(((lattice[indicesE3 + 1,7:9] - lattice[indicesE3,7:9])) / (sqrt(sum((lattice[indicesE3 + 1,7:9] - lattice[indicesE3,7:9]) ** 2,2)))))),2),(((lattice[indicesE3 + 1,7:9] - lattice[indicesE3,7:9])) / (sqrt(sum((lattice[indicesE3 + 1,7:9] - lattice[indicesE3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE3 - 1,7:9] + lattice[indicesE3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE3,:] - vel[indicesE3 - 1,:]),(((lattice[indicesE3 - 1,7:9] - lattice[indicesE3,7:9])) / (sqrt(sum((lattice[indicesE3 - 1,7:9] - lattice[indicesE3,7:9]) ** 2,2)))))),2),(((lattice[indicesE3 - 1,7:9] - lattice[indicesE3,7:9])) / (sqrt(sum((lattice[indicesE3 - 1,7:9] - lattice[indicesE3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE3 - Nx,7:9] + lattice[indicesE3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE3,:] - vel[indicesE3 - Nx,:]),(((lattice[indicesE3 - Nx,7:9] - lattice[indicesE3,7:9])) / (sqrt(sum((lattice[indicesE3 - Nx,7:9] - lattice[indicesE3,7:9]) ** 2,2)))))),2),(((lattice[indicesE3 - Nx,7:9] - lattice[indicesE3,7:9])) / (sqrt(sum((lattice[indicesE3 - Nx,7:9] - lattice[indicesE3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE3 + dot(Nx,Ny),7:9] + lattice[indicesE3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE3,:] - vel[indicesE3 + dot(Nx,Ny),:]),(((lattice[indicesE3 + dot(Nx,Ny),7:9] - lattice[indicesE3,7:9])) / (sqrt(sum((lattice[indicesE3 + dot(Nx,Ny),7:9] - lattice[indicesE3,7:9]) ** 2,2)))))),2),(((lattice[indicesE3 + dot(Nx,Ny),7:9] - lattice[indicesE3,7:9])) / (sqrt(sum((lattice[indicesE3 + dot(Nx,Ny),7:9] - lattice[indicesE3,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesE4,:]=multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE4 + 1,7:9] + lattice[indicesE4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE4,:] - vel[indicesE4 + 1,:]),(((lattice[indicesE4 + 1,7:9] - lattice[indicesE4,7:9])) / (sqrt(sum((lattice[indicesE4 + 1,7:9] - lattice[indicesE4,7:9]) ** 2,2)))))),2),(((lattice[indicesE4 + 1,7:9] - lattice[indicesE4,7:9])) / (sqrt(sum((lattice[indicesE4 + 1,7:9] - lattice[indicesE4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE4 + Nx,7:9] + lattice[indicesE4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE4,:] - vel[indicesE4 + Nx,:]),(((lattice[indicesE4 + Nx,7:9] - lattice[indicesE4,7:9])) / (sqrt(sum((lattice[indicesE4 + Nx,7:9] - lattice[indicesE4,7:9]) ** 2,2)))))),2),(((lattice[indicesE4 + Nx,7:9] - lattice[indicesE4,7:9])) / (sqrt(sum((lattice[indicesE4 + Nx,7:9] - lattice[indicesE4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE4 - Nx,7:9] + lattice[indicesE4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE4,:] - vel[indicesE4 - Nx,:]),(((lattice[indicesE4 - Nx,7:9] - lattice[indicesE4,7:9])) / (sqrt(sum((lattice[indicesE4 - Nx,7:9] - lattice[indicesE4,7:9]) ** 2,2)))))),2),(((lattice[indicesE4 - Nx,7:9] - lattice[indicesE4,7:9])) / (sqrt(sum((lattice[indicesE4 - Nx,7:9] - lattice[indicesE4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE4 + dot(Nx,Ny),7:9] + lattice[indicesE4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE4,:] - vel[indicesE4 + dot(Nx,Ny),:]),(((lattice[indicesE4 + dot(Nx,Ny),7:9] - lattice[indicesE4,7:9])) / (sqrt(sum((lattice[indicesE4 + dot(Nx,Ny),7:9] - lattice[indicesE4,7:9]) ** 2,2)))))),2),(((lattice[indicesE4 + dot(Nx,Ny),7:9] - lattice[indicesE4,7:9])) / (sqrt(sum((lattice[indicesE4 + dot(Nx,Ny),7:9] - lattice[indicesE4,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesE5,:]=multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE5 + 1,7:9] + lattice[indicesE5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE5,:] - vel[indicesE5 + 1,:]),(((lattice[indicesE5 + 1,7:9] - lattice[indicesE5,7:9])) / (sqrt(sum((lattice[indicesE5 + 1,7:9] - lattice[indicesE5,7:9]) ** 2,2)))))),2),(((lattice[indicesE5 + 1,7:9] - lattice[indicesE5,7:9])) / (sqrt(sum((lattice[indicesE5 + 1,7:9] - lattice[indicesE5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE5 + Nx,7:9] + lattice[indicesE5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE5,:] - vel[indicesE5 + Nx,:]),(((lattice[indicesE5 + Nx,7:9] - lattice[indicesE5,7:9])) / (sqrt(sum((lattice[indicesE5 + Nx,7:9] - lattice[indicesE5,7:9]) ** 2,2)))))),2),(((lattice[indicesE5 + Nx,7:9] - lattice[indicesE5,7:9])) / (sqrt(sum((lattice[indicesE5 + Nx,7:9] - lattice[indicesE5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE5 + dot(Nx,Ny),7:9] + lattice[indicesE5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE5,:] - vel[indicesE5 + dot(Nx,Ny),:]),(((lattice[indicesE5 + dot(Nx,Ny),7:9] - lattice[indicesE5,7:9])) / (sqrt(sum((lattice[indicesE5 + dot(Nx,Ny),7:9] - lattice[indicesE5,7:9]) ** 2,2)))))),2),(((lattice[indicesE5 + dot(Nx,Ny),7:9] - lattice[indicesE5,7:9])) / (sqrt(sum((lattice[indicesE5 + dot(Nx,Ny),7:9] - lattice[indicesE5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE5 - dot(Nx,Ny),7:9] + lattice[indicesE5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE5,:] - vel[indicesE5 - dot(Nx,Ny),:]),(((lattice[indicesE5 - dot(Nx,Ny),7:9] - lattice[indicesE5,7:9])) / (sqrt(sum((lattice[indicesE5 - dot(Nx,Ny),7:9] - lattice[indicesE5,7:9]) ** 2,2)))))),2),(((lattice[indicesE5 - dot(Nx,Ny),7:9] - lattice[indicesE5,7:9])) / (sqrt(sum((lattice[indicesE5 - dot(Nx,Ny),7:9] - lattice[indicesE5,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesE6,:]=multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE6 - 1,7:9] + lattice[indicesE6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE6,:] - vel[indicesE6 - 1,:]),(((lattice[indicesE6 - 1,7:9] - lattice[indicesE6,7:9])) / (sqrt(sum((lattice[indicesE6 - 1,7:9] - lattice[indicesE6,7:9]) ** 2,2)))))),2),(((lattice[indicesE6 - 1,7:9] - lattice[indicesE6,7:9])) / (sqrt(sum((lattice[indicesE6 - 1,7:9] - lattice[indicesE6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE6 + Nx,7:9] + lattice[indicesE6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE6,:] - vel[indicesE6 + Nx,:]),(((lattice[indicesE6 + Nx,7:9] - lattice[indicesE6,7:9])) / (sqrt(sum((lattice[indicesE6 + Nx,7:9] - lattice[indicesE6,7:9]) ** 2,2)))))),2),(((lattice[indicesE6 + Nx,7:9] - lattice[indicesE6,7:9])) / (sqrt(sum((lattice[indicesE6 + Nx,7:9] - lattice[indicesE6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE6 + dot(Nx,Ny),7:9] + lattice[indicesE6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE6,:] - vel[indicesE6 + dot(Nx,Ny),:]),(((lattice[indicesE6 + dot(Nx,Ny),7:9] - lattice[indicesE6,7:9])) / (sqrt(sum((lattice[indicesE6 + dot(Nx,Ny),7:9] - lattice[indicesE6,7:9]) ** 2,2)))))),2),(((lattice[indicesE6 + dot(Nx,Ny),7:9] - lattice[indicesE6,7:9])) / (sqrt(sum((lattice[indicesE6 + dot(Nx,Ny),7:9] - lattice[indicesE6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE6 - dot(Nx,Ny),7:9] + lattice[indicesE6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE6,:] - vel[indicesE6 - dot(Nx,Ny),:]),(((lattice[indicesE6 - dot(Nx,Ny),7:9] - lattice[indicesE6,7:9])) / (sqrt(sum((lattice[indicesE6 - dot(Nx,Ny),7:9] - lattice[indicesE6,7:9]) ** 2,2)))))),2),(((lattice[indicesE6 - dot(Nx,Ny),7:9] - lattice[indicesE6,7:9])) / (sqrt(sum((lattice[indicesE6 - dot(Nx,Ny),7:9] - lattice[indicesE6,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesE7,:]=multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE7 - 1,7:9] + lattice[indicesE7,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE7,:] - vel[indicesE7 - 1,:]),(((lattice[indicesE7 - 1,7:9] - lattice[indicesE7,7:9])) / (sqrt(sum((lattice[indicesE7 - 1,7:9] - lattice[indicesE7,7:9]) ** 2,2)))))),2),(((lattice[indicesE7 - 1,7:9] - lattice[indicesE7,7:9])) / (sqrt(sum((lattice[indicesE7 - 1,7:9] - lattice[indicesE7,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE7 - Nx,7:9] + lattice[indicesE7,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE7,:] - vel[indicesE7 - Nx,:]),(((lattice[indicesE7 - Nx,7:9] - lattice[indicesE7,7:9])) / (sqrt(sum((lattice[indicesE7 - Nx,7:9] - lattice[indicesE7,7:9]) ** 2,2)))))),2),(((lattice[indicesE7 - Nx,7:9] - lattice[indicesE7,7:9])) / (sqrt(sum((lattice[indicesE7 - Nx,7:9] - lattice[indicesE7,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE7 + dot(Nx,Ny),7:9] + lattice[indicesE7,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE7,:] - vel[indicesE7 + dot(Nx,Ny),:]),(((lattice[indicesE7 + dot(Nx,Ny),7:9] - lattice[indicesE7,7:9])) / (sqrt(sum((lattice[indicesE7 + dot(Nx,Ny),7:9] - lattice[indicesE7,7:9]) ** 2,2)))))),2),(((lattice[indicesE7 + dot(Nx,Ny),7:9] - lattice[indicesE7,7:9])) / (sqrt(sum((lattice[indicesE7 + dot(Nx,Ny),7:9] - lattice[indicesE7,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE7 - dot(Nx,Ny),7:9] + lattice[indicesE7,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE7,:] - vel[indicesE7 - dot(Nx,Ny),:]),(((lattice[indicesE7 - dot(Nx,Ny),7:9] - lattice[indicesE7,7:9])) / (sqrt(sum((lattice[indicesE7 - dot(Nx,Ny),7:9] - lattice[indicesE7,7:9]) ** 2,2)))))),2),(((lattice[indicesE7 - dot(Nx,Ny),7:9] - lattice[indicesE7,7:9])) / (sqrt(sum((lattice[indicesE7 - dot(Nx,Ny),7:9] - lattice[indicesE7,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesE8,:]=multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE8 + 1,7:9] + lattice[indicesE8,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE8,:] - vel[indicesE8 + 1,:]),(((lattice[indicesE8 + 1,7:9] - lattice[indicesE8,7:9])) / (sqrt(sum((lattice[indicesE8 + 1,7:9] - lattice[indicesE8,7:9]) ** 2,2)))))),2),(((lattice[indicesE8 + 1,7:9] - lattice[indicesE8,7:9])) / (sqrt(sum((lattice[indicesE8 + 1,7:9] - lattice[indicesE8,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE8 - Nx,7:9] + lattice[indicesE8,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE8,:] - vel[indicesE8 - Nx,:]),(((lattice[indicesE8 - Nx,7:9] - lattice[indicesE8,7:9])) / (sqrt(sum((lattice[indicesE8 - Nx,7:9] - lattice[indicesE8,7:9]) ** 2,2)))))),2),(((lattice[indicesE8 - Nx,7:9] - lattice[indicesE8,7:9])) / (sqrt(sum((lattice[indicesE8 - Nx,7:9] - lattice[indicesE8,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE8 + dot(Nx,Ny),7:9] + lattice[indicesE8,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE8,:] - vel[indicesE8 + dot(Nx,Ny),:]),(((lattice[indicesE8 + dot(Nx,Ny),7:9] - lattice[indicesE8,7:9])) / (sqrt(sum((lattice[indicesE8 + dot(Nx,Ny),7:9] - lattice[indicesE8,7:9]) ** 2,2)))))),2),(((lattice[indicesE8 + dot(Nx,Ny),7:9] - lattice[indicesE8,7:9])) / (sqrt(sum((lattice[indicesE8 + dot(Nx,Ny),7:9] - lattice[indicesE8,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE8 - dot(Nx,Ny),7:9] + lattice[indicesE8,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE8,:] - vel[indicesE8 - dot(Nx,Ny),:]),(((lattice[indicesE8 - dot(Nx,Ny),7:9] - lattice[indicesE8,7:9])) / (sqrt(sum((lattice[indicesE8 - dot(Nx,Ny),7:9] - lattice[indicesE8,7:9]) ** 2,2)))))),2),(((lattice[indicesE8 - dot(Nx,Ny),7:9] - lattice[indicesE8,7:9])) / (sqrt(sum((lattice[indicesE8 - dot(Nx,Ny),7:9] - lattice[indicesE8,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesE9,:]=multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE9 + 1,7:9] + lattice[indicesE9,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE9,:] - vel[indicesE9 + 1,:]),(((lattice[indicesE9 + 1,7:9] - lattice[indicesE9,7:9])) / (sqrt(sum((lattice[indicesE9 + 1,7:9] - lattice[indicesE9,7:9]) ** 2,2)))))),2),(((lattice[indicesE9 + 1,7:9] - lattice[indicesE9,7:9])) / (sqrt(sum((lattice[indicesE9 + 1,7:9] - lattice[indicesE9,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE9 - 1,7:9] + lattice[indicesE9,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE9,:] - vel[indicesE9 - 1,:]),(((lattice[indicesE9 - 1,7:9] - lattice[indicesE9,7:9])) / (sqrt(sum((lattice[indicesE9 - 1,7:9] - lattice[indicesE9,7:9]) ** 2,2)))))),2),(((lattice[indicesE9 - 1,7:9] - lattice[indicesE9,7:9])) / (sqrt(sum((lattice[indicesE9 - 1,7:9] - lattice[indicesE9,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE9 + Nx,7:9] + lattice[indicesE9,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE9,:] - vel[indicesE9 + Nx,:]),(((lattice[indicesE9 + Nx,7:9] - lattice[indicesE9,7:9])) / (sqrt(sum((lattice[indicesE9 + Nx,7:9] - lattice[indicesE9,7:9]) ** 2,2)))))),2),(((lattice[indicesE9 + Nx,7:9] - lattice[indicesE9,7:9])) / (sqrt(sum((lattice[indicesE9 + Nx,7:9] - lattice[indicesE9,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE9 - dot(Nx,Ny),7:9] + lattice[indicesE9,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE9,:] - vel[indicesE9 - dot(Nx,Ny),:]),(((lattice[indicesE9 - dot(Nx,Ny),7:9] - lattice[indicesE9,7:9])) / (sqrt(sum((lattice[indicesE9 - dot(Nx,Ny),7:9] - lattice[indicesE9,7:9]) ** 2,2)))))),2),(((lattice[indicesE9 - dot(Nx,Ny),7:9] - lattice[indicesE9,7:9])) / (sqrt(sum((lattice[indicesE9 - dot(Nx,Ny),7:9] - lattice[indicesE9,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesE10,:]=multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE10 - 1,7:9] + lattice[indicesE10,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE10,:] - vel[indicesE10 - 1,:]),(((lattice[indicesE10 - 1,7:9] - lattice[indicesE10,7:9])) / (sqrt(sum((lattice[indicesE10 - 1,7:9] - lattice[indicesE10,7:9]) ** 2,2)))))),2),(((lattice[indicesE10 - 1,7:9] - lattice[indicesE10,7:9])) / (sqrt(sum((lattice[indicesE10 - 1,7:9] - lattice[indicesE10,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE10 + Nx,7:9] + lattice[indicesE10,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE10,:] - vel[indicesE10 + Nx,:]),(((lattice[indicesE10 + Nx,7:9] - lattice[indicesE10,7:9])) / (sqrt(sum((lattice[indicesE10 + Nx,7:9] - lattice[indicesE10,7:9]) ** 2,2)))))),2),(((lattice[indicesE10 + Nx,7:9] - lattice[indicesE10,7:9])) / (sqrt(sum((lattice[indicesE10 + Nx,7:9] - lattice[indicesE10,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE10 - Nx,7:9] + lattice[indicesE10,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE10,:] - vel[indicesE10 - Nx,:]),(((lattice[indicesE10 - Nx,7:9] - lattice[indicesE10,7:9])) / (sqrt(sum((lattice[indicesE10 - Nx,7:9] - lattice[indicesE10,7:9]) ** 2,2)))))),2),(((lattice[indicesE10 - Nx,7:9] - lattice[indicesE10,7:9])) / (sqrt(sum((lattice[indicesE10 - Nx,7:9] - lattice[indicesE10,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE10 - dot(Nx,Ny),7:9] + lattice[indicesE10,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE10,:] - vel[indicesE10 - dot(Nx,Ny),:]),(((lattice[indicesE10 - dot(Nx,Ny),7:9] - lattice[indicesE10,7:9])) / (sqrt(sum((lattice[indicesE10 - dot(Nx,Ny),7:9] - lattice[indicesE10,7:9]) ** 2,2)))))),2),(((lattice[indicesE10 - dot(Nx,Ny),7:9] - lattice[indicesE10,7:9])) / (sqrt(sum((lattice[indicesE10 - dot(Nx,Ny),7:9] - lattice[indicesE10,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesE11,:]=multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE11 + 1,7:9] + lattice[indicesE11,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE11,:] - vel[indicesE11 + 1,:]),(((lattice[indicesE11 + 1,7:9] - lattice[indicesE11,7:9])) / (sqrt(sum((lattice[indicesE11 + 1,7:9] - lattice[indicesE11,7:9]) ** 2,2)))))),2),(((lattice[indicesE11 + 1,7:9] - lattice[indicesE11,7:9])) / (sqrt(sum((lattice[indicesE11 + 1,7:9] - lattice[indicesE11,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE11 - 1,7:9] + lattice[indicesE11,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE11,:] - vel[indicesE11 - 1,:]),(((lattice[indicesE11 - 1,7:9] - lattice[indicesE11,7:9])) / (sqrt(sum((lattice[indicesE11 - 1,7:9] - lattice[indicesE11,7:9]) ** 2,2)))))),2),(((lattice[indicesE11 - 1,7:9] - lattice[indicesE11,7:9])) / (sqrt(sum((lattice[indicesE11 - 1,7:9] - lattice[indicesE11,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE11 - Nx,7:9] + lattice[indicesE11,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE11,:] - vel[indicesE11 - Nx,:]),(((lattice[indicesE11 - Nx,7:9] - lattice[indicesE11,7:9])) / (sqrt(sum((lattice[indicesE11 - Nx,7:9] - lattice[indicesE11,7:9]) ** 2,2)))))),2),(((lattice[indicesE11 - Nx,7:9] - lattice[indicesE11,7:9])) / (sqrt(sum((lattice[indicesE11 - Nx,7:9] - lattice[indicesE11,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE11 - dot(Nx,Ny),7:9] + lattice[indicesE11,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE11,:] - vel[indicesE11 - dot(Nx,Ny),:]),(((lattice[indicesE11 - dot(Nx,Ny),7:9] - lattice[indicesE11,7:9])) / (sqrt(sum((lattice[indicesE11 - dot(Nx,Ny),7:9] - lattice[indicesE11,7:9]) ** 2,2)))))),2),(((lattice[indicesE11 - dot(Nx,Ny),7:9] - lattice[indicesE11,7:9])) / (sqrt(sum((lattice[indicesE11 - dot(Nx,Ny),7:9] - lattice[indicesE11,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesE12,:]=multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE12 + 1,7:9] + lattice[indicesE12,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE12,:] - vel[indicesE12 + 1,:]),(((lattice[indicesE12 + 1,7:9] - lattice[indicesE12,7:9])) / (sqrt(sum((lattice[indicesE12 + 1,7:9] - lattice[indicesE12,7:9]) ** 2,2)))))),2),(((lattice[indicesE12 + 1,7:9] - lattice[indicesE12,7:9])) / (sqrt(sum((lattice[indicesE12 + 1,7:9] - lattice[indicesE12,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE12 + Nx,7:9] + lattice[indicesE12,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE12,:] - vel[indicesE12 + Nx,:]),(((lattice[indicesE12 + Nx,7:9] - lattice[indicesE12,7:9])) / (sqrt(sum((lattice[indicesE12 + Nx,7:9] - lattice[indicesE12,7:9]) ** 2,2)))))),2),(((lattice[indicesE12 + Nx,7:9] - lattice[indicesE12,7:9])) / (sqrt(sum((lattice[indicesE12 + Nx,7:9] - lattice[indicesE12,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE12 - Nx,7:9] + lattice[indicesE12,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE12,:] - vel[indicesE12 - Nx,:]),(((lattice[indicesE12 - Nx,7:9] - lattice[indicesE12,7:9])) / (sqrt(sum((lattice[indicesE12 - Nx,7:9] - lattice[indicesE12,7:9]) ** 2,2)))))),2),(((lattice[indicesE12 - Nx,7:9] - lattice[indicesE12,7:9])) / (sqrt(sum((lattice[indicesE12 - Nx,7:9] - lattice[indicesE12,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesE12 - dot(Nx,Ny),7:9] + lattice[indicesE12,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE12,:] - vel[indicesE12 - dot(Nx,Ny),:]),(((lattice[indicesE12 - dot(Nx,Ny),7:9] - lattice[indicesE12,7:9])) / (sqrt(sum((lattice[indicesE12 - dot(Nx,Ny),7:9] - lattice[indicesE12,7:9]) ** 2,2)))))),2),(((lattice[indicesE12 - dot(Nx,Ny),7:9] - lattice[indicesE12,7:9])) / (sqrt(sum((lattice[indicesE12 - dot(Nx,Ny),7:9] - lattice[indicesE12,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesC1,:]=multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesC1 + 1,7:9] + lattice[indicesC1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC1,:] - vel[indicesC1 + 1,:]),(((lattice[indicesC1 + 1,7:9] - lattice[indicesC1,7:9])) / (sqrt(sum((lattice[indicesC1 + 1,7:9] - lattice[indicesC1,7:9]) ** 2,2)))))),2),(((lattice[indicesC1 + 1,7:9] - lattice[indicesC1,7:9])) / (sqrt(sum((lattice[indicesC1 + 1,7:9] - lattice[indicesC1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesC1 + Nx,7:9] + lattice[indicesC1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC1,:] - vel[indicesC1 + Nx,:]),(((lattice[indicesC1 + Nx,7:9] - lattice[indicesC1,7:9])) / (sqrt(sum((lattice[indicesC1 + Nx,7:9] - lattice[indicesC1,7:9]) ** 2,2)))))),2),(((lattice[indicesC1 + Nx,7:9] - lattice[indicesC1,7:9])) / (sqrt(sum((lattice[indicesC1 + Nx,7:9] - lattice[indicesC1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesC1 + dot(Nx,Ny),7:9] + lattice[indicesC1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC1,:] - vel[indicesC1 + dot(Nx,Ny),:]),(((lattice[indicesC1 + dot(Nx,Ny),7:9] - lattice[indicesC1,7:9])) / (sqrt(sum((lattice[indicesC1 + dot(Nx,Ny),7:9] - lattice[indicesC1,7:9]) ** 2,2)))))),2),(((lattice[indicesC1 + dot(Nx,Ny),7:9] - lattice[indicesC1,7:9])) / (sqrt(sum((lattice[indicesC1 + dot(Nx,Ny),7:9] - lattice[indicesC1,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesC2,:]=multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesC2 - 1,7:9] + lattice[indicesC2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC2,:] - vel[indicesC2 - 1,:]),(((lattice[indicesC2 - 1,7:9] - lattice[indicesC2,7:9])) / (sqrt(sum((lattice[indicesC2 - 1,7:9] - lattice[indicesC2,7:9]) ** 2,2)))))),2),(((lattice[indicesC2 - 1,7:9] - lattice[indicesC2,7:9])) / (sqrt(sum((lattice[indicesC2 - 1,7:9] - lattice[indicesC2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesC2 + Nx,7:9] + lattice[indicesC2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC2,:] - vel[indicesC2 + Nx,:]),(((lattice[indicesC2 + Nx,7:9] - lattice[indicesC2,7:9])) / (sqrt(sum((lattice[indicesC2 + Nx,7:9] - lattice[indicesC2,7:9]) ** 2,2)))))),2),(((lattice[indicesC2 + Nx,7:9] - lattice[indicesC2,7:9])) / (sqrt(sum((lattice[indicesC2 + Nx,7:9] - lattice[indicesC2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesC2 + dot(Nx,Ny),7:9] + lattice[indicesC2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC2,:] - vel[indicesC2 + dot(Nx,Ny),:]),(((lattice[indicesC2 + dot(Nx,Ny),7:9] - lattice[indicesC2,7:9])) / (sqrt(sum((lattice[indicesC2 + dot(Nx,Ny),7:9] - lattice[indicesC2,7:9]) ** 2,2)))))),2),(((lattice[indicesC2 + dot(Nx,Ny),7:9] - lattice[indicesC2,7:9])) / (sqrt(sum((lattice[indicesC2 + dot(Nx,Ny),7:9] - lattice[indicesC2,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesC3,:]=multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesC3 - 1,7:9] + lattice[indicesC3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC3,:] - vel[indicesC3 - 1,:]),(((lattice[indicesC3 - 1,7:9] - lattice[indicesC3,7:9])) / (sqrt(sum((lattice[indicesC3 - 1,7:9] - lattice[indicesC3,7:9]) ** 2,2)))))),2),(((lattice[indicesC3 - 1,7:9] - lattice[indicesC3,7:9])) / (sqrt(sum((lattice[indicesC3 - 1,7:9] - lattice[indicesC3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesC3 - Nx,7:9] + lattice[indicesC3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC3,:] - vel[indicesC3 - Nx,:]),(((lattice[indicesC3 - Nx,7:9] - lattice[indicesC3,7:9])) / (sqrt(sum((lattice[indicesC3 - Nx,7:9] - lattice[indicesC3,7:9]) ** 2,2)))))),2),(((lattice[indicesC3 - Nx,7:9] - lattice[indicesC3,7:9])) / (sqrt(sum((lattice[indicesC3 - Nx,7:9] - lattice[indicesC3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesC3 + dot(Nx,Ny),7:9] + lattice[indicesC3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC3,:] - vel[indicesC3 + dot(Nx,Ny),:]),(((lattice[indicesC3 + dot(Nx,Ny),7:9] - lattice[indicesC3,7:9])) / (sqrt(sum((lattice[indicesC3 + dot(Nx,Ny),7:9] - lattice[indicesC3,7:9]) ** 2,2)))))),2),(((lattice[indicesC3 + dot(Nx,Ny),7:9] - lattice[indicesC3,7:9])) / (sqrt(sum((lattice[indicesC3 + dot(Nx,Ny),7:9] - lattice[indicesC3,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesC4,:]=multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesC4 + 1,7:9] + lattice[indicesC4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC4,:] - vel[indicesC4 + 1,:]),(((lattice[indicesC4 + 1,7:9] - lattice[indicesC4,7:9])) / (sqrt(sum((lattice[indicesC4 + 1,7:9] - lattice[indicesC4,7:9]) ** 2,2)))))),2),(((lattice[indicesC4 + 1,7:9] - lattice[indicesC4,7:9])) / (sqrt(sum((lattice[indicesC4 + 1,7:9] - lattice[indicesC4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesC4 - Nx,7:9] + lattice[indicesC4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC4,:] - vel[indicesC4 - Nx,:]),(((lattice[indicesC4 - Nx,7:9] - lattice[indicesC4,7:9])) / (sqrt(sum((lattice[indicesC4 - Nx,7:9] - lattice[indicesC4,7:9]) ** 2,2)))))),2),(((lattice[indicesC4 - Nx,7:9] - lattice[indicesC4,7:9])) / (sqrt(sum((lattice[indicesC4 - Nx,7:9] - lattice[indicesC4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesC4 + dot(Nx,Ny),7:9] + lattice[indicesC4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC4,:] - vel[indicesC4 + dot(Nx,Ny),:]),(((lattice[indicesC4 + dot(Nx,Ny),7:9] - lattice[indicesC4,7:9])) / (sqrt(sum((lattice[indicesC4 + dot(Nx,Ny),7:9] - lattice[indicesC4,7:9]) ** 2,2)))))),2),(((lattice[indicesC4 + dot(Nx,Ny),7:9] - lattice[indicesC4,7:9])) / (sqrt(sum((lattice[indicesC4 + dot(Nx,Ny),7:9] - lattice[indicesC4,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesC5,:]=multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesC5 + 1,7:9] + lattice[indicesC5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC5,:] - vel[indicesC5 + 1,:]),(((lattice[indicesC5 + 1,7:9] - lattice[indicesC5,7:9])) / (sqrt(sum((lattice[indicesC5 + 1,7:9] - lattice[indicesC5,7:9]) ** 2,2)))))),2),(((lattice[indicesC5 + 1,7:9] - lattice[indicesC5,7:9])) / (sqrt(sum((lattice[indicesC5 + 1,7:9] - lattice[indicesC5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesC5 + Nx,7:9] + lattice[indicesC5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC5,:] - vel[indicesC5 + Nx,:]),(((lattice[indicesC5 + Nx,7:9] - lattice[indicesC5,7:9])) / (sqrt(sum((lattice[indicesC5 + Nx,7:9] - lattice[indicesC5,7:9]) ** 2,2)))))),2),(((lattice[indicesC5 + Nx,7:9] - lattice[indicesC5,7:9])) / (sqrt(sum((lattice[indicesC5 + Nx,7:9] - lattice[indicesC5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesC5 - dot(Nx,Ny),7:9] + lattice[indicesC5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC5,:] - vel[indicesC5 - dot(Nx,Ny),:]),(((lattice[indicesC5 - dot(Nx,Ny),7:9] - lattice[indicesC5,7:9])) / (sqrt(sum((lattice[indicesC5 - dot(Nx,Ny),7:9] - lattice[indicesC5,7:9]) ** 2,2)))))),2),(((lattice[indicesC5 - dot(Nx,Ny),7:9] - lattice[indicesC5,7:9])) / (sqrt(sum((lattice[indicesC5 - dot(Nx,Ny),7:9] - lattice[indicesC5,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesC6,:]=multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesC6 - 1,7:9] + lattice[indicesC6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC6,:] - vel[indicesC6 - 1,:]),(((lattice[indicesC6 - 1,7:9] - lattice[indicesC6,7:9])) / (sqrt(sum((lattice[indicesC6 - 1,7:9] - lattice[indicesC6,7:9]) ** 2,2)))))),2),(((lattice[indicesC6 - 1,7:9] - lattice[indicesC6,7:9])) / (sqrt(sum((lattice[indicesC6 - 1,7:9] - lattice[indicesC6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesC6 + Nx,7:9] + lattice[indicesC6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC6,:] - vel[indicesC6 + Nx,:]),(((lattice[indicesC6 + Nx,7:9] - lattice[indicesC6,7:9])) / (sqrt(sum((lattice[indicesC6 + Nx,7:9] - lattice[indicesC6,7:9]) ** 2,2)))))),2),(((lattice[indicesC6 + Nx,7:9] - lattice[indicesC6,7:9])) / (sqrt(sum((lattice[indicesC6 + Nx,7:9] - lattice[indicesC6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesC6 - dot(Nx,Ny),7:9] + lattice[indicesC6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC6,:] - vel[indicesC6 - dot(Nx,Ny),:]),(((lattice[indicesC6 - dot(Nx,Ny),7:9] - lattice[indicesC6,7:9])) / (sqrt(sum((lattice[indicesC6 - dot(Nx,Ny),7:9] - lattice[indicesC6,7:9]) ** 2,2)))))),2),(((lattice[indicesC6 - dot(Nx,Ny),7:9] - lattice[indicesC6,7:9])) / (sqrt(sum((lattice[indicesC6 - dot(Nx,Ny),7:9] - lattice[indicesC6,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesC7,:]=multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesC7 - 1,7:9] + lattice[indicesC7,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC7,:] - vel[indicesC7 - 1,:]),(((lattice[indicesC7 - 1,7:9] - lattice[indicesC7,7:9])) / (sqrt(sum((lattice[indicesC7 - 1,7:9] - lattice[indicesC7,7:9]) ** 2,2)))))),2),(((lattice[indicesC7 - 1,7:9] - lattice[indicesC7,7:9])) / (sqrt(sum((lattice[indicesC7 - 1,7:9] - lattice[indicesC7,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesC7 - Nx,7:9] + lattice[indicesC7,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC7,:] - vel[indicesC7 - Nx,:]),(((lattice[indicesC7 - Nx,7:9] - lattice[indicesC7,7:9])) / (sqrt(sum((lattice[indicesC7 - Nx,7:9] - lattice[indicesC7,7:9]) ** 2,2)))))),2),(((lattice[indicesC7 - Nx,7:9] - lattice[indicesC7,7:9])) / (sqrt(sum((lattice[indicesC7 - Nx,7:9] - lattice[indicesC7,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesC7 - dot(Nx,Ny),7:9] + lattice[indicesC7,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC7,:] - vel[indicesC7 - dot(Nx,Ny),:]),(((lattice[indicesC7 - dot(Nx,Ny),7:9] - lattice[indicesC7,7:9])) / (sqrt(sum((lattice[indicesC7 - dot(Nx,Ny),7:9] - lattice[indicesC7,7:9]) ** 2,2)))))),2),(((lattice[indicesC7 - dot(Nx,Ny),7:9] - lattice[indicesC7,7:9])) / (sqrt(sum((lattice[indicesC7 - dot(Nx,Ny),7:9] - lattice[indicesC7,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesC8,:]=multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesC8 + 1,7:9] + lattice[indicesC8,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC8,:] - vel[indicesC8 + 1,:]),(((lattice[indicesC8 + 1,7:9] - lattice[indicesC8,7:9])) / (sqrt(sum((lattice[indicesC8 + 1,7:9] - lattice[indicesC8,7:9]) ** 2,2)))))),2),(((lattice[indicesC8 + 1,7:9] - lattice[indicesC8,7:9])) / (sqrt(sum((lattice[indicesC8 + 1,7:9] - lattice[indicesC8,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesC8 - Nx,7:9] + lattice[indicesC8,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC8,:] - vel[indicesC8 - Nx,:]),(((lattice[indicesC8 - Nx,7:9] - lattice[indicesC8,7:9])) / (sqrt(sum((lattice[indicesC8 - Nx,7:9] - lattice[indicesC8,7:9]) ** 2,2)))))),2),(((lattice[indicesC8 - Nx,7:9] - lattice[indicesC8,7:9])) / (sqrt(sum((lattice[indicesC8 - Nx,7:9] - lattice[indicesC8,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dsthandle[multiply(0.5,(lattice[indicesC8 - dot(Nx,Ny),7:9] + lattice[indicesC8,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC8,:] - vel[indicesC8 - dot(Nx,Ny),:]),(((lattice[indicesC8 - dot(Nx,Ny),7:9] - lattice[indicesC8,7:9])) / (sqrt(sum((lattice[indicesC8 - dot(Nx,Ny),7:9] - lattice[indicesC8,7:9]) ** 2,2)))))),2),(((lattice[indicesC8 - dot(Nx,Ny),7:9] - lattice[indicesC8,7:9])) / (sqrt(sum((lattice[indicesC8 - dot(Nx,Ny),7:9] - lattice[indicesC8,7:9]) ** 2,2)))))) ** 2,2))
    ##
    
    # ---> shear springs
    
    A=- 1 - Nx - dot(Nx,Ny)
    B=- Nx - dot(Nx,Ny)
    C=+ 1 - Nx - dot(Nx,Ny)
    D=- 1 - dot(Nx,Ny)
    E=+ 1 - dot(Nx,Ny)
    F=- 1 + Nx - dot(Nx,Ny)
    G=+ Nx - dot(Nx,Ny)
    H=+ 1 + Nx - dot(Nx,Ny)
    I=- 1 - Nx
    L=+ 1 - Nx
    M=- 1 + Nx
    N=+ 1 + Nx
    O=- 1 - Nx + dot(Nx,Ny)
    P=- Nx + dot(Nx,Ny)
    Q=+ 1 - Nx + dot(Nx,Ny)
    R=- 1 + dot(Nx,Ny)
    S=+ 1 + dot(Nx,Ny)
    T=- 1 + Nx + dot(Nx,Ny)
    U=+ Nx + dot(Nx,Ny)
    V=+ 1 + Nx + dot(Nx,Ny)
    Dfuncp[indicesbulk,:]=Dfuncp[indicesbulk,:] + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesbulk + A,7:9] + lattice[indicesbulk,7:9])),t]),sum((multiply(sum((multiply((vel[indicesbulk,:] - vel[indicesbulk + A,:]),(((lattice[indicesbulk + A,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + A,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))),2),(((lattice[indicesbulk + A,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + A,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesbulk + B,7:9] + lattice[indicesbulk,7:9])),t]),sum((multiply(sum((multiply((vel[indicesbulk,:] - vel[indicesbulk + B,:]),(((lattice[indicesbulk + B,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + B,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))),2),(((lattice[indicesbulk + B,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + B,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesbulk + C,7:9] + lattice[indicesbulk,7:9])),t]),sum((multiply(sum((multiply((vel[indicesbulk,:] - vel[indicesbulk + C,:]),(((lattice[indicesbulk + C,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + C,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))),2),(((lattice[indicesbulk + C,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + C,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesbulk + D,7:9] + lattice[indicesbulk,7:9])),t]),sum((multiply(sum((multiply((vel[indicesbulk,:] - vel[indicesbulk + D,:]),(((lattice[indicesbulk + D,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + D,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))),2),(((lattice[indicesbulk + D,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + D,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesbulk + E,7:9] + lattice[indicesbulk,7:9])),t]),sum((multiply(sum((multiply((vel[indicesbulk,:] - vel[indicesbulk + E,:]),(((lattice[indicesbulk + E,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + E,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))),2),(((lattice[indicesbulk + E,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + E,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesbulk + F,7:9] + lattice[indicesbulk,7:9])),t]),sum((multiply(sum((multiply((vel[indicesbulk,:] - vel[indicesbulk + F,:]),(((lattice[indicesbulk + F,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + F,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))),2),(((lattice[indicesbulk + F,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + F,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesbulk + G,7:9] + lattice[indicesbulk,7:9])),t]),sum((multiply(sum((multiply((vel[indicesbulk,:] - vel[indicesbulk + G,:]),(((lattice[indicesbulk + G,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + G,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))),2),(((lattice[indicesbulk + G,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + G,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesbulk + H,7:9] + lattice[indicesbulk,7:9])),t]),sum((multiply(sum((multiply((vel[indicesbulk,:] - vel[indicesbulk + H,:]),(((lattice[indicesbulk + H,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + H,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))),2),(((lattice[indicesbulk + H,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + H,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesbulk + I,7:9] + lattice[indicesbulk,7:9])),t]),sum((multiply(sum((multiply((vel[indicesbulk,:] - vel[indicesbulk + I,:]),(((lattice[indicesbulk + I,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + I,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))),2),(((lattice[indicesbulk + I,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + I,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesbulk + L,7:9] + lattice[indicesbulk,7:9])),t]),sum((multiply(sum((multiply((vel[indicesbulk,:] - vel[indicesbulk + L,:]),(((lattice[indicesbulk + L,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + L,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))),2),(((lattice[indicesbulk + L,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + L,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesbulk + M,7:9] + lattice[indicesbulk,7:9])),t]),sum((multiply(sum((multiply((vel[indicesbulk,:] - vel[indicesbulk + M,:]),(((lattice[indicesbulk + M,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + M,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))),2),(((lattice[indicesbulk + M,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + M,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesbulk + N,7:9] + lattice[indicesbulk,7:9])),t]),sum((multiply(sum((multiply((vel[indicesbulk,:] - vel[indicesbulk + N,:]),(((lattice[indicesbulk + N,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + N,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))),2),(((lattice[indicesbulk + N,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + N,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesbulk + O,7:9] + lattice[indicesbulk,7:9])),t]),sum((multiply(sum((multiply((vel[indicesbulk,:] - vel[indicesbulk + O,:]),(((lattice[indicesbulk + O,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + O,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))),2),(((lattice[indicesbulk + O,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + O,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesbulk + P,7:9] + lattice[indicesbulk,7:9])),t]),sum((multiply(sum((multiply((vel[indicesbulk,:] - vel[indicesbulk + P,:]),(((lattice[indicesbulk + P,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + P,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))),2),(((lattice[indicesbulk + P,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + P,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesbulk + Q,7:9] + lattice[indicesbulk,7:9])),t]),sum((multiply(sum((multiply((vel[indicesbulk,:] - vel[indicesbulk + Q,:]),(((lattice[indicesbulk + Q,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + Q,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))),2),(((lattice[indicesbulk + Q,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + Q,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesbulk + R,7:9] + lattice[indicesbulk,7:9])),t]),sum((multiply(sum((multiply((vel[indicesbulk,:] - vel[indicesbulk + R,:]),(((lattice[indicesbulk + R,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + R,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))),2),(((lattice[indicesbulk + R,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + R,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesbulk + S,7:9] + lattice[indicesbulk,7:9])),t]),sum((multiply(sum((multiply((vel[indicesbulk,:] - vel[indicesbulk + S,:]),(((lattice[indicesbulk + S,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + S,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))),2),(((lattice[indicesbulk + S,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + S,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesbulk + T,7:9] + lattice[indicesbulk,7:9])),t]),sum((multiply(sum((multiply((vel[indicesbulk,:] - vel[indicesbulk + T,:]),(((lattice[indicesbulk + T,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + T,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))),2),(((lattice[indicesbulk + T,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + T,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesbulk + U,7:9] + lattice[indicesbulk,7:9])),t]),sum((multiply(sum((multiply((vel[indicesbulk,:] - vel[indicesbulk + U,:]),(((lattice[indicesbulk + U,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + U,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))),2),(((lattice[indicesbulk + U,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + U,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesbulk + V,7:9] + lattice[indicesbulk,7:9])),t]),sum((multiply(sum((multiply((vel[indicesbulk,:] - vel[indicesbulk + V,:]),(((lattice[indicesbulk + V,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + V,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))),2),(((lattice[indicesbulk + V,7:9] - lattice[indicesbulk,7:9])) / (sqrt(sum((lattice[indicesbulk + V,7:9] - lattice[indicesbulk,7:9]) ** 2,2)))))) ** 2,2))
    
    Dfuncp[indicesF1,:]=Dfuncp[indicesF1,:] + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF1 + I,7:9] + lattice[indicesF1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF1,:] - vel[indicesF1 + I,:]),(((lattice[indicesF1 + I,7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 + I,7:9] - lattice[indicesF1,7:9]) ** 2,2)))))),2),(((lattice[indicesF1 + I,7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 + I,7:9] - lattice[indicesF1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF1 + L,7:9] + lattice[indicesF1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF1,:] - vel[indicesF1 + L,:]),(((lattice[indicesF1 + L,7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 + L,7:9] - lattice[indicesF1,7:9]) ** 2,2)))))),2),(((lattice[indicesF1 + L,7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 + L,7:9] - lattice[indicesF1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF1 + M,7:9] + lattice[indicesF1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF1,:] - vel[indicesF1 + M,:]),(((lattice[indicesF1 + M,7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 + M,7:9] - lattice[indicesF1,7:9]) ** 2,2)))))),2),(((lattice[indicesF1 + M,7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 + M,7:9] - lattice[indicesF1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF1 + N,7:9] + lattice[indicesF1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF1,:] - vel[indicesF1 + N,:]),(((lattice[indicesF1 + N,7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 + N,7:9] - lattice[indicesF1,7:9]) ** 2,2)))))),2),(((lattice[indicesF1 + N,7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 + N,7:9] - lattice[indicesF1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF1 + O,7:9] + lattice[indicesF1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF1,:] - vel[indicesF1 + O,:]),(((lattice[indicesF1 + O,7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 + O,7:9] - lattice[indicesF1,7:9]) ** 2,2)))))),2),(((lattice[indicesF1 + O,7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 + O,7:9] - lattice[indicesF1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF1 + P,7:9] + lattice[indicesF1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF1,:] - vel[indicesF1 + P,:]),(((lattice[indicesF1 + P,7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 + P,7:9] - lattice[indicesF1,7:9]) ** 2,2)))))),2),(((lattice[indicesF1 + P,7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 + P,7:9] - lattice[indicesF1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF1 + Q,7:9] + lattice[indicesF1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF1,:] - vel[indicesF1 + Q,:]),(((lattice[indicesF1 + Q,7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 + Q,7:9] - lattice[indicesF1,7:9]) ** 2,2)))))),2),(((lattice[indicesF1 + Q,7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 + Q,7:9] - lattice[indicesF1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF1 + R,7:9] + lattice[indicesF1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF1,:] - vel[indicesF1 + R,:]),(((lattice[indicesF1 + R,7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 + R,7:9] - lattice[indicesF1,7:9]) ** 2,2)))))),2),(((lattice[indicesF1 + R,7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 + R,7:9] - lattice[indicesF1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF1 + S,7:9] + lattice[indicesF1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF1,:] - vel[indicesF1 + S,:]),(((lattice[indicesF1 + S,7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 + S,7:9] - lattice[indicesF1,7:9]) ** 2,2)))))),2),(((lattice[indicesF1 + S,7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 + S,7:9] - lattice[indicesF1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF1 + T,7:9] + lattice[indicesF1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF1,:] - vel[indicesF1 + T,:]),(((lattice[indicesF1 + T,7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 + T,7:9] - lattice[indicesF1,7:9]) ** 2,2)))))),2),(((lattice[indicesF1 + T,7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 + T,7:9] - lattice[indicesF1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF1 + U,7:9] + lattice[indicesF1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF1,:] - vel[indicesF1 + U,:]),(((lattice[indicesF1 + U,7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 + U,7:9] - lattice[indicesF1,7:9]) ** 2,2)))))),2),(((lattice[indicesF1 + U,7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 + U,7:9] - lattice[indicesF1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF1 + V,7:9] + lattice[indicesF1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF1,:] - vel[indicesF1 + V,:]),(((lattice[indicesF1 + V,7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 + V,7:9] - lattice[indicesF1,7:9]) ** 2,2)))))),2),(((lattice[indicesF1 + V,7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 + V,7:9] - lattice[indicesF1,7:9]) ** 2,2)))))) ** 2,2))
    
    Dfuncp[indicesF2,:]=Dfuncp[indicesF2,:] + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF2 + D,7:9] + lattice[indicesF2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF2,:] - vel[indicesF2 + D,:]),(((lattice[indicesF2 + D,7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 + D,7:9] - lattice[indicesF2,7:9]) ** 2,2)))))),2),(((lattice[indicesF2 + D,7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 + D,7:9] - lattice[indicesF2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF2 + E,7:9] + lattice[indicesF2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF2,:] - vel[indicesF2 + E,:]),(((lattice[indicesF2 + E,7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 + E,7:9] - lattice[indicesF2,7:9]) ** 2,2)))))),2),(((lattice[indicesF2 + E,7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 + E,7:9] - lattice[indicesF2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF2 + F,7:9] + lattice[indicesF2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF2,:] - vel[indicesF2 + F,:]),(((lattice[indicesF2 + F,7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 + F,7:9] - lattice[indicesF2,7:9]) ** 2,2)))))),2),(((lattice[indicesF2 + F,7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 + F,7:9] - lattice[indicesF2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF2 + G,7:9] + lattice[indicesF2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF2,:] - vel[indicesF2 + G,:]),(((lattice[indicesF2 + G,7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 + G,7:9] - lattice[indicesF2,7:9]) ** 2,2)))))),2),(((lattice[indicesF2 + G,7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 + G,7:9] - lattice[indicesF2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF2 + H,7:9] + lattice[indicesF2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF2,:] - vel[indicesF2 + H,:]),(((lattice[indicesF2 + H,7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 + H,7:9] - lattice[indicesF2,7:9]) ** 2,2)))))),2),(((lattice[indicesF2 + H,7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 + H,7:9] - lattice[indicesF2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF2 + M,7:9] + lattice[indicesF2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF2,:] - vel[indicesF2 + M,:]),(((lattice[indicesF2 + M,7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 + M,7:9] - lattice[indicesF2,7:9]) ** 2,2)))))),2),(((lattice[indicesF2 + M,7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 + M,7:9] - lattice[indicesF2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF2 + N,7:9] + lattice[indicesF2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF2,:] - vel[indicesF2 + N,:]),(((lattice[indicesF2 + N,7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 + N,7:9] - lattice[indicesF2,7:9]) ** 2,2)))))),2),(((lattice[indicesF2 + N,7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 + N,7:9] - lattice[indicesF2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF2 + R,7:9] + lattice[indicesF2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF2,:] - vel[indicesF2 + R,:]),(((lattice[indicesF2 + R,7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 + R,7:9] - lattice[indicesF2,7:9]) ** 2,2)))))),2),(((lattice[indicesF2 + R,7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 + R,7:9] - lattice[indicesF2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF2 + S,7:9] + lattice[indicesF2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF2,:] - vel[indicesF2 + S,:]),(((lattice[indicesF2 + S,7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 + S,7:9] - lattice[indicesF2,7:9]) ** 2,2)))))),2),(((lattice[indicesF2 + S,7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 + S,7:9] - lattice[indicesF2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF2 + T,7:9] + lattice[indicesF2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF2,:] - vel[indicesF2 + T,:]),(((lattice[indicesF2 + T,7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 + T,7:9] - lattice[indicesF2,7:9]) ** 2,2)))))),2),(((lattice[indicesF2 + T,7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 + T,7:9] - lattice[indicesF2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF2 + U,7:9] + lattice[indicesF2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF2,:] - vel[indicesF2 + U,:]),(((lattice[indicesF2 + U,7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 + U,7:9] - lattice[indicesF2,7:9]) ** 2,2)))))),2),(((lattice[indicesF2 + U,7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 + U,7:9] - lattice[indicesF2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF2 + V,7:9] + lattice[indicesF2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF2,:] - vel[indicesF2 + V,:]),(((lattice[indicesF2 + V,7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 + V,7:9] - lattice[indicesF2,7:9]) ** 2,2)))))),2),(((lattice[indicesF2 + V,7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 + V,7:9] - lattice[indicesF2,7:9]) ** 2,2)))))) ** 2,2))
    
    Dfuncp[indicesF3,:]=Dfuncp[indicesF3,:] + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF3 + A,7:9] + lattice[indicesF3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF3,:] - vel[indicesF3 + A,:]),(((lattice[indicesF3 + A,7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 + A,7:9] - lattice[indicesF3,7:9]) ** 2,2)))))),2),(((lattice[indicesF3 + A,7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 + A,7:9] - lattice[indicesF3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF3 + B,7:9] + lattice[indicesF3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF3,:] - vel[indicesF3 + B,:]),(((lattice[indicesF3 + B,7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 + B,7:9] - lattice[indicesF3,7:9]) ** 2,2)))))),2),(((lattice[indicesF3 + B,7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 + B,7:9] - lattice[indicesF3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF3 + D,7:9] + lattice[indicesF3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF3,:] - vel[indicesF3 + D,:]),(((lattice[indicesF3 + D,7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 + D,7:9] - lattice[indicesF3,7:9]) ** 2,2)))))),2),(((lattice[indicesF3 + D,7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 + D,7:9] - lattice[indicesF3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF3 + F,7:9] + lattice[indicesF3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF3,:] - vel[indicesF3 + F,:]),(((lattice[indicesF3 + F,7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 + F,7:9] - lattice[indicesF3,7:9]) ** 2,2)))))),2),(((lattice[indicesF3 + F,7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 + F,7:9] - lattice[indicesF3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF3 + G,7:9] + lattice[indicesF3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF3,:] - vel[indicesF3 + G,:]),(((lattice[indicesF3 + G,7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 + G,7:9] - lattice[indicesF3,7:9]) ** 2,2)))))),2),(((lattice[indicesF3 + G,7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 + G,7:9] - lattice[indicesF3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF3 + I,7:9] + lattice[indicesF3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF3,:] - vel[indicesF3 + I,:]),(((lattice[indicesF3 + I,7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 + I,7:9] - lattice[indicesF3,7:9]) ** 2,2)))))),2),(((lattice[indicesF3 + I,7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 + I,7:9] - lattice[indicesF3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF3 + M,7:9] + lattice[indicesF3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF3,:] - vel[indicesF3 + M,:]),(((lattice[indicesF3 + M,7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 + M,7:9] - lattice[indicesF3,7:9]) ** 2,2)))))),2),(((lattice[indicesF3 + M,7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 + M,7:9] - lattice[indicesF3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF3 + O,7:9] + lattice[indicesF3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF3,:] - vel[indicesF3 + O,:]),(((lattice[indicesF3 + O,7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 + O,7:9] - lattice[indicesF3,7:9]) ** 2,2)))))),2),(((lattice[indicesF3 + O,7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 + O,7:9] - lattice[indicesF3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF3 + P,7:9] + lattice[indicesF3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF3,:] - vel[indicesF3 + P,:]),(((lattice[indicesF3 + P,7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 + P,7:9] - lattice[indicesF3,7:9]) ** 2,2)))))),2),(((lattice[indicesF3 + P,7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 + P,7:9] - lattice[indicesF3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF3 + R,7:9] + lattice[indicesF3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF3,:] - vel[indicesF3 + R,:]),(((lattice[indicesF3 + R,7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 + R,7:9] - lattice[indicesF3,7:9]) ** 2,2)))))),2),(((lattice[indicesF3 + R,7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 + R,7:9] - lattice[indicesF3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF3 + T,7:9] + lattice[indicesF3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF3,:] - vel[indicesF3 + T,:]),(((lattice[indicesF3 + T,7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 + T,7:9] - lattice[indicesF3,7:9]) ** 2,2)))))),2),(((lattice[indicesF3 + T,7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 + T,7:9] - lattice[indicesF3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF3 + U,7:9] + lattice[indicesF3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF3,:] - vel[indicesF3 + U,:]),(((lattice[indicesF3 + U,7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 + U,7:9] - lattice[indicesF3,7:9]) ** 2,2)))))),2),(((lattice[indicesF3 + U,7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 + U,7:9] - lattice[indicesF3,7:9]) ** 2,2)))))) ** 2,2))
    
    Dfuncp[indicesF4,:]=Dfuncp[indicesF4,:] + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF4 + A,7:9] + lattice[indicesF4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF4,:] - vel[indicesF4 + A,:]),(((lattice[indicesF4 + A,7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 + A,7:9] - lattice[indicesF4,7:9]) ** 2,2)))))),2),(((lattice[indicesF4 + A,7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 + A,7:9] - lattice[indicesF4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF4 + B,7:9] + lattice[indicesF4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF4,:] - vel[indicesF4 + B,:]),(((lattice[indicesF4 + B,7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 + B,7:9] - lattice[indicesF4,7:9]) ** 2,2)))))),2),(((lattice[indicesF4 + B,7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 + B,7:9] - lattice[indicesF4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF4 + C,7:9] + lattice[indicesF4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF4,:] - vel[indicesF4 + C,:]),(((lattice[indicesF4 + C,7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 + C,7:9] - lattice[indicesF4,7:9]) ** 2,2)))))),2),(((lattice[indicesF4 + C,7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 + C,7:9] - lattice[indicesF4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF4 + D,7:9] + lattice[indicesF4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF4,:] - vel[indicesF4 + D,:]),(((lattice[indicesF4 + D,7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 + D,7:9] - lattice[indicesF4,7:9]) ** 2,2)))))),2),(((lattice[indicesF4 + D,7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 + D,7:9] - lattice[indicesF4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF4 + E,7:9] + lattice[indicesF4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF4,:] - vel[indicesF4 + E,:]),(((lattice[indicesF4 + E,7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 + E,7:9] - lattice[indicesF4,7:9]) ** 2,2)))))),2),(((lattice[indicesF4 + E,7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 + E,7:9] - lattice[indicesF4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF4 + I,7:9] + lattice[indicesF4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF4,:] - vel[indicesF4 + I,:]),(((lattice[indicesF4 + I,7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 + I,7:9] - lattice[indicesF4,7:9]) ** 2,2)))))),2),(((lattice[indicesF4 + I,7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 + I,7:9] - lattice[indicesF4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF4 + L,7:9] + lattice[indicesF4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF4,:] - vel[indicesF4 + L,:]),(((lattice[indicesF4 + L,7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 + L,7:9] - lattice[indicesF4,7:9]) ** 2,2)))))),2),(((lattice[indicesF4 + L,7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 + L,7:9] - lattice[indicesF4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF4 + O,7:9] + lattice[indicesF4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF4,:] - vel[indicesF4 + O,:]),(((lattice[indicesF4 + O,7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 + O,7:9] - lattice[indicesF4,7:9]) ** 2,2)))))),2),(((lattice[indicesF4 + O,7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 + O,7:9] - lattice[indicesF4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF4 + P,7:9] + lattice[indicesF4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF4,:] - vel[indicesF4 + P,:]),(((lattice[indicesF4 + P,7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 + P,7:9] - lattice[indicesF4,7:9]) ** 2,2)))))),2),(((lattice[indicesF4 + P,7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 + P,7:9] - lattice[indicesF4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF4 + Q,7:9] + lattice[indicesF4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF4,:] - vel[indicesF4 + Q,:]),(((lattice[indicesF4 + Q,7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 + Q,7:9] - lattice[indicesF4,7:9]) ** 2,2)))))),2),(((lattice[indicesF4 + Q,7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 + Q,7:9] - lattice[indicesF4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF4 + R,7:9] + lattice[indicesF4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF4,:] - vel[indicesF4 + R,:]),(((lattice[indicesF4 + R,7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 + R,7:9] - lattice[indicesF4,7:9]) ** 2,2)))))),2),(((lattice[indicesF4 + R,7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 + R,7:9] - lattice[indicesF4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF4 + S,7:9] + lattice[indicesF4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF4,:] - vel[indicesF4 + S,:]),(((lattice[indicesF4 + S,7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 + S,7:9] - lattice[indicesF4,7:9]) ** 2,2)))))),2),(((lattice[indicesF4 + S,7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 + S,7:9] - lattice[indicesF4,7:9]) ** 2,2)))))) ** 2,2))
    
    Dfuncp[indicesF5,:]=Dfuncp[indicesF5,:] + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF5 + B,7:9] + lattice[indicesF5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF5,:] - vel[indicesF5 + B,:]),(((lattice[indicesF5 + B,7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 + B,7:9] - lattice[indicesF5,7:9]) ** 2,2)))))),2),(((lattice[indicesF5 + B,7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 + B,7:9] - lattice[indicesF5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF5 + C,7:9] + lattice[indicesF5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF5,:] - vel[indicesF5 + C,:]),(((lattice[indicesF5 + C,7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 + C,7:9] - lattice[indicesF5,7:9]) ** 2,2)))))),2),(((lattice[indicesF5 + C,7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 + C,7:9] - lattice[indicesF5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF5 + E,7:9] + lattice[indicesF5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF5,:] - vel[indicesF5 + E,:]),(((lattice[indicesF5 + E,7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 + E,7:9] - lattice[indicesF5,7:9]) ** 2,2)))))),2),(((lattice[indicesF5 + E,7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 + E,7:9] - lattice[indicesF5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF5 + G,7:9] + lattice[indicesF5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF5,:] - vel[indicesF5 + G,:]),(((lattice[indicesF5 + G,7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 + G,7:9] - lattice[indicesF5,7:9]) ** 2,2)))))),2),(((lattice[indicesF5 + G,7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 + G,7:9] - lattice[indicesF5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF5 + H,7:9] + lattice[indicesF5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF5,:] - vel[indicesF5 + H,:]),(((lattice[indicesF5 + H,7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 + H,7:9] - lattice[indicesF5,7:9]) ** 2,2)))))),2),(((lattice[indicesF5 + H,7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 + H,7:9] - lattice[indicesF5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF5 + L,7:9] + lattice[indicesF5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF5,:] - vel[indicesF5 + L,:]),(((lattice[indicesF5 + L,7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 + L,7:9] - lattice[indicesF5,7:9]) ** 2,2)))))),2),(((lattice[indicesF5 + L,7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 + L,7:9] - lattice[indicesF5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF5 + N,7:9] + lattice[indicesF5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF5,:] - vel[indicesF5 + N,:]),(((lattice[indicesF5 + N,7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 + N,7:9] - lattice[indicesF5,7:9]) ** 2,2)))))),2),(((lattice[indicesF5 + N,7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 + N,7:9] - lattice[indicesF5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF5 + P,7:9] + lattice[indicesF5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF5,:] - vel[indicesF5 + P,:]),(((lattice[indicesF5 + P,7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 + P,7:9] - lattice[indicesF5,7:9]) ** 2,2)))))),2),(((lattice[indicesF5 + P,7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 + P,7:9] - lattice[indicesF5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF5 + Q,7:9] + lattice[indicesF5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF5,:] - vel[indicesF5 + Q,:]),(((lattice[indicesF5 + Q,7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 + Q,7:9] - lattice[indicesF5,7:9]) ** 2,2)))))),2),(((lattice[indicesF5 + Q,7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 + Q,7:9] - lattice[indicesF5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF5 + S,7:9] + lattice[indicesF5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF5,:] - vel[indicesF5 + S,:]),(((lattice[indicesF5 + S,7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 + S,7:9] - lattice[indicesF5,7:9]) ** 2,2)))))),2),(((lattice[indicesF5 + S,7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 + S,7:9] - lattice[indicesF5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF5 + U,7:9] + lattice[indicesF5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF5,:] - vel[indicesF5 + U,:]),(((lattice[indicesF5 + U,7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 + U,7:9] - lattice[indicesF5,7:9]) ** 2,2)))))),2),(((lattice[indicesF5 + U,7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 + U,7:9] - lattice[indicesF5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF5 + V,7:9] + lattice[indicesF5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF5,:] - vel[indicesF5 + V,:]),(((lattice[indicesF5 + V,7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 + V,7:9] - lattice[indicesF5,7:9]) ** 2,2)))))),2),(((lattice[indicesF5 + V,7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 + V,7:9] - lattice[indicesF5,7:9]) ** 2,2)))))) ** 2,2))
    
    Dfuncp[indicesF6,:]=Dfuncp[indicesF6,:] + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF6 + A,7:9] + lattice[indicesF6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF6,:] - vel[indicesF6 + A,:]),(((lattice[indicesF6 + A,7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 + A,7:9] - lattice[indicesF6,7:9]) ** 2,2)))))),2),(((lattice[indicesF6 + A,7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 + A,7:9] - lattice[indicesF6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF6 + B,7:9] + lattice[indicesF6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF6,:] - vel[indicesF6 + B,:]),(((lattice[indicesF6 + B,7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 + B,7:9] - lattice[indicesF6,7:9]) ** 2,2)))))),2),(((lattice[indicesF6 + B,7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 + B,7:9] - lattice[indicesF6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF6 + C,7:9] + lattice[indicesF6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF6,:] - vel[indicesF6 + C,:]),(((lattice[indicesF6 + C,7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 + C,7:9] - lattice[indicesF6,7:9]) ** 2,2)))))),2),(((lattice[indicesF6 + C,7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 + C,7:9] - lattice[indicesF6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF6 + D,7:9] + lattice[indicesF6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF6,:] - vel[indicesF6 + D,:]),(((lattice[indicesF6 + D,7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 + D,7:9] - lattice[indicesF6,7:9]) ** 2,2)))))),2),(((lattice[indicesF6 + D,7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 + D,7:9] - lattice[indicesF6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF6 + E,7:9] + lattice[indicesF6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF6,:] - vel[indicesF6 + E,:]),(((lattice[indicesF6 + E,7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 + E,7:9] - lattice[indicesF6,7:9]) ** 2,2)))))),2),(((lattice[indicesF6 + E,7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 + E,7:9] - lattice[indicesF6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF6 + F,7:9] + lattice[indicesF6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF6,:] - vel[indicesF6 + F,:]),(((lattice[indicesF6 + F,7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 + F,7:9] - lattice[indicesF6,7:9]) ** 2,2)))))),2),(((lattice[indicesF6 + F,7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 + F,7:9] - lattice[indicesF6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF6 + G,7:9] + lattice[indicesF6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF6,:] - vel[indicesF6 + G,:]),(((lattice[indicesF6 + G,7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 + G,7:9] - lattice[indicesF6,7:9]) ** 2,2)))))),2),(((lattice[indicesF6 + G,7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 + G,7:9] - lattice[indicesF6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF6 + H,7:9] + lattice[indicesF6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF6,:] - vel[indicesF6 + H,:]),(((lattice[indicesF6 + H,7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 + H,7:9] - lattice[indicesF6,7:9]) ** 2,2)))))),2),(((lattice[indicesF6 + H,7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 + H,7:9] - lattice[indicesF6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF6 + I,7:9] + lattice[indicesF6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF6,:] - vel[indicesF6 + I,:]),(((lattice[indicesF6 + I,7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 + I,7:9] - lattice[indicesF6,7:9]) ** 2,2)))))),2),(((lattice[indicesF6 + I,7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 + I,7:9] - lattice[indicesF6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF6 + L,7:9] + lattice[indicesF6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF6,:] - vel[indicesF6 + L,:]),(((lattice[indicesF6 + L,7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 + L,7:9] - lattice[indicesF6,7:9]) ** 2,2)))))),2),(((lattice[indicesF6 + L,7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 + L,7:9] - lattice[indicesF6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF6 + M,7:9] + lattice[indicesF6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF6,:] - vel[indicesF6 + M,:]),(((lattice[indicesF6 + M,7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 + M,7:9] - lattice[indicesF6,7:9]) ** 2,2)))))),2),(((lattice[indicesF6 + M,7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 + M,7:9] - lattice[indicesF6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesF6 + N,7:9] + lattice[indicesF6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF6,:] - vel[indicesF6 + N,:]),(((lattice[indicesF6 + N,7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 + N,7:9] - lattice[indicesF6,7:9]) ** 2,2)))))),2),(((lattice[indicesF6 + N,7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 + N,7:9] - lattice[indicesF6,7:9]) ** 2,2)))))) ** 2,2))
    
    
    Dfuncp[indicesE1,:]=Dfuncp[indicesE1,:] + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE1 + M,7:9] + lattice[indicesE1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE1,:] - vel[indicesE1 + M,:]),(((lattice[indicesE1 + M,7:9] - lattice[indicesE1,7:9])) / (sqrt(sum((lattice[indicesE1 + M,7:9] - lattice[indicesE1,7:9]) ** 2,2)))))),2),(((lattice[indicesE1 + M,7:9] - lattice[indicesE1,7:9])) / (sqrt(sum((lattice[indicesE1 + M,7:9] - lattice[indicesE1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE1 + N,7:9] + lattice[indicesE1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE1,:] - vel[indicesE1 + N,:]),(((lattice[indicesE1 + N,7:9] - lattice[indicesE1,7:9])) / (sqrt(sum((lattice[indicesE1 + N,7:9] - lattice[indicesE1,7:9]) ** 2,2)))))),2),(((lattice[indicesE1 + N,7:9] - lattice[indicesE1,7:9])) / (sqrt(sum((lattice[indicesE1 + N,7:9] - lattice[indicesE1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE1 + R,7:9] + lattice[indicesE1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE1,:] - vel[indicesE1 + R,:]),(((lattice[indicesE1 + R,7:9] - lattice[indicesE1,7:9])) / (sqrt(sum((lattice[indicesE1 + R,7:9] - lattice[indicesE1,7:9]) ** 2,2)))))),2),(((lattice[indicesE1 + R,7:9] - lattice[indicesE1,7:9])) / (sqrt(sum((lattice[indicesE1 + R,7:9] - lattice[indicesE1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE1 + S,7:9] + lattice[indicesE1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE1,:] - vel[indicesE1 + S,:]),(((lattice[indicesE1 + S,7:9] - lattice[indicesE1,7:9])) / (sqrt(sum((lattice[indicesE1 + S,7:9] - lattice[indicesE1,7:9]) ** 2,2)))))),2),(((lattice[indicesE1 + S,7:9] - lattice[indicesE1,7:9])) / (sqrt(sum((lattice[indicesE1 + S,7:9] - lattice[indicesE1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE1 + T,7:9] + lattice[indicesE1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE1,:] - vel[indicesE1 + T,:]),(((lattice[indicesE1 + T,7:9] - lattice[indicesE1,7:9])) / (sqrt(sum((lattice[indicesE1 + T,7:9] - lattice[indicesE1,7:9]) ** 2,2)))))),2),(((lattice[indicesE1 + T,7:9] - lattice[indicesE1,7:9])) / (sqrt(sum((lattice[indicesE1 + T,7:9] - lattice[indicesE1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE1 + U,7:9] + lattice[indicesE1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE1,:] - vel[indicesE1 + U,:]),(((lattice[indicesE1 + U,7:9] - lattice[indicesE1,7:9])) / (sqrt(sum((lattice[indicesE1 + U,7:9] - lattice[indicesE1,7:9]) ** 2,2)))))),2),(((lattice[indicesE1 + U,7:9] - lattice[indicesE1,7:9])) / (sqrt(sum((lattice[indicesE1 + U,7:9] - lattice[indicesE1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE1 + V,7:9] + lattice[indicesE1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE1,:] - vel[indicesE1 + V,:]),(((lattice[indicesE1 + V,7:9] - lattice[indicesE1,7:9])) / (sqrt(sum((lattice[indicesE1 + V,7:9] - lattice[indicesE1,7:9]) ** 2,2)))))),2),(((lattice[indicesE1 + V,7:9] - lattice[indicesE1,7:9])) / (sqrt(sum((lattice[indicesE1 + V,7:9] - lattice[indicesE1,7:9]) ** 2,2)))))) ** 2,2))
    
    Dfuncp[indicesE2,:]=Dfuncp[indicesE2,:] + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE2 + I,7:9] + lattice[indicesE2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE2,:] - vel[indicesE2 + I,:]),(((lattice[indicesE2 + I,7:9] - lattice[indicesE2,7:9])) / (sqrt(sum((lattice[indicesE2 + I,7:9] - lattice[indicesE2,7:9]) ** 2,2)))))),2),(((lattice[indicesE2 + I,7:9] - lattice[indicesE2,7:9])) / (sqrt(sum((lattice[indicesE2 + I,7:9] - lattice[indicesE2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE2 + M,7:9] + lattice[indicesE2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE2,:] - vel[indicesE2 + M,:]),(((lattice[indicesE2 + M,7:9] - lattice[indicesE2,7:9])) / (sqrt(sum((lattice[indicesE2 + M,7:9] - lattice[indicesE2,7:9]) ** 2,2)))))),2),(((lattice[indicesE2 + M,7:9] - lattice[indicesE2,7:9])) / (sqrt(sum((lattice[indicesE2 + M,7:9] - lattice[indicesE2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE2 + O,7:9] + lattice[indicesE2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE2,:] - vel[indicesE2 + O,:]),(((lattice[indicesE2 + O,7:9] - lattice[indicesE2,7:9])) / (sqrt(sum((lattice[indicesE2 + O,7:9] - lattice[indicesE2,7:9]) ** 2,2)))))),2),(((lattice[indicesE2 + O,7:9] - lattice[indicesE2,7:9])) / (sqrt(sum((lattice[indicesE2 + O,7:9] - lattice[indicesE2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE2 + P,7:9] + lattice[indicesE2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE2,:] - vel[indicesE2 + P,:]),(((lattice[indicesE2 + P,7:9] - lattice[indicesE2,7:9])) / (sqrt(sum((lattice[indicesE2 + P,7:9] - lattice[indicesE2,7:9]) ** 2,2)))))),2),(((lattice[indicesE2 + P,7:9] - lattice[indicesE2,7:9])) / (sqrt(sum((lattice[indicesE2 + P,7:9] - lattice[indicesE2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE2 + R,7:9] + lattice[indicesE2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE2,:] - vel[indicesE2 + R,:]),(((lattice[indicesE2 + R,7:9] - lattice[indicesE2,7:9])) / (sqrt(sum((lattice[indicesE2 + R,7:9] - lattice[indicesE2,7:9]) ** 2,2)))))),2),(((lattice[indicesE2 + R,7:9] - lattice[indicesE2,7:9])) / (sqrt(sum((lattice[indicesE2 + R,7:9] - lattice[indicesE2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE2 + T,7:9] + lattice[indicesE2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE2,:] - vel[indicesE2 + T,:]),(((lattice[indicesE2 + T,7:9] - lattice[indicesE2,7:9])) / (sqrt(sum((lattice[indicesE2 + T,7:9] - lattice[indicesE2,7:9]) ** 2,2)))))),2),(((lattice[indicesE2 + T,7:9] - lattice[indicesE2,7:9])) / (sqrt(sum((lattice[indicesE2 + T,7:9] - lattice[indicesE2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE2 + U,7:9] + lattice[indicesE2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE2,:] - vel[indicesE2 + U,:]),(((lattice[indicesE2 + U,7:9] - lattice[indicesE2,7:9])) / (sqrt(sum((lattice[indicesE2 + U,7:9] - lattice[indicesE2,7:9]) ** 2,2)))))),2),(((lattice[indicesE2 + U,7:9] - lattice[indicesE2,7:9])) / (sqrt(sum((lattice[indicesE2 + U,7:9] - lattice[indicesE2,7:9]) ** 2,2)))))) ** 2,2))
    
    
    
    Dfuncp[indicesE3,:]=Dfuncp[indicesE3,:] + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE3 + I,7:9] + lattice[indicesE3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE3,:] - vel[indicesE3 + I,:]),(((lattice[indicesE3 + I,7:9] - lattice[indicesE3,7:9])) / (sqrt(sum((lattice[indicesE3 + I,7:9] - lattice[indicesE3,7:9]) ** 2,2)))))),2),(((lattice[indicesE3 + I,7:9] - lattice[indicesE3,7:9])) / (sqrt(sum((lattice[indicesE3 + I,7:9] - lattice[indicesE3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE3 + L,7:9] + lattice[indicesE3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE3,:] - vel[indicesE3 + L,:]),(((lattice[indicesE3 + L,7:9] - lattice[indicesE3,7:9])) / (sqrt(sum((lattice[indicesE3 + L,7:9] - lattice[indicesE3,7:9]) ** 2,2)))))),2),(((lattice[indicesE3 + L,7:9] - lattice[indicesE3,7:9])) / (sqrt(sum((lattice[indicesE3 + L,7:9] - lattice[indicesE3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE3 + O,7:9] + lattice[indicesE3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE3,:] - vel[indicesE3 + O,:]),(((lattice[indicesE3 + O,7:9] - lattice[indicesE3,7:9])) / (sqrt(sum((lattice[indicesE3 + O,7:9] - lattice[indicesE3,7:9]) ** 2,2)))))),2),(((lattice[indicesE3 + O,7:9] - lattice[indicesE3,7:9])) / (sqrt(sum((lattice[indicesE3 + O,7:9] - lattice[indicesE3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE3 + P,7:9] + lattice[indicesE3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE3,:] - vel[indicesE3 + P,:]),(((lattice[indicesE3 + P,7:9] - lattice[indicesE3,7:9])) / (sqrt(sum((lattice[indicesE3 + P,7:9] - lattice[indicesE3,7:9]) ** 2,2)))))),2),(((lattice[indicesE3 + P,7:9] - lattice[indicesE3,7:9])) / (sqrt(sum((lattice[indicesE3 + P,7:9] - lattice[indicesE3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE3 + Q,7:9] + lattice[indicesE3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE3,:] - vel[indicesE3 + Q,:]),(((lattice[indicesE3 + Q,7:9] - lattice[indicesE3,7:9])) / (sqrt(sum((lattice[indicesE3 + Q,7:9] - lattice[indicesE3,7:9]) ** 2,2)))))),2),(((lattice[indicesE3 + Q,7:9] - lattice[indicesE3,7:9])) / (sqrt(sum((lattice[indicesE3 + Q,7:9] - lattice[indicesE3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE3 + R,7:9] + lattice[indicesE3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE3,:] - vel[indicesE3 + R,:]),(((lattice[indicesE3 + R,7:9] - lattice[indicesE3,7:9])) / (sqrt(sum((lattice[indicesE3 + R,7:9] - lattice[indicesE3,7:9]) ** 2,2)))))),2),(((lattice[indicesE3 + R,7:9] - lattice[indicesE3,7:9])) / (sqrt(sum((lattice[indicesE3 + R,7:9] - lattice[indicesE3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE3 + S,7:9] + lattice[indicesE3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE3,:] - vel[indicesE3 + S,:]),(((lattice[indicesE3 + S,7:9] - lattice[indicesE3,7:9])) / (sqrt(sum((lattice[indicesE3 + S,7:9] - lattice[indicesE3,7:9]) ** 2,2)))))),2),(((lattice[indicesE3 + S,7:9] - lattice[indicesE3,7:9])) / (sqrt(sum((lattice[indicesE3 + S,7:9] - lattice[indicesE3,7:9]) ** 2,2)))))) ** 2,2))
    
    Dfuncp[indicesE4,:]=Dfuncp[indicesE4,:] + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE4 + L,7:9] + lattice[indicesE4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE4,:] - vel[indicesE4 + L,:]),(((lattice[indicesE4 + L,7:9] - lattice[indicesE4,7:9])) / (sqrt(sum((lattice[indicesE4 + L,7:9] - lattice[indicesE4,7:9]) ** 2,2)))))),2),(((lattice[indicesE4 + L,7:9] - lattice[indicesE4,7:9])) / (sqrt(sum((lattice[indicesE4 + L,7:9] - lattice[indicesE4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE4 + N,7:9] + lattice[indicesE4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE4,:] - vel[indicesE4 + N,:]),(((lattice[indicesE4 + N,7:9] - lattice[indicesE4,7:9])) / (sqrt(sum((lattice[indicesE4 + N,7:9] - lattice[indicesE4,7:9]) ** 2,2)))))),2),(((lattice[indicesE4 + N,7:9] - lattice[indicesE4,7:9])) / (sqrt(sum((lattice[indicesE4 + N,7:9] - lattice[indicesE4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE4 + P,7:9] + lattice[indicesE4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE4,:] - vel[indicesE4 + P,:]),(((lattice[indicesE4 + P,7:9] - lattice[indicesE4,7:9])) / (sqrt(sum((lattice[indicesE4 + P,7:9] - lattice[indicesE4,7:9]) ** 2,2)))))),2),(((lattice[indicesE4 + P,7:9] - lattice[indicesE4,7:9])) / (sqrt(sum((lattice[indicesE4 + P,7:9] - lattice[indicesE4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE4 + Q,7:9] + lattice[indicesE4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE4,:] - vel[indicesE4 + Q,:]),(((lattice[indicesE4 + Q,7:9] - lattice[indicesE4,7:9])) / (sqrt(sum((lattice[indicesE4 + Q,7:9] - lattice[indicesE4,7:9]) ** 2,2)))))),2),(((lattice[indicesE4 + Q,7:9] - lattice[indicesE4,7:9])) / (sqrt(sum((lattice[indicesE4 + Q,7:9] - lattice[indicesE4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE4 + S,7:9] + lattice[indicesE4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE4,:] - vel[indicesE4 + S,:]),(((lattice[indicesE4 + S,7:9] - lattice[indicesE4,7:9])) / (sqrt(sum((lattice[indicesE4 + S,7:9] - lattice[indicesE4,7:9]) ** 2,2)))))),2),(((lattice[indicesE4 + S,7:9] - lattice[indicesE4,7:9])) / (sqrt(sum((lattice[indicesE4 + S,7:9] - lattice[indicesE4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE4 + U,7:9] + lattice[indicesE4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE4,:] - vel[indicesE4 + U,:]),(((lattice[indicesE4 + U,7:9] - lattice[indicesE4,7:9])) / (sqrt(sum((lattice[indicesE4 + U,7:9] - lattice[indicesE4,7:9]) ** 2,2)))))),2),(((lattice[indicesE4 + U,7:9] - lattice[indicesE4,7:9])) / (sqrt(sum((lattice[indicesE4 + U,7:9] - lattice[indicesE4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE4 + V,7:9] + lattice[indicesE4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE4,:] - vel[indicesE4 + V,:]),(((lattice[indicesE4 + V,7:9] - lattice[indicesE4,7:9])) / (sqrt(sum((lattice[indicesE4 + V,7:9] - lattice[indicesE4,7:9]) ** 2,2)))))),2),(((lattice[indicesE4 + V,7:9] - lattice[indicesE4,7:9])) / (sqrt(sum((lattice[indicesE4 + V,7:9] - lattice[indicesE4,7:9]) ** 2,2)))))) ** 2,2))
    
    
    Dfuncp[indicesE5,:]=Dfuncp[indicesE5,:] + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE5 + E,7:9] + lattice[indicesE5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE5,:] - vel[indicesE5 + E,:]),(((lattice[indicesE5 + E,7:9] - lattice[indicesE5,7:9])) / (sqrt(sum((lattice[indicesE5 + E,7:9] - lattice[indicesE5,7:9]) ** 2,2)))))),2),(((lattice[indicesE5 + E,7:9] - lattice[indicesE5,7:9])) / (sqrt(sum((lattice[indicesE5 + E,7:9] - lattice[indicesE5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE5 + G,7:9] + lattice[indicesE5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE5,:] - vel[indicesE5 + G,:]),(((lattice[indicesE5 + G,7:9] - lattice[indicesE5,7:9])) / (sqrt(sum((lattice[indicesE5 + G,7:9] - lattice[indicesE5,7:9]) ** 2,2)))))),2),(((lattice[indicesE5 + G,7:9] - lattice[indicesE5,7:9])) / (sqrt(sum((lattice[indicesE5 + G,7:9] - lattice[indicesE5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE5 + H,7:9] + lattice[indicesE5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE5,:] - vel[indicesE5 + H,:]),(((lattice[indicesE5 + H,7:9] - lattice[indicesE5,7:9])) / (sqrt(sum((lattice[indicesE5 + H,7:9] - lattice[indicesE5,7:9]) ** 2,2)))))),2),(((lattice[indicesE5 + H,7:9] - lattice[indicesE5,7:9])) / (sqrt(sum((lattice[indicesE5 + H,7:9] - lattice[indicesE5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE5 + N,7:9] + lattice[indicesE5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE5,:] - vel[indicesE5 + N,:]),(((lattice[indicesE5 + N,7:9] - lattice[indicesE5,7:9])) / (sqrt(sum((lattice[indicesE5 + N,7:9] - lattice[indicesE5,7:9]) ** 2,2)))))),2),(((lattice[indicesE5 + N,7:9] - lattice[indicesE5,7:9])) / (sqrt(sum((lattice[indicesE5 + N,7:9] - lattice[indicesE5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE5 + S,7:9] + lattice[indicesE5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE5,:] - vel[indicesE5 + S,:]),(((lattice[indicesE5 + S,7:9] - lattice[indicesE5,7:9])) / (sqrt(sum((lattice[indicesE5 + S,7:9] - lattice[indicesE5,7:9]) ** 2,2)))))),2),(((lattice[indicesE5 + S,7:9] - lattice[indicesE5,7:9])) / (sqrt(sum((lattice[indicesE5 + S,7:9] - lattice[indicesE5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE5 + U,7:9] + lattice[indicesE5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE5,:] - vel[indicesE5 + U,:]),(((lattice[indicesE5 + U,7:9] - lattice[indicesE5,7:9])) / (sqrt(sum((lattice[indicesE5 + U,7:9] - lattice[indicesE5,7:9]) ** 2,2)))))),2),(((lattice[indicesE5 + U,7:9] - lattice[indicesE5,7:9])) / (sqrt(sum((lattice[indicesE5 + U,7:9] - lattice[indicesE5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE5 + V,7:9] + lattice[indicesE5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE5,:] - vel[indicesE5 + V,:]),(((lattice[indicesE5 + V,7:9] - lattice[indicesE5,7:9])) / (sqrt(sum((lattice[indicesE5 + V,7:9] - lattice[indicesE5,7:9]) ** 2,2)))))),2),(((lattice[indicesE5 + V,7:9] - lattice[indicesE5,7:9])) / (sqrt(sum((lattice[indicesE5 + V,7:9] - lattice[indicesE5,7:9]) ** 2,2)))))) ** 2,2))
    
    Dfuncp[indicesE6,:]=Dfuncp[indicesE6,:] + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE6 + D,7:9] + lattice[indicesE6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE6,:] - vel[indicesE6 + D,:]),(((lattice[indicesE6 + D,7:9] - lattice[indicesE6,7:9])) / (sqrt(sum((lattice[indicesE6 + D,7:9] - lattice[indicesE6,7:9]) ** 2,2)))))),2),(((lattice[indicesE6 + D,7:9] - lattice[indicesE6,7:9])) / (sqrt(sum((lattice[indicesE6 + D,7:9] - lattice[indicesE6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE6 + F,7:9] + lattice[indicesE6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE6,:] - vel[indicesE6 + F,:]),(((lattice[indicesE6 + F,7:9] - lattice[indicesE6,7:9])) / (sqrt(sum((lattice[indicesE6 + F,7:9] - lattice[indicesE6,7:9]) ** 2,2)))))),2),(((lattice[indicesE6 + F,7:9] - lattice[indicesE6,7:9])) / (sqrt(sum((lattice[indicesE6 + F,7:9] - lattice[indicesE6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE6 + G,7:9] + lattice[indicesE6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE6,:] - vel[indicesE6 + G,:]),(((lattice[indicesE6 + G,7:9] - lattice[indicesE6,7:9])) / (sqrt(sum((lattice[indicesE6 + G,7:9] - lattice[indicesE6,7:9]) ** 2,2)))))),2),(((lattice[indicesE6 + G,7:9] - lattice[indicesE6,7:9])) / (sqrt(sum((lattice[indicesE6 + G,7:9] - lattice[indicesE6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE6 + M,7:9] + lattice[indicesE6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE6,:] - vel[indicesE6 + M,:]),(((lattice[indicesE6 + M,7:9] - lattice[indicesE6,7:9])) / (sqrt(sum((lattice[indicesE6 + M,7:9] - lattice[indicesE6,7:9]) ** 2,2)))))),2),(((lattice[indicesE6 + M,7:9] - lattice[indicesE6,7:9])) / (sqrt(sum((lattice[indicesE6 + M,7:9] - lattice[indicesE6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE6 + R,7:9] + lattice[indicesE6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE6,:] - vel[indicesE6 + R,:]),(((lattice[indicesE6 + R,7:9] - lattice[indicesE6,7:9])) / (sqrt(sum((lattice[indicesE6 + R,7:9] - lattice[indicesE6,7:9]) ** 2,2)))))),2),(((lattice[indicesE6 + R,7:9] - lattice[indicesE6,7:9])) / (sqrt(sum((lattice[indicesE6 + R,7:9] - lattice[indicesE6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE6 + T,7:9] + lattice[indicesE6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE6,:] - vel[indicesE6 + T,:]),(((lattice[indicesE6 + T,7:9] - lattice[indicesE6,7:9])) / (sqrt(sum((lattice[indicesE6 + T,7:9] - lattice[indicesE6,7:9]) ** 2,2)))))),2),(((lattice[indicesE6 + T,7:9] - lattice[indicesE6,7:9])) / (sqrt(sum((lattice[indicesE6 + T,7:9] - lattice[indicesE6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE6 + U,7:9] + lattice[indicesE6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE6,:] - vel[indicesE6 + U,:]),(((lattice[indicesE6 + U,7:9] - lattice[indicesE6,7:9])) / (sqrt(sum((lattice[indicesE6 + U,7:9] - lattice[indicesE6,7:9]) ** 2,2)))))),2),(((lattice[indicesE6 + U,7:9] - lattice[indicesE6,7:9])) / (sqrt(sum((lattice[indicesE6 + U,7:9] - lattice[indicesE6,7:9]) ** 2,2)))))) ** 2,2))
    
    Dfuncp[indicesE7,:]=Dfuncp[indicesE7,:] + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE7 + A,7:9] + lattice[indicesE7,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE7,:] - vel[indicesE7 + A,:]),(((lattice[indicesE7 + A,7:9] - lattice[indicesE7,7:9])) / (sqrt(sum((lattice[indicesE7 + A,7:9] - lattice[indicesE7,7:9]) ** 2,2)))))),2),(((lattice[indicesE7 + A,7:9] - lattice[indicesE7,7:9])) / (sqrt(sum((lattice[indicesE7 + A,7:9] - lattice[indicesE7,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE7 + B,7:9] + lattice[indicesE7,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE7,:] - vel[indicesE7 + B,:]),(((lattice[indicesE7 + B,7:9] - lattice[indicesE7,7:9])) / (sqrt(sum((lattice[indicesE7 + B,7:9] - lattice[indicesE7,7:9]) ** 2,2)))))),2),(((lattice[indicesE7 + B,7:9] - lattice[indicesE7,7:9])) / (sqrt(sum((lattice[indicesE7 + B,7:9] - lattice[indicesE7,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE7 + D,7:9] + lattice[indicesE7,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE7,:] - vel[indicesE7 + D,:]),(((lattice[indicesE7 + D,7:9] - lattice[indicesE7,7:9])) / (sqrt(sum((lattice[indicesE7 + D,7:9] - lattice[indicesE7,7:9]) ** 2,2)))))),2),(((lattice[indicesE7 + D,7:9] - lattice[indicesE7,7:9])) / (sqrt(sum((lattice[indicesE7 + D,7:9] - lattice[indicesE7,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE7 + I,7:9] + lattice[indicesE7,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE7,:] - vel[indicesE7 + I,:]),(((lattice[indicesE7 + I,7:9] - lattice[indicesE7,7:9])) / (sqrt(sum((lattice[indicesE7 + I,7:9] - lattice[indicesE7,7:9]) ** 2,2)))))),2),(((lattice[indicesE7 + I,7:9] - lattice[indicesE7,7:9])) / (sqrt(sum((lattice[indicesE7 + I,7:9] - lattice[indicesE7,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE7 + O,7:9] + lattice[indicesE7,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE7,:] - vel[indicesE7 + O,:]),(((lattice[indicesE7 + O,7:9] - lattice[indicesE7,7:9])) / (sqrt(sum((lattice[indicesE7 + O,7:9] - lattice[indicesE7,7:9]) ** 2,2)))))),2),(((lattice[indicesE7 + O,7:9] - lattice[indicesE7,7:9])) / (sqrt(sum((lattice[indicesE7 + O,7:9] - lattice[indicesE7,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE7 + P,7:9] + lattice[indicesE7,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE7,:] - vel[indicesE7 + P,:]),(((lattice[indicesE7 + P,7:9] - lattice[indicesE7,7:9])) / (sqrt(sum((lattice[indicesE7 + P,7:9] - lattice[indicesE7,7:9]) ** 2,2)))))),2),(((lattice[indicesE7 + P,7:9] - lattice[indicesE7,7:9])) / (sqrt(sum((lattice[indicesE7 + P,7:9] - lattice[indicesE7,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE7 + R,7:9] + lattice[indicesE7,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE7,:] - vel[indicesE7 + R,:]),(((lattice[indicesE7 + R,7:9] - lattice[indicesE7,7:9])) / (sqrt(sum((lattice[indicesE7 + R,7:9] - lattice[indicesE7,7:9]) ** 2,2)))))),2),(((lattice[indicesE7 + R,7:9] - lattice[indicesE7,7:9])) / (sqrt(sum((lattice[indicesE7 + R,7:9] - lattice[indicesE7,7:9]) ** 2,2)))))) ** 2,2))
    
    Dfuncp[indicesE8,:]=Dfuncp[indicesE8,:] + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE8 + B,7:9] + lattice[indicesE8,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE8,:] - vel[indicesE8 + B,:]),(((lattice[indicesE8 + B,7:9] - lattice[indicesE8,7:9])) / (sqrt(sum((lattice[indicesE8 + B,7:9] - lattice[indicesE8,7:9]) ** 2,2)))))),2),(((lattice[indicesE8 + B,7:9] - lattice[indicesE8,7:9])) / (sqrt(sum((lattice[indicesE8 + B,7:9] - lattice[indicesE8,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE8 + C,7:9] + lattice[indicesE8,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE8,:] - vel[indicesE8 + C,:]),(((lattice[indicesE8 + C,7:9] - lattice[indicesE8,7:9])) / (sqrt(sum((lattice[indicesE8 + C,7:9] - lattice[indicesE8,7:9]) ** 2,2)))))),2),(((lattice[indicesE8 + C,7:9] - lattice[indicesE8,7:9])) / (sqrt(sum((lattice[indicesE8 + C,7:9] - lattice[indicesE8,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE8 + E,7:9] + lattice[indicesE8,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE8,:] - vel[indicesE8 + E,:]),(((lattice[indicesE8 + E,7:9] - lattice[indicesE8,7:9])) / (sqrt(sum((lattice[indicesE8 + E,7:9] - lattice[indicesE8,7:9]) ** 2,2)))))),2),(((lattice[indicesE8 + E,7:9] - lattice[indicesE8,7:9])) / (sqrt(sum((lattice[indicesE8 + E,7:9] - lattice[indicesE8,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE8 + L,7:9] + lattice[indicesE8,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE8,:] - vel[indicesE8 + L,:]),(((lattice[indicesE8 + L,7:9] - lattice[indicesE8,7:9])) / (sqrt(sum((lattice[indicesE8 + L,7:9] - lattice[indicesE8,7:9]) ** 2,2)))))),2),(((lattice[indicesE8 + L,7:9] - lattice[indicesE8,7:9])) / (sqrt(sum((lattice[indicesE8 + L,7:9] - lattice[indicesE8,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE8 + P,7:9] + lattice[indicesE8,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE8,:] - vel[indicesE8 + P,:]),(((lattice[indicesE8 + P,7:9] - lattice[indicesE8,7:9])) / (sqrt(sum((lattice[indicesE8 + P,7:9] - lattice[indicesE8,7:9]) ** 2,2)))))),2),(((lattice[indicesE8 + P,7:9] - lattice[indicesE8,7:9])) / (sqrt(sum((lattice[indicesE8 + P,7:9] - lattice[indicesE8,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE8 + Q,7:9] + lattice[indicesE8,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE8,:] - vel[indicesE8 + Q,:]),(((lattice[indicesE8 + Q,7:9] - lattice[indicesE8,7:9])) / (sqrt(sum((lattice[indicesE8 + Q,7:9] - lattice[indicesE8,7:9]) ** 2,2)))))),2),(((lattice[indicesE8 + Q,7:9] - lattice[indicesE8,7:9])) / (sqrt(sum((lattice[indicesE8 + Q,7:9] - lattice[indicesE8,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE8 + S,7:9] + lattice[indicesE8,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE8,:] - vel[indicesE8 + S,:]),(((lattice[indicesE8 + S,7:9] - lattice[indicesE8,7:9])) / (sqrt(sum((lattice[indicesE8 + S,7:9] - lattice[indicesE8,7:9]) ** 2,2)))))),2),(((lattice[indicesE8 + S,7:9] - lattice[indicesE8,7:9])) / (sqrt(sum((lattice[indicesE8 + S,7:9] - lattice[indicesE8,7:9]) ** 2,2)))))) ** 2,2))
    
    Dfuncp[indicesE9,:]=Dfuncp[indicesE9,:] + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE9 + D,7:9] + lattice[indicesE9,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE9,:] - vel[indicesE9 + D,:]),(((lattice[indicesE9 + D,7:9] - lattice[indicesE9,7:9])) / (sqrt(sum((lattice[indicesE9 + D,7:9] - lattice[indicesE9,7:9]) ** 2,2)))))),2),(((lattice[indicesE9 + D,7:9] - lattice[indicesE9,7:9])) / (sqrt(sum((lattice[indicesE9 + D,7:9] - lattice[indicesE9,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE9 + E,7:9] + lattice[indicesE9,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE9,:] - vel[indicesE9 + E,:]),(((lattice[indicesE9 + E,7:9] - lattice[indicesE9,7:9])) / (sqrt(sum((lattice[indicesE9 + E,7:9] - lattice[indicesE9,7:9]) ** 2,2)))))),2),(((lattice[indicesE9 + E,7:9] - lattice[indicesE9,7:9])) / (sqrt(sum((lattice[indicesE9 + E,7:9] - lattice[indicesE9,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE9 + F,7:9] + lattice[indicesE9,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE9,:] - vel[indicesE9 + F,:]),(((lattice[indicesE9 + F,7:9] - lattice[indicesE9,7:9])) / (sqrt(sum((lattice[indicesE9 + F,7:9] - lattice[indicesE9,7:9]) ** 2,2)))))),2),(((lattice[indicesE9 + F,7:9] - lattice[indicesE9,7:9])) / (sqrt(sum((lattice[indicesE9 + F,7:9] - lattice[indicesE9,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE9 + G,7:9] + lattice[indicesE9,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE9,:] - vel[indicesE9 + G,:]),(((lattice[indicesE9 + G,7:9] - lattice[indicesE9,7:9])) / (sqrt(sum((lattice[indicesE9 + G,7:9] - lattice[indicesE9,7:9]) ** 2,2)))))),2),(((lattice[indicesE9 + G,7:9] - lattice[indicesE9,7:9])) / (sqrt(sum((lattice[indicesE9 + G,7:9] - lattice[indicesE9,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE9 + H,7:9] + lattice[indicesE9,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE9,:] - vel[indicesE9 + H,:]),(((lattice[indicesE9 + H,7:9] - lattice[indicesE9,7:9])) / (sqrt(sum((lattice[indicesE9 + H,7:9] - lattice[indicesE9,7:9]) ** 2,2)))))),2),(((lattice[indicesE9 + H,7:9] - lattice[indicesE9,7:9])) / (sqrt(sum((lattice[indicesE9 + H,7:9] - lattice[indicesE9,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE9 + M,7:9] + lattice[indicesE9,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE9,:] - vel[indicesE9 + M,:]),(((lattice[indicesE9 + M,7:9] - lattice[indicesE9,7:9])) / (sqrt(sum((lattice[indicesE9 + M,7:9] - lattice[indicesE9,7:9]) ** 2,2)))))),2),(((lattice[indicesE9 + M,7:9] - lattice[indicesE9,7:9])) / (sqrt(sum((lattice[indicesE9 + M,7:9] - lattice[indicesE9,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE9 + N,7:9] + lattice[indicesE9,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE9,:] - vel[indicesE9 + N,:]),(((lattice[indicesE9 + N,7:9] - lattice[indicesE9,7:9])) / (sqrt(sum((lattice[indicesE9 + N,7:9] - lattice[indicesE9,7:9]) ** 2,2)))))),2),(((lattice[indicesE9 + N,7:9] - lattice[indicesE9,7:9])) / (sqrt(sum((lattice[indicesE9 + N,7:9] - lattice[indicesE9,7:9]) ** 2,2)))))) ** 2,2))
    
    Dfuncp[indicesE10,:]=Dfuncp[indicesE10,:] + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE10 + A,7:9] + lattice[indicesE10,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE10,:] - vel[indicesE10 + A,:]),(((lattice[indicesE10 + A,7:9] - lattice[indicesE10,7:9])) / (sqrt(sum((lattice[indicesE10 + A,7:9] - lattice[indicesE10,7:9]) ** 2,2)))))),2),(((lattice[indicesE10 + A,7:9] - lattice[indicesE10,7:9])) / (sqrt(sum((lattice[indicesE10 + A,7:9] - lattice[indicesE10,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE10 + B,7:9] + lattice[indicesE10,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE10,:] - vel[indicesE10 + B,:]),(((lattice[indicesE10 + B,7:9] - lattice[indicesE10,7:9])) / (sqrt(sum((lattice[indicesE10 + B,7:9] - lattice[indicesE10,7:9]) ** 2,2)))))),2),(((lattice[indicesE10 + B,7:9] - lattice[indicesE10,7:9])) / (sqrt(sum((lattice[indicesE10 + B,7:9] - lattice[indicesE10,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE10 + D,7:9] + lattice[indicesE10,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE10,:] - vel[indicesE10 + D,:]),(((lattice[indicesE10 + D,7:9] - lattice[indicesE10,7:9])) / (sqrt(sum((lattice[indicesE10 + D,7:9] - lattice[indicesE10,7:9]) ** 2,2)))))),2),(((lattice[indicesE10 + D,7:9] - lattice[indicesE10,7:9])) / (sqrt(sum((lattice[indicesE10 + D,7:9] - lattice[indicesE10,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE10 + F,7:9] + lattice[indicesE10,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE10,:] - vel[indicesE10 + F,:]),(((lattice[indicesE10 + F,7:9] - lattice[indicesE10,7:9])) / (sqrt(sum((lattice[indicesE10 + F,7:9] - lattice[indicesE10,7:9]) ** 2,2)))))),2),(((lattice[indicesE10 + F,7:9] - lattice[indicesE10,7:9])) / (sqrt(sum((lattice[indicesE10 + F,7:9] - lattice[indicesE10,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE10 + G,7:9] + lattice[indicesE10,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE10,:] - vel[indicesE10 + G,:]),(((lattice[indicesE10 + G,7:9] - lattice[indicesE10,7:9])) / (sqrt(sum((lattice[indicesE10 + G,7:9] - lattice[indicesE10,7:9]) ** 2,2)))))),2),(((lattice[indicesE10 + G,7:9] - lattice[indicesE10,7:9])) / (sqrt(sum((lattice[indicesE10 + G,7:9] - lattice[indicesE10,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE10 + I,7:9] + lattice[indicesE10,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE10,:] - vel[indicesE10 + I,:]),(((lattice[indicesE10 + I,7:9] - lattice[indicesE10,7:9])) / (sqrt(sum((lattice[indicesE10 + I,7:9] - lattice[indicesE10,7:9]) ** 2,2)))))),2),(((lattice[indicesE10 + I,7:9] - lattice[indicesE10,7:9])) / (sqrt(sum((lattice[indicesE10 + I,7:9] - lattice[indicesE10,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE10 + M,7:9] + lattice[indicesE10,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE10,:] - vel[indicesE10 + M,:]),(((lattice[indicesE10 + M,7:9] - lattice[indicesE10,7:9])) / (sqrt(sum((lattice[indicesE10 + M,7:9] - lattice[indicesE10,7:9]) ** 2,2)))))),2),(((lattice[indicesE10 + M,7:9] - lattice[indicesE10,7:9])) / (sqrt(sum((lattice[indicesE10 + M,7:9] - lattice[indicesE10,7:9]) ** 2,2)))))) ** 2,2))
    
    
    Dfuncp[indicesE11,:]=Dfuncp[indicesE11,:] + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE11 + A,7:9] + lattice[indicesE11,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE11,:] - vel[indicesE11 + A,:]),(((lattice[indicesE11 + A,7:9] - lattice[indicesE11,7:9])) / (sqrt(sum((lattice[indicesE11 + A,7:9] - lattice[indicesE11,7:9]) ** 2,2)))))),2),(((lattice[indicesE11 + A,7:9] - lattice[indicesE11,7:9])) / (sqrt(sum((lattice[indicesE11 + A,7:9] - lattice[indicesE11,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE11 + B,7:9] + lattice[indicesE11,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE11,:] - vel[indicesE11 + B,:]),(((lattice[indicesE11 + B,7:9] - lattice[indicesE11,7:9])) / (sqrt(sum((lattice[indicesE11 + B,7:9] - lattice[indicesE11,7:9]) ** 2,2)))))),2),(((lattice[indicesE11 + B,7:9] - lattice[indicesE11,7:9])) / (sqrt(sum((lattice[indicesE11 + B,7:9] - lattice[indicesE11,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE11 + C,7:9] + lattice[indicesE11,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE11,:] - vel[indicesE11 + C,:]),(((lattice[indicesE11 + C,7:9] - lattice[indicesE11,7:9])) / (sqrt(sum((lattice[indicesE11 + C,7:9] - lattice[indicesE11,7:9]) ** 2,2)))))),2),(((lattice[indicesE11 + C,7:9] - lattice[indicesE11,7:9])) / (sqrt(sum((lattice[indicesE11 + C,7:9] - lattice[indicesE11,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE11 + D,7:9] + lattice[indicesE11,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE11,:] - vel[indicesE11 + D,:]),(((lattice[indicesE11 + D,7:9] - lattice[indicesE11,7:9])) / (sqrt(sum((lattice[indicesE11 + D,7:9] - lattice[indicesE11,7:9]) ** 2,2)))))),2),(((lattice[indicesE11 + D,7:9] - lattice[indicesE11,7:9])) / (sqrt(sum((lattice[indicesE11 + D,7:9] - lattice[indicesE11,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE11 + E,7:9] + lattice[indicesE11,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE11,:] - vel[indicesE11 + E,:]),(((lattice[indicesE11 + E,7:9] - lattice[indicesE11,7:9])) / (sqrt(sum((lattice[indicesE11 + E,7:9] - lattice[indicesE11,7:9]) ** 2,2)))))),2),(((lattice[indicesE11 + E,7:9] - lattice[indicesE11,7:9])) / (sqrt(sum((lattice[indicesE11 + E,7:9] - lattice[indicesE11,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE11 + I,7:9] + lattice[indicesE11,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE11,:] - vel[indicesE11 + I,:]),(((lattice[indicesE11 + I,7:9] - lattice[indicesE11,7:9])) / (sqrt(sum((lattice[indicesE11 + I,7:9] - lattice[indicesE11,7:9]) ** 2,2)))))),2),(((lattice[indicesE11 + I,7:9] - lattice[indicesE11,7:9])) / (sqrt(sum((lattice[indicesE11 + I,7:9] - lattice[indicesE11,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE11 + L,7:9] + lattice[indicesE11,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE11,:] - vel[indicesE11 + L,:]),(((lattice[indicesE11 + L,7:9] - lattice[indicesE11,7:9])) / (sqrt(sum((lattice[indicesE11 + L,7:9] - lattice[indicesE11,7:9]) ** 2,2)))))),2),(((lattice[indicesE11 + L,7:9] - lattice[indicesE11,7:9])) / (sqrt(sum((lattice[indicesE11 + L,7:9] - lattice[indicesE11,7:9]) ** 2,2)))))) ** 2,2))
    
    Dfuncp[indicesE12,:]=Dfuncp[indicesE12,:] + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE12 + B,7:9] + lattice[indicesE12,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE12,:] - vel[indicesE12 + B,:]),(((lattice[indicesE12 + B,7:9] - lattice[indicesE12,7:9])) / (sqrt(sum((lattice[indicesE12 + B,7:9] - lattice[indicesE12,7:9]) ** 2,2)))))),2),(((lattice[indicesE12 + B,7:9] - lattice[indicesE12,7:9])) / (sqrt(sum((lattice[indicesE12 + B,7:9] - lattice[indicesE12,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE12 + C,7:9] + lattice[indicesE12,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE12,:] - vel[indicesE12 + C,:]),(((lattice[indicesE12 + C,7:9] - lattice[indicesE12,7:9])) / (sqrt(sum((lattice[indicesE12 + C,7:9] - lattice[indicesE12,7:9]) ** 2,2)))))),2),(((lattice[indicesE12 + C,7:9] - lattice[indicesE12,7:9])) / (sqrt(sum((lattice[indicesE12 + C,7:9] - lattice[indicesE12,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE12 + E,7:9] + lattice[indicesE12,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE12,:] - vel[indicesE12 + E,:]),(((lattice[indicesE12 + E,7:9] - lattice[indicesE12,7:9])) / (sqrt(sum((lattice[indicesE12 + E,7:9] - lattice[indicesE12,7:9]) ** 2,2)))))),2),(((lattice[indicesE12 + E,7:9] - lattice[indicesE12,7:9])) / (sqrt(sum((lattice[indicesE12 + E,7:9] - lattice[indicesE12,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE12 + G,7:9] + lattice[indicesE12,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE12,:] - vel[indicesE12 + G,:]),(((lattice[indicesE12 + G,7:9] - lattice[indicesE12,7:9])) / (sqrt(sum((lattice[indicesE12 + G,7:9] - lattice[indicesE12,7:9]) ** 2,2)))))),2),(((lattice[indicesE12 + G,7:9] - lattice[indicesE12,7:9])) / (sqrt(sum((lattice[indicesE12 + G,7:9] - lattice[indicesE12,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE12 + H,7:9] + lattice[indicesE12,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE12,:] - vel[indicesE12 + H,:]),(((lattice[indicesE12 + H,7:9] - lattice[indicesE12,7:9])) / (sqrt(sum((lattice[indicesE12 + H,7:9] - lattice[indicesE12,7:9]) ** 2,2)))))),2),(((lattice[indicesE12 + H,7:9] - lattice[indicesE12,7:9])) / (sqrt(sum((lattice[indicesE12 + H,7:9] - lattice[indicesE12,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE12 + L,7:9] + lattice[indicesE12,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE12,:] - vel[indicesE12 + L,:]),(((lattice[indicesE12 + L,7:9] - lattice[indicesE12,7:9])) / (sqrt(sum((lattice[indicesE12 + L,7:9] - lattice[indicesE12,7:9]) ** 2,2)))))),2),(((lattice[indicesE12 + L,7:9] - lattice[indicesE12,7:9])) / (sqrt(sum((lattice[indicesE12 + L,7:9] - lattice[indicesE12,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesE12 + N,7:9] + lattice[indicesE12,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE12,:] - vel[indicesE12 + N,:]),(((lattice[indicesE12 + N,7:9] - lattice[indicesE12,7:9])) / (sqrt(sum((lattice[indicesE12 + N,7:9] - lattice[indicesE12,7:9]) ** 2,2)))))),2),(((lattice[indicesE12 + N,7:9] - lattice[indicesE12,7:9])) / (sqrt(sum((lattice[indicesE12 + N,7:9] - lattice[indicesE12,7:9]) ** 2,2)))))) ** 2,2))
    
    
    Dfuncp[indicesC1,:]=Dfuncp[indicesC1,:] + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesC1 + N,7:9] + lattice[indicesC1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC1,:] - vel[indicesC1 + N,:]),(((lattice[indicesC1 + N,7:9] - lattice[indicesC1,7:9])) / (sqrt(sum((lattice[indicesC1 + N,7:9] - lattice[indicesC1,7:9]) ** 2,2)))))),2),(((lattice[indicesC1 + N,7:9] - lattice[indicesC1,7:9])) / (sqrt(sum((lattice[indicesC1 + N,7:9] - lattice[indicesC1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesC1 + S,7:9] + lattice[indicesC1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC1,:] - vel[indicesC1 + S,:]),(((lattice[indicesC1 + S,7:9] - lattice[indicesC1,7:9])) / (sqrt(sum((lattice[indicesC1 + S,7:9] - lattice[indicesC1,7:9]) ** 2,2)))))),2),(((lattice[indicesC1 + S,7:9] - lattice[indicesC1,7:9])) / (sqrt(sum((lattice[indicesC1 + S,7:9] - lattice[indicesC1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesC1 + U,7:9] + lattice[indicesC1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC1,:] - vel[indicesC1 + U,:]),(((lattice[indicesC1 + U,7:9] - lattice[indicesC1,7:9])) / (sqrt(sum((lattice[indicesC1 + U,7:9] - lattice[indicesC1,7:9]) ** 2,2)))))),2),(((lattice[indicesC1 + U,7:9] - lattice[indicesC1,7:9])) / (sqrt(sum((lattice[indicesC1 + U,7:9] - lattice[indicesC1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesC1 + V,7:9] + lattice[indicesC1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC1,:] - vel[indicesC1 + V,:]),(((lattice[indicesC1 + V,7:9] - lattice[indicesC1,7:9])) / (sqrt(sum((lattice[indicesC1 + V,7:9] - lattice[indicesC1,7:9]) ** 2,2)))))),2),(((lattice[indicesC1 + V,7:9] - lattice[indicesC1,7:9])) / (sqrt(sum((lattice[indicesC1 + V,7:9] - lattice[indicesC1,7:9]) ** 2,2)))))) ** 2,2))
    
    Dfuncp[indicesC2,:]=Dfuncp[indicesC2,:] + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesC2 + M,7:9] + lattice[indicesC2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC2,:] - vel[indicesC2 + M,:]),(((lattice[indicesC2 + M,7:9] - lattice[indicesC2,7:9])) / (sqrt(sum((lattice[indicesC2 + M,7:9] - lattice[indicesC2,7:9]) ** 2,2)))))),2),(((lattice[indicesC2 + M,7:9] - lattice[indicesC2,7:9])) / (sqrt(sum((lattice[indicesC2 + M,7:9] - lattice[indicesC2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesC2 + R,7:9] + lattice[indicesC2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC2,:] - vel[indicesC2 + R,:]),(((lattice[indicesC2 + R,7:9] - lattice[indicesC2,7:9])) / (sqrt(sum((lattice[indicesC2 + R,7:9] - lattice[indicesC2,7:9]) ** 2,2)))))),2),(((lattice[indicesC2 + R,7:9] - lattice[indicesC2,7:9])) / (sqrt(sum((lattice[indicesC2 + R,7:9] - lattice[indicesC2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesC2 + T,7:9] + lattice[indicesC2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC2,:] - vel[indicesC2 + T,:]),(((lattice[indicesC2 + T,7:9] - lattice[indicesC2,7:9])) / (sqrt(sum((lattice[indicesC2 + T,7:9] - lattice[indicesC2,7:9]) ** 2,2)))))),2),(((lattice[indicesC2 + T,7:9] - lattice[indicesC2,7:9])) / (sqrt(sum((lattice[indicesC2 + T,7:9] - lattice[indicesC2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesC2 + U,7:9] + lattice[indicesC2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC2,:] - vel[indicesC2 + U,:]),(((lattice[indicesC2 + U,7:9] - lattice[indicesC2,7:9])) / (sqrt(sum((lattice[indicesC2 + U,7:9] - lattice[indicesC2,7:9]) ** 2,2)))))),2),(((lattice[indicesC2 + U,7:9] - lattice[indicesC2,7:9])) / (sqrt(sum((lattice[indicesC2 + U,7:9] - lattice[indicesC2,7:9]) ** 2,2)))))) ** 2,2))
    
    Dfuncp[indicesC3,:]=Dfuncp[indicesC3,:] + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesC3 + I,7:9] + lattice[indicesC3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC3,:] - vel[indicesC3 + I,:]),(((lattice[indicesC3 + I,7:9] - lattice[indicesC3,7:9])) / (sqrt(sum((lattice[indicesC3 + I,7:9] - lattice[indicesC3,7:9]) ** 2,2)))))),2),(((lattice[indicesC3 + I,7:9] - lattice[indicesC3,7:9])) / (sqrt(sum((lattice[indicesC3 + I,7:9] - lattice[indicesC3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesC3 + O,7:9] + lattice[indicesC3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC3,:] - vel[indicesC3 + O,:]),(((lattice[indicesC3 + O,7:9] - lattice[indicesC3,7:9])) / (sqrt(sum((lattice[indicesC3 + O,7:9] - lattice[indicesC3,7:9]) ** 2,2)))))),2),(((lattice[indicesC3 + O,7:9] - lattice[indicesC3,7:9])) / (sqrt(sum((lattice[indicesC3 + O,7:9] - lattice[indicesC3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesC3 + P,7:9] + lattice[indicesC3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC3,:] - vel[indicesC3 + P,:]),(((lattice[indicesC3 + P,7:9] - lattice[indicesC3,7:9])) / (sqrt(sum((lattice[indicesC3 + P,7:9] - lattice[indicesC3,7:9]) ** 2,2)))))),2),(((lattice[indicesC3 + P,7:9] - lattice[indicesC3,7:9])) / (sqrt(sum((lattice[indicesC3 + P,7:9] - lattice[indicesC3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesC3 + R,7:9] + lattice[indicesC3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC3,:] - vel[indicesC3 + R,:]),(((lattice[indicesC3 + R,7:9] - lattice[indicesC3,7:9])) / (sqrt(sum((lattice[indicesC3 + R,7:9] - lattice[indicesC3,7:9]) ** 2,2)))))),2),(((lattice[indicesC3 + R,7:9] - lattice[indicesC3,7:9])) / (sqrt(sum((lattice[indicesC3 + R,7:9] - lattice[indicesC3,7:9]) ** 2,2)))))) ** 2,2))
    
    Dfuncp[indicesC4,:]=Dfuncp[indicesC4,:] + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesC4 + L,7:9] + lattice[indicesC4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC4,:] - vel[indicesC4 + L,:]),(((lattice[indicesC4 + L,7:9] - lattice[indicesC4,7:9])) / (sqrt(sum((lattice[indicesC4 + L,7:9] - lattice[indicesC4,7:9]) ** 2,2)))))),2),(((lattice[indicesC4 + L,7:9] - lattice[indicesC4,7:9])) / (sqrt(sum((lattice[indicesC4 + L,7:9] - lattice[indicesC4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesC4 + P,7:9] + lattice[indicesC4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC4,:] - vel[indicesC4 + P,:]),(((lattice[indicesC4 + P,7:9] - lattice[indicesC4,7:9])) / (sqrt(sum((lattice[indicesC4 + P,7:9] - lattice[indicesC4,7:9]) ** 2,2)))))),2),(((lattice[indicesC4 + P,7:9] - lattice[indicesC4,7:9])) / (sqrt(sum((lattice[indicesC4 + P,7:9] - lattice[indicesC4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesC4 + Q,7:9] + lattice[indicesC4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC4,:] - vel[indicesC4 + Q,:]),(((lattice[indicesC4 + Q,7:9] - lattice[indicesC4,7:9])) / (sqrt(sum((lattice[indicesC4 + Q,7:9] - lattice[indicesC4,7:9]) ** 2,2)))))),2),(((lattice[indicesC4 + Q,7:9] - lattice[indicesC4,7:9])) / (sqrt(sum((lattice[indicesC4 + Q,7:9] - lattice[indicesC4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesC4 + S,7:9] + lattice[indicesC4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC4,:] - vel[indicesC4 + S,:]),(((lattice[indicesC4 + S,7:9] - lattice[indicesC4,7:9])) / (sqrt(sum((lattice[indicesC4 + S,7:9] - lattice[indicesC4,7:9]) ** 2,2)))))),2),(((lattice[indicesC4 + S,7:9] - lattice[indicesC4,7:9])) / (sqrt(sum((lattice[indicesC4 + S,7:9] - lattice[indicesC4,7:9]) ** 2,2)))))) ** 2,2))
    
    Dfuncp[indicesC5,:]=Dfuncp[indicesC5,:] + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesC5 + E,7:9] + lattice[indicesC5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC5,:] - vel[indicesC5 + E,:]),(((lattice[indicesC5 + E,7:9] - lattice[indicesC5,7:9])) / (sqrt(sum((lattice[indicesC5 + E,7:9] - lattice[indicesC5,7:9]) ** 2,2)))))),2),(((lattice[indicesC5 + E,7:9] - lattice[indicesC5,7:9])) / (sqrt(sum((lattice[indicesC5 + E,7:9] - lattice[indicesC5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesC5 + G,7:9] + lattice[indicesC5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC5,:] - vel[indicesC5 + G,:]),(((lattice[indicesC5 + G,7:9] - lattice[indicesC5,7:9])) / (sqrt(sum((lattice[indicesC5 + G,7:9] - lattice[indicesC5,7:9]) ** 2,2)))))),2),(((lattice[indicesC5 + G,7:9] - lattice[indicesC5,7:9])) / (sqrt(sum((lattice[indicesC5 + G,7:9] - lattice[indicesC5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesC5 + H,7:9] + lattice[indicesC5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC5,:] - vel[indicesC5 + H,:]),(((lattice[indicesC5 + H,7:9] - lattice[indicesC5,7:9])) / (sqrt(sum((lattice[indicesC5 + H,7:9] - lattice[indicesC5,7:9]) ** 2,2)))))),2),(((lattice[indicesC5 + H,7:9] - lattice[indicesC5,7:9])) / (sqrt(sum((lattice[indicesC5 + H,7:9] - lattice[indicesC5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesC5 + N,7:9] + lattice[indicesC5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC5,:] - vel[indicesC5 + N,:]),(((lattice[indicesC5 + N,7:9] - lattice[indicesC5,7:9])) / (sqrt(sum((lattice[indicesC5 + N,7:9] - lattice[indicesC5,7:9]) ** 2,2)))))),2),(((lattice[indicesC5 + N,7:9] - lattice[indicesC5,7:9])) / (sqrt(sum((lattice[indicesC5 + N,7:9] - lattice[indicesC5,7:9]) ** 2,2)))))) ** 2,2))
    
    Dfuncp[indicesC6,:]=Dfuncp[indicesC6,:] + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesC6 + D,7:9] + lattice[indicesC6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC6,:] - vel[indicesC6 + D,:]),(((lattice[indicesC6 + D,7:9] - lattice[indicesC6,7:9])) / (sqrt(sum((lattice[indicesC6 + D,7:9] - lattice[indicesC6,7:9]) ** 2,2)))))),2),(((lattice[indicesC6 + D,7:9] - lattice[indicesC6,7:9])) / (sqrt(sum((lattice[indicesC6 + D,7:9] - lattice[indicesC6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesC6 + F,7:9] + lattice[indicesC6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC6,:] - vel[indicesC6 + F,:]),(((lattice[indicesC6 + F,7:9] - lattice[indicesC6,7:9])) / (sqrt(sum((lattice[indicesC6 + F,7:9] - lattice[indicesC6,7:9]) ** 2,2)))))),2),(((lattice[indicesC6 + F,7:9] - lattice[indicesC6,7:9])) / (sqrt(sum((lattice[indicesC6 + F,7:9] - lattice[indicesC6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesC6 + G,7:9] + lattice[indicesC6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC6,:] - vel[indicesC6 + G,:]),(((lattice[indicesC6 + G,7:9] - lattice[indicesC6,7:9])) / (sqrt(sum((lattice[indicesC6 + G,7:9] - lattice[indicesC6,7:9]) ** 2,2)))))),2),(((lattice[indicesC6 + G,7:9] - lattice[indicesC6,7:9])) / (sqrt(sum((lattice[indicesC6 + G,7:9] - lattice[indicesC6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesC6 + M,7:9] + lattice[indicesC6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC6,:] - vel[indicesC6 + M,:]),(((lattice[indicesC6 + M,7:9] - lattice[indicesC6,7:9])) / (sqrt(sum((lattice[indicesC6 + M,7:9] - lattice[indicesC6,7:9]) ** 2,2)))))),2),(((lattice[indicesC6 + M,7:9] - lattice[indicesC6,7:9])) / (sqrt(sum((lattice[indicesC6 + M,7:9] - lattice[indicesC6,7:9]) ** 2,2)))))) ** 2,2))
    
    Dfuncp[indicesC7,:]=Dfuncp[indicesC7,:] + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesC7 + A,7:9] + lattice[indicesC7,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC7,:] - vel[indicesC7 + A,:]),(((lattice[indicesC7 + A,7:9] - lattice[indicesC7,7:9])) / (sqrt(sum((lattice[indicesC7 + A,7:9] - lattice[indicesC7,7:9]) ** 2,2)))))),2),(((lattice[indicesC7 + A,7:9] - lattice[indicesC7,7:9])) / (sqrt(sum((lattice[indicesC7 + A,7:9] - lattice[indicesC7,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesC7 + B,7:9] + lattice[indicesC7,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC7,:] - vel[indicesC7 + B,:]),(((lattice[indicesC7 + B,7:9] - lattice[indicesC7,7:9])) / (sqrt(sum((lattice[indicesC7 + B,7:9] - lattice[indicesC7,7:9]) ** 2,2)))))),2),(((lattice[indicesC7 + B,7:9] - lattice[indicesC7,7:9])) / (sqrt(sum((lattice[indicesC7 + B,7:9] - lattice[indicesC7,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesC7 + D,7:9] + lattice[indicesC7,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC7,:] - vel[indicesC7 + D,:]),(((lattice[indicesC7 + D,7:9] - lattice[indicesC7,7:9])) / (sqrt(sum((lattice[indicesC7 + D,7:9] - lattice[indicesC7,7:9]) ** 2,2)))))),2),(((lattice[indicesC7 + D,7:9] - lattice[indicesC7,7:9])) / (sqrt(sum((lattice[indicesC7 + D,7:9] - lattice[indicesC7,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesC7 + I,7:9] + lattice[indicesC7,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC7,:] - vel[indicesC7 + I,:]),(((lattice[indicesC7 + I,7:9] - lattice[indicesC7,7:9])) / (sqrt(sum((lattice[indicesC7 + I,7:9] - lattice[indicesC7,7:9]) ** 2,2)))))),2),(((lattice[indicesC7 + I,7:9] - lattice[indicesC7,7:9])) / (sqrt(sum((lattice[indicesC7 + I,7:9] - lattice[indicesC7,7:9]) ** 2,2)))))) ** 2,2))
    
    Dfuncp[indicesC8,:]=Dfuncp[indicesC8,:] + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesC8 + B,7:9] + lattice[indicesC8,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC8,:] - vel[indicesC8 + B,:]),(((lattice[indicesC8 + B,7:9] - lattice[indicesC8,7:9])) / (sqrt(sum((lattice[indicesC8 + B,7:9] - lattice[indicesC8,7:9]) ** 2,2)))))),2),(((lattice[indicesC8 + B,7:9] - lattice[indicesC8,7:9])) / (sqrt(sum((lattice[indicesC8 + B,7:9] - lattice[indicesC8,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesC8 + C,7:9] + lattice[indicesC8,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC8,:] - vel[indicesC8 + C,:]),(((lattice[indicesC8 + C,7:9] - lattice[indicesC8,7:9])) / (sqrt(sum((lattice[indicesC8 + C,7:9] - lattice[indicesC8,7:9]) ** 2,2)))))),2),(((lattice[indicesC8 + C,7:9] - lattice[indicesC8,7:9])) / (sqrt(sum((lattice[indicesC8 + C,7:9] - lattice[indicesC8,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesC8 + E,7:9] + lattice[indicesC8,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC8,:] - vel[indicesC8 + E,:]),(((lattice[indicesC8 + E,7:9] - lattice[indicesC8,7:9])) / (sqrt(sum((lattice[indicesC8 + E,7:9] - lattice[indicesC8,7:9]) ** 2,2)))))),2),(((lattice[indicesC8 + E,7:9] - lattice[indicesC8,7:9])) / (sqrt(sum((lattice[indicesC8 + E,7:9] - lattice[indicesC8,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dshhandle[multiply(0.5,(lattice[indicesC8 + L,7:9] + lattice[indicesC8,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC8,:] - vel[indicesC8 + L,:]),(((lattice[indicesC8 + L,7:9] - lattice[indicesC8,7:9])) / (sqrt(sum((lattice[indicesC8 + L,7:9] - lattice[indicesC8,7:9]) ** 2,2)))))),2),(((lattice[indicesC8 + L,7:9] - lattice[indicesC8,7:9])) / (sqrt(sum((lattice[indicesC8 + L,7:9] - lattice[indicesC8,7:9]) ** 2,2)))))) ** 2,2))
    
    ##
    
    # ---> bend springs
    
    Dfuncp[indicesinternalbulk,:]=Dfuncp[indicesinternalbulk,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalbulk + 2,7:9] + lattice[indicesinternalbulk,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalbulk,:] - vel[indicesinternalbulk + 2,:]),(((lattice[indicesinternalbulk + 2,7:9] - lattice[indicesinternalbulk,7:9])) / (sqrt(sum((lattice[indicesinternalbulk + 2,7:9] - lattice[indicesinternalbulk,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalbulk + 2,7:9] - lattice[indicesinternalbulk,7:9])) / (sqrt(sum((lattice[indicesinternalbulk + 2,7:9] - lattice[indicesinternalbulk,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalbulk - 2,7:9] + lattice[indicesinternalbulk,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalbulk,:] - vel[indicesinternalbulk - 2,:]),(((lattice[indicesinternalbulk - 2,7:9] - lattice[indicesinternalbulk,7:9])) / (sqrt(sum((lattice[indicesinternalbulk - 2,7:9] - lattice[indicesinternalbulk,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalbulk - 2,7:9] - lattice[indicesinternalbulk,7:9])) / (sqrt(sum((lattice[indicesinternalbulk - 2,7:9] - lattice[indicesinternalbulk,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalbulk + dot(2,Nx),7:9] + lattice[indicesinternalbulk,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalbulk,:] - vel[indicesinternalbulk + dot(2,Nx),:]),(((lattice[indicesinternalbulk + dot(2,Nx),7:9] - lattice[indicesinternalbulk,7:9])) / (sqrt(sum((lattice[indicesinternalbulk + dot(2,Nx),7:9] - lattice[indicesinternalbulk,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalbulk + dot(2,Nx),7:9] - lattice[indicesinternalbulk,7:9])) / (sqrt(sum((lattice[indicesinternalbulk + dot(2,Nx),7:9] - lattice[indicesinternalbulk,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalbulk - dot(2,Nx),7:9] + lattice[indicesinternalbulk,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalbulk,:] - vel[indicesinternalbulk - dot(2,Nx),:]),(((lattice[indicesinternalbulk - dot(2,Nx),7:9] - lattice[indicesinternalbulk,7:9])) / (sqrt(sum((lattice[indicesinternalbulk - dot(2,Nx),7:9] - lattice[indicesinternalbulk,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalbulk - dot(2,Nx),7:9] - lattice[indicesinternalbulk,7:9])) / (sqrt(sum((lattice[indicesinternalbulk - dot(2,Nx),7:9] - lattice[indicesinternalbulk,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalbulk + dot(dot(2,Nx),Ny),7:9] + lattice[indicesinternalbulk,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalbulk,:] - vel[indicesinternalbulk + dot(dot(2,Nx),Ny),:]),(((lattice[indicesinternalbulk + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalbulk,7:9])) / (sqrt(sum((lattice[indicesinternalbulk + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalbulk,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalbulk + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalbulk,7:9])) / (sqrt(sum((lattice[indicesinternalbulk + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalbulk,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalbulk - dot(dot(2,Nx),Ny),7:9] + lattice[indicesinternalbulk,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalbulk,:] - vel[indicesinternalbulk - dot(dot(2,Nx),Ny),:]),(((lattice[indicesinternalbulk - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalbulk,7:9])) / (sqrt(sum((lattice[indicesinternalbulk - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalbulk,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalbulk - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalbulk,7:9])) / (sqrt(sum((lattice[indicesinternalbulk - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalbulk,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesF1,:]=Dfuncp[indicesF1,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesF1 + 2,7:9] + lattice[indicesF1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF1,:] - vel[indicesF1 + 2,:]),(((lattice[indicesF1 + 2,7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 + 2,7:9] - lattice[indicesF1,7:9]) ** 2,2)))))),2),(((lattice[indicesF1 + 2,7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 + 2,7:9] - lattice[indicesF1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesF1 - 2,7:9] + lattice[indicesF1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF1,:] - vel[indicesF1 - 2,:]),(((lattice[indicesF1 - 2,7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 - 2,7:9] - lattice[indicesF1,7:9]) ** 2,2)))))),2),(((lattice[indicesF1 - 2,7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 - 2,7:9] - lattice[indicesF1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesF1 + dot(2,Nx),7:9] + lattice[indicesF1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF1,:] - vel[indicesF1 + dot(2,Nx),:]),(((lattice[indicesF1 + dot(2,Nx),7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 + dot(2,Nx),7:9] - lattice[indicesF1,7:9]) ** 2,2)))))),2),(((lattice[indicesF1 + dot(2,Nx),7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 + dot(2,Nx),7:9] - lattice[indicesF1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesF1 - dot(2,Nx),7:9] + lattice[indicesF1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF1,:] - vel[indicesF1 - dot(2,Nx),:]),(((lattice[indicesF1 - dot(2,Nx),7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 - dot(2,Nx),7:9] - lattice[indicesF1,7:9]) ** 2,2)))))),2),(((lattice[indicesF1 - dot(2,Nx),7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 - dot(2,Nx),7:9] - lattice[indicesF1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesF1 + dot(dot(2,Nx),Ny),7:9] + lattice[indicesF1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF1,:] - vel[indicesF1 + dot(dot(2,Nx),Ny),:]),(((lattice[indicesF1 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesF1,7:9]) ** 2,2)))))),2),(((lattice[indicesF1 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesF1,7:9])) / (sqrt(sum((lattice[indicesF1 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesF1,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesF2,:]=Dfuncp[indicesF2,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesF2 + 2,7:9] + lattice[indicesF2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF2,:] - vel[indicesF2 + 2,:]),(((lattice[indicesF2 + 2,7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 + 2,7:9] - lattice[indicesF2,7:9]) ** 2,2)))))),2),(((lattice[indicesF2 + 2,7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 + 2,7:9] - lattice[indicesF2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesF2 - 2,7:9] + lattice[indicesF2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF2,:] - vel[indicesF2 - 2,:]),(((lattice[indicesF2 - 2,7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 - 2,7:9] - lattice[indicesF2,7:9]) ** 2,2)))))),2),(((lattice[indicesF2 - 2,7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 - 2,7:9] - lattice[indicesF2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesF2 + dot(2,Nx),7:9] + lattice[indicesF2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF2,:] - vel[indicesF2 + dot(2,Nx),:]),(((lattice[indicesF2 + dot(2,Nx),7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 + dot(2,Nx),7:9] - lattice[indicesF2,7:9]) ** 2,2)))))),2),(((lattice[indicesF2 + dot(2,Nx),7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 + dot(2,Nx),7:9] - lattice[indicesF2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesF2 + dot(dot(2,Nx),Ny),7:9] + lattice[indicesF2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF2,:] - vel[indicesF2 + dot(dot(2,Nx),Ny),:]),(((lattice[indicesF2 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesF2,7:9]) ** 2,2)))))),2),(((lattice[indicesF2 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesF2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesF2 - dot(dot(2,Nx),Ny),7:9] + lattice[indicesF2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF2,:] - vel[indicesF2 - dot(dot(2,Nx),Ny),:]),(((lattice[indicesF2 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesF2,7:9]) ** 2,2)))))),2),(((lattice[indicesF2 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesF2,7:9])) / (sqrt(sum((lattice[indicesF2 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesF2,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesF3,:]=Dfuncp[indicesF3,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesF3 - 2,7:9] + lattice[indicesF3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF3,:] - vel[indicesF3 - 2,:]),(((lattice[indicesF3 - 2,7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 - 2,7:9] - lattice[indicesF3,7:9]) ** 2,2)))))),2),(((lattice[indicesF3 - 2,7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 - 2,7:9] - lattice[indicesF3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesF3 + dot(2,Nx),7:9] + lattice[indicesF3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF3,:] - vel[indicesF3 + dot(2,Nx),:]),(((lattice[indicesF3 + dot(2,Nx),7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 + dot(2,Nx),7:9] - lattice[indicesF3,7:9]) ** 2,2)))))),2),(((lattice[indicesF3 + dot(2,Nx),7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 + dot(2,Nx),7:9] - lattice[indicesF3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesF3 - dot(2,Nx),7:9] + lattice[indicesF3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF3,:] - vel[indicesF3 - dot(2,Nx),:]),(((lattice[indicesF3 - dot(2,Nx),7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 - dot(2,Nx),7:9] - lattice[indicesF3,7:9]) ** 2,2)))))),2),(((lattice[indicesF3 - dot(2,Nx),7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 - dot(2,Nx),7:9] - lattice[indicesF3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesF3 + dot(dot(2,Nx),Ny),7:9] + lattice[indicesF3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF3,:] - vel[indicesF3 + dot(dot(2,Nx),Ny),:]),(((lattice[indicesF3 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesF3,7:9]) ** 2,2)))))),2),(((lattice[indicesF3 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesF3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesF3 - dot(dot(2,Nx),Ny),7:9] + lattice[indicesF3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF3,:] - vel[indicesF3 - dot(dot(2,Nx),Ny),:]),(((lattice[indicesF3 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesF3,7:9]) ** 2,2)))))),2),(((lattice[indicesF3 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesF3,7:9])) / (sqrt(sum((lattice[indicesF3 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesF3,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesF4,:]=Dfuncp[indicesF4,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesF4 + 2,7:9] + lattice[indicesF4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF4,:] - vel[indicesF4 + 2,:]),(((lattice[indicesF4 + 2,7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 + 2,7:9] - lattice[indicesF4,7:9]) ** 2,2)))))),2),(((lattice[indicesF4 + 2,7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 + 2,7:9] - lattice[indicesF4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesF4 - 2,7:9] + lattice[indicesF4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF4,:] - vel[indicesF4 - 2,:]),(((lattice[indicesF4 - 2,7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 - 2,7:9] - lattice[indicesF4,7:9]) ** 2,2)))))),2),(((lattice[indicesF4 - 2,7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 - 2,7:9] - lattice[indicesF4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesF4 - dot(2,Nx),7:9] + lattice[indicesF4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF4,:] - vel[indicesF4 - dot(2,Nx),:]),(((lattice[indicesF4 - dot(2,Nx),7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 - dot(2,Nx),7:9] - lattice[indicesF4,7:9]) ** 2,2)))))),2),(((lattice[indicesF4 - dot(2,Nx),7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 - dot(2,Nx),7:9] - lattice[indicesF4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesF4 + dot(dot(2,Nx),Ny),7:9] + lattice[indicesF4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF4,:] - vel[indicesF4 + dot(dot(2,Nx),Ny),:]),(((lattice[indicesF4 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesF4,7:9]) ** 2,2)))))),2),(((lattice[indicesF4 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesF4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesF4 - dot(dot(2,Nx),Ny),7:9] + lattice[indicesF4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF4,:] - vel[indicesF4 - dot(dot(2,Nx),Ny),:]),(((lattice[indicesF4 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesF4,7:9]) ** 2,2)))))),2),(((lattice[indicesF4 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesF4,7:9])) / (sqrt(sum((lattice[indicesF4 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesF4,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesF5,:]=Dfuncp[indicesF5,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesF5 + 2,7:9] + lattice[indicesF5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF5,:] - vel[indicesF5 + 2,:]),(((lattice[indicesF5 + 2,7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 + 2,7:9] - lattice[indicesF5,7:9]) ** 2,2)))))),2),(((lattice[indicesF5 + 2,7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 + 2,7:9] - lattice[indicesF5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesF5 + dot(2,Nx),7:9] + lattice[indicesF5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF5,:] - vel[indicesF5 + dot(2,Nx),:]),(((lattice[indicesF5 + dot(2,Nx),7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 + dot(2,Nx),7:9] - lattice[indicesF5,7:9]) ** 2,2)))))),2),(((lattice[indicesF5 + dot(2,Nx),7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 + dot(2,Nx),7:9] - lattice[indicesF5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesF5 - dot(2,Nx),7:9] + lattice[indicesF5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF5,:] - vel[indicesF5 - dot(2,Nx),:]),(((lattice[indicesF5 - dot(2,Nx),7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 - dot(2,Nx),7:9] - lattice[indicesF5,7:9]) ** 2,2)))))),2),(((lattice[indicesF5 - dot(2,Nx),7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 - dot(2,Nx),7:9] - lattice[indicesF5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesF5 + dot(dot(2,Nx),Ny),7:9] + lattice[indicesF5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF5,:] - vel[indicesF5 + dot(dot(2,Nx),Ny),:]),(((lattice[indicesF5 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesF5,7:9]) ** 2,2)))))),2),(((lattice[indicesF5 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesF5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesF5 - dot(dot(2,Nx),Ny),7:9] + lattice[indicesF5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF5,:] - vel[indicesF5 - dot(dot(2,Nx),Ny),:]),(((lattice[indicesF5 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesF5,7:9]) ** 2,2)))))),2),(((lattice[indicesF5 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesF5,7:9])) / (sqrt(sum((lattice[indicesF5 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesF5,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesF6,:]=Dfuncp[indicesF6,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesF6 + 2,7:9] + lattice[indicesF6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF6,:] - vel[indicesF6 + 2,:]),(((lattice[indicesF6 + 2,7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 + 2,7:9] - lattice[indicesF6,7:9]) ** 2,2)))))),2),(((lattice[indicesF6 + 2,7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 + 2,7:9] - lattice[indicesF6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesF6 - 2,7:9] + lattice[indicesF6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF6,:] - vel[indicesF6 - 2,:]),(((lattice[indicesF6 - 2,7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 - 2,7:9] - lattice[indicesF6,7:9]) ** 2,2)))))),2),(((lattice[indicesF6 - 2,7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 - 2,7:9] - lattice[indicesF6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesF6 + dot(2,Nx),7:9] + lattice[indicesF6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF6,:] - vel[indicesF6 + dot(2,Nx),:]),(((lattice[indicesF6 + dot(2,Nx),7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 + dot(2,Nx),7:9] - lattice[indicesF6,7:9]) ** 2,2)))))),2),(((lattice[indicesF6 + dot(2,Nx),7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 + dot(2,Nx),7:9] - lattice[indicesF6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesF6 - dot(2,Nx),7:9] + lattice[indicesF6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF6,:] - vel[indicesF6 - dot(2,Nx),:]),(((lattice[indicesF6 - dot(2,Nx),7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 - dot(2,Nx),7:9] - lattice[indicesF6,7:9]) ** 2,2)))))),2),(((lattice[indicesF6 - dot(2,Nx),7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 - dot(2,Nx),7:9] - lattice[indicesF6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesF6 - dot(dot(2,Nx),Ny),7:9] + lattice[indicesF6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesF6,:] - vel[indicesF6 - dot(dot(2,Nx),Ny),:]),(((lattice[indicesF6 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesF6,7:9]) ** 2,2)))))),2),(((lattice[indicesF6 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesF6,7:9])) / (sqrt(sum((lattice[indicesF6 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesF6,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesE1,:]=Dfuncp[indicesE1,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE1 + 2,7:9] + lattice[indicesE1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE1,:] - vel[indicesE1 + 2,:]),(((lattice[indicesE1 + 2,7:9] - lattice[indicesE1,7:9])) / (sqrt(sum((lattice[indicesE1 + 2,7:9] - lattice[indicesE1,7:9]) ** 2,2)))))),2),(((lattice[indicesE1 + 2,7:9] - lattice[indicesE1,7:9])) / (sqrt(sum((lattice[indicesE1 + 2,7:9] - lattice[indicesE1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE1 - 2,7:9] + lattice[indicesE1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE1,:] - vel[indicesE1 - 2,:]),(((lattice[indicesE1 - 2,7:9] - lattice[indicesE1,7:9])) / (sqrt(sum((lattice[indicesE1 - 2,7:9] - lattice[indicesE1,7:9]) ** 2,2)))))),2),(((lattice[indicesE1 - 2,7:9] - lattice[indicesE1,7:9])) / (sqrt(sum((lattice[indicesE1 - 2,7:9] - lattice[indicesE1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE1 + dot(2,Nx),7:9] + lattice[indicesE1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE1,:] - vel[indicesE1 + dot(2,Nx),:]),(((lattice[indicesE1 + dot(2,Nx),7:9] - lattice[indicesE1,7:9])) / (sqrt(sum((lattice[indicesE1 + dot(2,Nx),7:9] - lattice[indicesE1,7:9]) ** 2,2)))))),2),(((lattice[indicesE1 + dot(2,Nx),7:9] - lattice[indicesE1,7:9])) / (sqrt(sum((lattice[indicesE1 + dot(2,Nx),7:9] - lattice[indicesE1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE1 + dot(dot(2,Nx),Ny),7:9] + lattice[indicesE1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE1,:] - vel[indicesE1 + dot(dot(2,Nx),Ny),:]),(((lattice[indicesE1 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesE1,7:9])) / (sqrt(sum((lattice[indicesE1 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesE1,7:9]) ** 2,2)))))),2),(((lattice[indicesE1 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesE1,7:9])) / (sqrt(sum((lattice[indicesE1 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesE1,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesE2,:]=Dfuncp[indicesE2,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE2 - 2,7:9] + lattice[indicesE2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE2,:] - vel[indicesE2 - 2,:]),(((lattice[indicesE2 - 2,7:9] - lattice[indicesE2,7:9])) / (sqrt(sum((lattice[indicesE2 - 2,7:9] - lattice[indicesE2,7:9]) ** 2,2)))))),2),(((lattice[indicesE2 - 2,7:9] - lattice[indicesE2,7:9])) / (sqrt(sum((lattice[indicesE2 - 2,7:9] - lattice[indicesE2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE2 + dot(2,Nx),7:9] + lattice[indicesE2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE2,:] - vel[indicesE2 + dot(2,Nx),:]),(((lattice[indicesE2 + dot(2,Nx),7:9] - lattice[indicesE2,7:9])) / (sqrt(sum((lattice[indicesE2 + dot(2,Nx),7:9] - lattice[indicesE2,7:9]) ** 2,2)))))),2),(((lattice[indicesE2 + dot(2,Nx),7:9] - lattice[indicesE2,7:9])) / (sqrt(sum((lattice[indicesE2 + dot(2,Nx),7:9] - lattice[indicesE2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE2 - dot(2,Nx),7:9] + lattice[indicesE2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE2,:] - vel[indicesE2 - dot(2,Nx),:]),(((lattice[indicesE2 - dot(2,Nx),7:9] - lattice[indicesE2,7:9])) / (sqrt(sum((lattice[indicesE2 - dot(2,Nx),7:9] - lattice[indicesE2,7:9]) ** 2,2)))))),2),(((lattice[indicesE2 - dot(2,Nx),7:9] - lattice[indicesE2,7:9])) / (sqrt(sum((lattice[indicesE2 - dot(2,Nx),7:9] - lattice[indicesE2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE2 + dot(dot(2,Nx),Ny),7:9] + lattice[indicesE2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE2,:] - vel[indicesE2 + dot(dot(2,Nx),Ny),:]),(((lattice[indicesE2 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesE2,7:9])) / (sqrt(sum((lattice[indicesE2 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesE2,7:9]) ** 2,2)))))),2),(((lattice[indicesE2 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesE2,7:9])) / (sqrt(sum((lattice[indicesE2 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesE2,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesE3,:]=Dfuncp[indicesE3,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE3 + 2,7:9] + lattice[indicesE3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE3,:] - vel[indicesE3 + 2,:]),(((lattice[indicesE3 + 2,7:9] - lattice[indicesE3,7:9])) / (sqrt(sum((lattice[indicesE3 + 2,7:9] - lattice[indicesE3,7:9]) ** 2,2)))))),2),(((lattice[indicesE3 + 2,7:9] - lattice[indicesE3,7:9])) / (sqrt(sum((lattice[indicesE3 + 2,7:9] - lattice[indicesE3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE3 - 2,7:9] + lattice[indicesE3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE3,:] - vel[indicesE3 - 2,:]),(((lattice[indicesE3 - 2,7:9] - lattice[indicesE3,7:9])) / (sqrt(sum((lattice[indicesE3 - 2,7:9] - lattice[indicesE3,7:9]) ** 2,2)))))),2),(((lattice[indicesE3 - 2,7:9] - lattice[indicesE3,7:9])) / (sqrt(sum((lattice[indicesE3 - 2,7:9] - lattice[indicesE3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE3 - dot(2,Nx),7:9] + lattice[indicesE3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE3,:] - vel[indicesE3 - dot(2,Nx),:]),(((lattice[indicesE3 - dot(2,Nx),7:9] - lattice[indicesE3,7:9])) / (sqrt(sum((lattice[indicesE3 - dot(2,Nx),7:9] - lattice[indicesE3,7:9]) ** 2,2)))))),2),(((lattice[indicesE3 - dot(2,Nx),7:9] - lattice[indicesE3,7:9])) / (sqrt(sum((lattice[indicesE3 - dot(2,Nx),7:9] - lattice[indicesE3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE3 + dot(dot(2,Nx),Ny),7:9] + lattice[indicesE3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE3,:] - vel[indicesE3 + dot(dot(2,Nx),Ny),:]),(((lattice[indicesE3 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesE3,7:9])) / (sqrt(sum((lattice[indicesE3 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesE3,7:9]) ** 2,2)))))),2),(((lattice[indicesE3 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesE3,7:9])) / (sqrt(sum((lattice[indicesE3 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesE3,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesE4,:]=Dfuncp[indicesE4,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE4 + 2,7:9] + lattice[indicesE4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE4,:] - vel[indicesE4 + 2,:]),(((lattice[indicesE4 + 2,7:9] - lattice[indicesE4,7:9])) / (sqrt(sum((lattice[indicesE4 + 2,7:9] - lattice[indicesE4,7:9]) ** 2,2)))))),2),(((lattice[indicesE4 + 2,7:9] - lattice[indicesE4,7:9])) / (sqrt(sum((lattice[indicesE4 + 2,7:9] - lattice[indicesE4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE4 + dot(2,Nx),7:9] + lattice[indicesE4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE4,:] - vel[indicesE4 + dot(2,Nx),:]),(((lattice[indicesE4 + dot(2,Nx),7:9] - lattice[indicesE4,7:9])) / (sqrt(sum((lattice[indicesE4 + dot(2,Nx),7:9] - lattice[indicesE4,7:9]) ** 2,2)))))),2),(((lattice[indicesE4 + dot(2,Nx),7:9] - lattice[indicesE4,7:9])) / (sqrt(sum((lattice[indicesE4 + dot(2,Nx),7:9] - lattice[indicesE4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE4 - dot(2,Nx),7:9] + lattice[indicesE4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE4,:] - vel[indicesE4 - dot(2,Nx),:]),(((lattice[indicesE4 - dot(2,Nx),7:9] - lattice[indicesE4,7:9])) / (sqrt(sum((lattice[indicesE4 - dot(2,Nx),7:9] - lattice[indicesE4,7:9]) ** 2,2)))))),2),(((lattice[indicesE4 - dot(2,Nx),7:9] - lattice[indicesE4,7:9])) / (sqrt(sum((lattice[indicesE4 - dot(2,Nx),7:9] - lattice[indicesE4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE4 + dot(dot(2,Nx),Ny),7:9] + lattice[indicesE4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE4,:] - vel[indicesE4 + dot(dot(2,Nx),Ny),:]),(((lattice[indicesE4 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesE4,7:9])) / (sqrt(sum((lattice[indicesE4 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesE4,7:9]) ** 2,2)))))),2),(((lattice[indicesE4 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesE4,7:9])) / (sqrt(sum((lattice[indicesE4 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesE4,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesE5,:]=Dfuncp[indicesE5,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE5 + 2,7:9] + lattice[indicesE5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE5,:] - vel[indicesE5 + 2,:]),(((lattice[indicesE5 + 2,7:9] - lattice[indicesE5,7:9])) / (sqrt(sum((lattice[indicesE5 + 2,7:9] - lattice[indicesE5,7:9]) ** 2,2)))))),2),(((lattice[indicesE5 + 2,7:9] - lattice[indicesE5,7:9])) / (sqrt(sum((lattice[indicesE5 + 2,7:9] - lattice[indicesE5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE5 + dot(2,Nx),7:9] + lattice[indicesE5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE5,:] - vel[indicesE5 + dot(2,Nx),:]),(((lattice[indicesE5 + dot(2,Nx),7:9] - lattice[indicesE5,7:9])) / (sqrt(sum((lattice[indicesE5 + dot(2,Nx),7:9] - lattice[indicesE5,7:9]) ** 2,2)))))),2),(((lattice[indicesE5 + dot(2,Nx),7:9] - lattice[indicesE5,7:9])) / (sqrt(sum((lattice[indicesE5 + dot(2,Nx),7:9] - lattice[indicesE5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE5 + dot(dot(2,Nx),Ny),7:9] + lattice[indicesE5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE5,:] - vel[indicesE5 + dot(dot(2,Nx),Ny),:]),(((lattice[indicesE5 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesE5,7:9])) / (sqrt(sum((lattice[indicesE5 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesE5,7:9]) ** 2,2)))))),2),(((lattice[indicesE5 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesE5,7:9])) / (sqrt(sum((lattice[indicesE5 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesE5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE5 - dot(dot(2,Nx),Ny),7:9] + lattice[indicesE5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE5,:] - vel[indicesE5 - dot(dot(2,Nx),Ny),:]),(((lattice[indicesE5 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesE5,7:9])) / (sqrt(sum((lattice[indicesE5 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesE5,7:9]) ** 2,2)))))),2),(((lattice[indicesE5 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesE5,7:9])) / (sqrt(sum((lattice[indicesE5 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesE5,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesE6,:]=Dfuncp[indicesE6,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE6 - 2,7:9] + lattice[indicesE6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE6,:] - vel[indicesE6 - 2,:]),(((lattice[indicesE6 - 2,7:9] - lattice[indicesE6,7:9])) / (sqrt(sum((lattice[indicesE6 - 2,7:9] - lattice[indicesE6,7:9]) ** 2,2)))))),2),(((lattice[indicesE6 - 2,7:9] - lattice[indicesE6,7:9])) / (sqrt(sum((lattice[indicesE6 - 2,7:9] - lattice[indicesE6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE6 + dot(2,Nx),7:9] + lattice[indicesE6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE6,:] - vel[indicesE6 + dot(2,Nx),:]),(((lattice[indicesE6 + dot(2,Nx),7:9] - lattice[indicesE6,7:9])) / (sqrt(sum((lattice[indicesE6 + dot(2,Nx),7:9] - lattice[indicesE6,7:9]) ** 2,2)))))),2),(((lattice[indicesE6 + dot(2,Nx),7:9] - lattice[indicesE6,7:9])) / (sqrt(sum((lattice[indicesE6 + dot(2,Nx),7:9] - lattice[indicesE6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE6 + dot(dot(2,Nx),Ny),7:9] + lattice[indicesE6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE6,:] - vel[indicesE6 + dot(dot(2,Nx),Ny),:]),(((lattice[indicesE6 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesE6,7:9])) / (sqrt(sum((lattice[indicesE6 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesE6,7:9]) ** 2,2)))))),2),(((lattice[indicesE6 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesE6,7:9])) / (sqrt(sum((lattice[indicesE6 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesE6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE6 - dot(dot(2,Nx),Ny),7:9] + lattice[indicesE6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE6,:] - vel[indicesE6 - dot(dot(2,Nx),Ny),:]),(((lattice[indicesE6 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesE6,7:9])) / (sqrt(sum((lattice[indicesE6 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesE6,7:9]) ** 2,2)))))),2),(((lattice[indicesE6 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesE6,7:9])) / (sqrt(sum((lattice[indicesE6 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesE6,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesE7,:]=Dfuncp[indicesE7,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE7 - 2,7:9] + lattice[indicesE7,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE7,:] - vel[indicesE7 - 2,:]),(((lattice[indicesE7 - 2,7:9] - lattice[indicesE7,7:9])) / (sqrt(sum((lattice[indicesE7 - 2,7:9] - lattice[indicesE7,7:9]) ** 2,2)))))),2),(((lattice[indicesE7 - 2,7:9] - lattice[indicesE7,7:9])) / (sqrt(sum((lattice[indicesE7 - 2,7:9] - lattice[indicesE7,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE7 - dot(2,Nx),7:9] + lattice[indicesE7,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE7,:] - vel[indicesE7 - dot(2,Nx),:]),(((lattice[indicesE7 - dot(2,Nx),7:9] - lattice[indicesE7,7:9])) / (sqrt(sum((lattice[indicesE7 - dot(2,Nx),7:9] - lattice[indicesE7,7:9]) ** 2,2)))))),2),(((lattice[indicesE7 - dot(2,Nx),7:9] - lattice[indicesE7,7:9])) / (sqrt(sum((lattice[indicesE7 - dot(2,Nx),7:9] - lattice[indicesE7,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE7 + dot(dot(2,Nx),Ny),7:9] + lattice[indicesE7,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE7,:] - vel[indicesE7 + dot(dot(2,Nx),Ny),:]),(((lattice[indicesE7 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesE7,7:9])) / (sqrt(sum((lattice[indicesE7 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesE7,7:9]) ** 2,2)))))),2),(((lattice[indicesE7 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesE7,7:9])) / (sqrt(sum((lattice[indicesE7 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesE7,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE7 - dot(dot(2,Nx),Ny),7:9] + lattice[indicesE7,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE7,:] - vel[indicesE7 - dot(dot(2,Nx),Ny),:]),(((lattice[indicesE7 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesE7,7:9])) / (sqrt(sum((lattice[indicesE7 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesE7,7:9]) ** 2,2)))))),2),(((lattice[indicesE7 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesE7,7:9])) / (sqrt(sum((lattice[indicesE7 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesE7,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesE8,:]=Dfuncp[indicesE8,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE8 + 2,7:9] + lattice[indicesE8,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE8,:] - vel[indicesE8 + 2,:]),(((lattice[indicesE8 + 2,7:9] - lattice[indicesE8,7:9])) / (sqrt(sum((lattice[indicesE8 + 2,7:9] - lattice[indicesE8,7:9]) ** 2,2)))))),2),(((lattice[indicesE8 + 2,7:9] - lattice[indicesE8,7:9])) / (sqrt(sum((lattice[indicesE8 + 2,7:9] - lattice[indicesE8,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE8 - dot(2,Nx),7:9] + lattice[indicesE8,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE8,:] - vel[indicesE8 - dot(2,Nx),:]),(((lattice[indicesE8 - dot(2,Nx),7:9] - lattice[indicesE8,7:9])) / (sqrt(sum((lattice[indicesE8 - dot(2,Nx),7:9] - lattice[indicesE8,7:9]) ** 2,2)))))),2),(((lattice[indicesE8 - dot(2,Nx),7:9] - lattice[indicesE8,7:9])) / (sqrt(sum((lattice[indicesE8 - dot(2,Nx),7:9] - lattice[indicesE8,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE8 + dot(dot(2,Nx),Ny),7:9] + lattice[indicesE8,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE8,:] - vel[indicesE8 + dot(dot(2,Nx),Ny),:]),(((lattice[indicesE8 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesE8,7:9])) / (sqrt(sum((lattice[indicesE8 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesE8,7:9]) ** 2,2)))))),2),(((lattice[indicesE8 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesE8,7:9])) / (sqrt(sum((lattice[indicesE8 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesE8,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE8 - dot(dot(2,Nx),Ny),7:9] + lattice[indicesE8,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE8,:] - vel[indicesE8 - dot(dot(2,Nx),Ny),:]),(((lattice[indicesE8 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesE8,7:9])) / (sqrt(sum((lattice[indicesE8 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesE8,7:9]) ** 2,2)))))),2),(((lattice[indicesE8 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesE8,7:9])) / (sqrt(sum((lattice[indicesE8 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesE8,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesE9,:]=Dfuncp[indicesE9,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE9 + 2,7:9] + lattice[indicesE9,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE9,:] - vel[indicesE9 + 2,:]),(((lattice[indicesE9 + 2,7:9] - lattice[indicesE9,7:9])) / (sqrt(sum((lattice[indicesE9 + 2,7:9] - lattice[indicesE9,7:9]) ** 2,2)))))),2),(((lattice[indicesE9 + 2,7:9] - lattice[indicesE9,7:9])) / (sqrt(sum((lattice[indicesE9 + 2,7:9] - lattice[indicesE9,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE9 - 2,7:9] + lattice[indicesE9,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE9,:] - vel[indicesE9 - 2,:]),(((lattice[indicesE9 - 2,7:9] - lattice[indicesE9,7:9])) / (sqrt(sum((lattice[indicesE9 - 2,7:9] - lattice[indicesE9,7:9]) ** 2,2)))))),2),(((lattice[indicesE9 - 2,7:9] - lattice[indicesE9,7:9])) / (sqrt(sum((lattice[indicesE9 - 2,7:9] - lattice[indicesE9,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE9 + dot(2,Nx),7:9] + lattice[indicesE9,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE9,:] - vel[indicesE9 + dot(2,Nx),:]),(((lattice[indicesE9 + dot(2,Nx),7:9] - lattice[indicesE9,7:9])) / (sqrt(sum((lattice[indicesE9 + dot(2,Nx),7:9] - lattice[indicesE9,7:9]) ** 2,2)))))),2),(((lattice[indicesE9 + dot(2,Nx),7:9] - lattice[indicesE9,7:9])) / (sqrt(sum((lattice[indicesE9 + dot(2,Nx),7:9] - lattice[indicesE9,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE9 - dot(dot(2,Nx),Ny),7:9] + lattice[indicesE9,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE9,:] - vel[indicesE9 - dot(dot(2,Nx),Ny),:]),(((lattice[indicesE9 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesE9,7:9])) / (sqrt(sum((lattice[indicesE9 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesE9,7:9]) ** 2,2)))))),2),(((lattice[indicesE9 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesE9,7:9])) / (sqrt(sum((lattice[indicesE9 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesE9,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesE10,:]=Dfuncp[indicesE10,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE10 - 2,7:9] + lattice[indicesE10,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE10,:] - vel[indicesE10 - 2,:]),(((lattice[indicesE10 - 2,7:9] - lattice[indicesE10,7:9])) / (sqrt(sum((lattice[indicesE10 - 2,7:9] - lattice[indicesE10,7:9]) ** 2,2)))))),2),(((lattice[indicesE10 - 2,7:9] - lattice[indicesE10,7:9])) / (sqrt(sum((lattice[indicesE10 - 2,7:9] - lattice[indicesE10,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE10 + dot(2,Nx),7:9] + lattice[indicesE10,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE10,:] - vel[indicesE10 + dot(2,Nx),:]),(((lattice[indicesE10 + dot(2,Nx),7:9] - lattice[indicesE10,7:9])) / (sqrt(sum((lattice[indicesE10 + dot(2,Nx),7:9] - lattice[indicesE10,7:9]) ** 2,2)))))),2),(((lattice[indicesE10 + dot(2,Nx),7:9] - lattice[indicesE10,7:9])) / (sqrt(sum((lattice[indicesE10 + dot(2,Nx),7:9] - lattice[indicesE10,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE10 - dot(2,Nx),7:9] + lattice[indicesE10,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE10,:] - vel[indicesE10 - dot(2,Nx),:]),(((lattice[indicesE10 - dot(2,Nx),7:9] - lattice[indicesE10,7:9])) / (sqrt(sum((lattice[indicesE10 - dot(2,Nx),7:9] - lattice[indicesE10,7:9]) ** 2,2)))))),2),(((lattice[indicesE10 - dot(2,Nx),7:9] - lattice[indicesE10,7:9])) / (sqrt(sum((lattice[indicesE10 - dot(2,Nx),7:9] - lattice[indicesE10,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE10 - dot(dot(2,Nx),Ny),7:9] + lattice[indicesE10,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE10,:] - vel[indicesE10 - dot(dot(2,Nx),Ny),:]),(((lattice[indicesE10 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesE10,7:9])) / (sqrt(sum((lattice[indicesE10 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesE10,7:9]) ** 2,2)))))),2),(((lattice[indicesE10 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesE10,7:9])) / (sqrt(sum((lattice[indicesE10 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesE10,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesE11,:]=Dfuncp[indicesE11,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE11 + 2,7:9] + lattice[indicesE11,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE11,:] - vel[indicesE11 + 2,:]),(((lattice[indicesE11 + 2,7:9] - lattice[indicesE11,7:9])) / (sqrt(sum((lattice[indicesE11 + 2,7:9] - lattice[indicesE11,7:9]) ** 2,2)))))),2),(((lattice[indicesE11 + 2,7:9] - lattice[indicesE11,7:9])) / (sqrt(sum((lattice[indicesE11 + 2,7:9] - lattice[indicesE11,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE11 - 2,7:9] + lattice[indicesE11,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE11,:] - vel[indicesE11 - 2,:]),(((lattice[indicesE11 - 2,7:9] - lattice[indicesE11,7:9])) / (sqrt(sum((lattice[indicesE11 - 2,7:9] - lattice[indicesE11,7:9]) ** 2,2)))))),2),(((lattice[indicesE11 - 2,7:9] - lattice[indicesE11,7:9])) / (sqrt(sum((lattice[indicesE11 - 2,7:9] - lattice[indicesE11,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE11 - dot(2,Nx),7:9] + lattice[indicesE11,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE11,:] - vel[indicesE11 - dot(2,Nx),:]),(((lattice[indicesE11 - dot(2,Nx),7:9] - lattice[indicesE11,7:9])) / (sqrt(sum((lattice[indicesE11 - dot(2,Nx),7:9] - lattice[indicesE11,7:9]) ** 2,2)))))),2),(((lattice[indicesE11 - dot(2,Nx),7:9] - lattice[indicesE11,7:9])) / (sqrt(sum((lattice[indicesE11 - dot(2,Nx),7:9] - lattice[indicesE11,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE11 - dot(dot(2,Nx),Ny),7:9] + lattice[indicesE11,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE11,:] - vel[indicesE11 - dot(dot(2,Nx),Ny),:]),(((lattice[indicesE11 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesE11,7:9])) / (sqrt(sum((lattice[indicesE11 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesE11,7:9]) ** 2,2)))))),2),(((lattice[indicesE11 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesE11,7:9])) / (sqrt(sum((lattice[indicesE11 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesE11,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesE12,:]=Dfuncp[indicesE12,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE12 + 2,7:9] + lattice[indicesE12,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE12,:] - vel[indicesE12 + 2,:]),(((lattice[indicesE12 + 2,7:9] - lattice[indicesE12,7:9])) / (sqrt(sum((lattice[indicesE12 + 2,7:9] - lattice[indicesE12,7:9]) ** 2,2)))))),2),(((lattice[indicesE12 + 2,7:9] - lattice[indicesE12,7:9])) / (sqrt(sum((lattice[indicesE12 + 2,7:9] - lattice[indicesE12,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE12 + dot(2,Nx),7:9] + lattice[indicesE12,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE12,:] - vel[indicesE12 + dot(2,Nx),:]),(((lattice[indicesE12 + dot(2,Nx),7:9] - lattice[indicesE12,7:9])) / (sqrt(sum((lattice[indicesE12 + dot(2,Nx),7:9] - lattice[indicesE12,7:9]) ** 2,2)))))),2),(((lattice[indicesE12 + dot(2,Nx),7:9] - lattice[indicesE12,7:9])) / (sqrt(sum((lattice[indicesE12 + dot(2,Nx),7:9] - lattice[indicesE12,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE12 - dot(2,Nx),7:9] + lattice[indicesE12,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE12,:] - vel[indicesE12 - dot(2,Nx),:]),(((lattice[indicesE12 - dot(2,Nx),7:9] - lattice[indicesE12,7:9])) / (sqrt(sum((lattice[indicesE12 - dot(2,Nx),7:9] - lattice[indicesE12,7:9]) ** 2,2)))))),2),(((lattice[indicesE12 - dot(2,Nx),7:9] - lattice[indicesE12,7:9])) / (sqrt(sum((lattice[indicesE12 - dot(2,Nx),7:9] - lattice[indicesE12,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesE12 - dot(dot(2,Nx),Ny),7:9] + lattice[indicesE12,7:9])),t]),sum((multiply(sum((multiply((vel[indicesE12,:] - vel[indicesE12 - dot(dot(2,Nx),Ny),:]),(((lattice[indicesE12 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesE12,7:9])) / (sqrt(sum((lattice[indicesE12 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesE12,7:9]) ** 2,2)))))),2),(((lattice[indicesE12 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesE12,7:9])) / (sqrt(sum((lattice[indicesE12 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesE12,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesC1,:]=Dfuncp[indicesC1,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesC1 + 2,7:9] + lattice[indicesC1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC1,:] - vel[indicesC1 + 2,:]),(((lattice[indicesC1 + 2,7:9] - lattice[indicesC1,7:9])) / (sqrt(sum((lattice[indicesC1 + 2,7:9] - lattice[indicesC1,7:9]) ** 2,2)))))),2),(((lattice[indicesC1 + 2,7:9] - lattice[indicesC1,7:9])) / (sqrt(sum((lattice[indicesC1 + 2,7:9] - lattice[indicesC1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesC1 + dot(2,Nx),7:9] + lattice[indicesC1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC1,:] - vel[indicesC1 + dot(2,Nx),:]),(((lattice[indicesC1 + dot(2,Nx),7:9] - lattice[indicesC1,7:9])) / (sqrt(sum((lattice[indicesC1 + dot(2,Nx),7:9] - lattice[indicesC1,7:9]) ** 2,2)))))),2),(((lattice[indicesC1 + dot(2,Nx),7:9] - lattice[indicesC1,7:9])) / (sqrt(sum((lattice[indicesC1 + dot(2,Nx),7:9] - lattice[indicesC1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesC1 + dot(dot(2,Nx),Ny),7:9] + lattice[indicesC1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC1,:] - vel[indicesC1 + dot(dot(2,Nx),Ny),:]),(((lattice[indicesC1 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesC1,7:9])) / (sqrt(sum((lattice[indicesC1 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesC1,7:9]) ** 2,2)))))),2),(((lattice[indicesC1 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesC1,7:9])) / (sqrt(sum((lattice[indicesC1 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesC1,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesC2,:]=Dfuncp[indicesC2,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesC2 - 2,7:9] + lattice[indicesC2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC2,:] - vel[indicesC2 - 2,:]),(((lattice[indicesC2 - 2,7:9] - lattice[indicesC2,7:9])) / (sqrt(sum((lattice[indicesC2 - 2,7:9] - lattice[indicesC2,7:9]) ** 2,2)))))),2),(((lattice[indicesC2 - 2,7:9] - lattice[indicesC2,7:9])) / (sqrt(sum((lattice[indicesC2 - 2,7:9] - lattice[indicesC2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesC2 + dot(2,Nx),7:9] + lattice[indicesC2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC2,:] - vel[indicesC2 + dot(2,Nx),:]),(((lattice[indicesC2 + dot(2,Nx),7:9] - lattice[indicesC2,7:9])) / (sqrt(sum((lattice[indicesC2 + dot(2,Nx),7:9] - lattice[indicesC2,7:9]) ** 2,2)))))),2),(((lattice[indicesC2 + dot(2,Nx),7:9] - lattice[indicesC2,7:9])) / (sqrt(sum((lattice[indicesC2 + dot(2,Nx),7:9] - lattice[indicesC2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesC2 + dot(dot(2,Nx),Ny),7:9] + lattice[indicesC2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC2,:] - vel[indicesC2 + dot(dot(2,Nx),Ny),:]),(((lattice[indicesC2 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesC2,7:9])) / (sqrt(sum((lattice[indicesC2 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesC2,7:9]) ** 2,2)))))),2),(((lattice[indicesC2 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesC2,7:9])) / (sqrt(sum((lattice[indicesC2 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesC2,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesC3,:]=Dfuncp[indicesC3,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesC3 - 2,7:9] + lattice[indicesC3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC3,:] - vel[indicesC3 - 2,:]),(((lattice[indicesC3 - 2,7:9] - lattice[indicesC3,7:9])) / (sqrt(sum((lattice[indicesC3 - 2,7:9] - lattice[indicesC3,7:9]) ** 2,2)))))),2),(((lattice[indicesC3 - 2,7:9] - lattice[indicesC3,7:9])) / (sqrt(sum((lattice[indicesC3 - 2,7:9] - lattice[indicesC3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesC3 - dot(2,Nx),7:9] + lattice[indicesC3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC3,:] - vel[indicesC3 - dot(2,Nx),:]),(((lattice[indicesC3 - dot(2,Nx),7:9] - lattice[indicesC3,7:9])) / (sqrt(sum((lattice[indicesC3 - dot(2,Nx),7:9] - lattice[indicesC3,7:9]) ** 2,2)))))),2),(((lattice[indicesC3 - dot(2,Nx),7:9] - lattice[indicesC3,7:9])) / (sqrt(sum((lattice[indicesC3 - dot(2,Nx),7:9] - lattice[indicesC3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesC3 + dot(dot(2,Nx),Ny),7:9] + lattice[indicesC3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC3,:] - vel[indicesC3 + dot(dot(2,Nx),Ny),:]),(((lattice[indicesC3 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesC3,7:9])) / (sqrt(sum((lattice[indicesC3 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesC3,7:9]) ** 2,2)))))),2),(((lattice[indicesC3 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesC3,7:9])) / (sqrt(sum((lattice[indicesC3 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesC3,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesC4,:]=Dfuncp[indicesC4,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesC4 + 2,7:9] + lattice[indicesC4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC4,:] - vel[indicesC4 + 2,:]),(((lattice[indicesC4 + 2,7:9] - lattice[indicesC4,7:9])) / (sqrt(sum((lattice[indicesC4 + 2,7:9] - lattice[indicesC4,7:9]) ** 2,2)))))),2),(((lattice[indicesC4 + 2,7:9] - lattice[indicesC4,7:9])) / (sqrt(sum((lattice[indicesC4 + 2,7:9] - lattice[indicesC4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesC4 - dot(2,Nx),7:9] + lattice[indicesC4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC4,:] - vel[indicesC4 - dot(2,Nx),:]),(((lattice[indicesC4 - dot(2,Nx),7:9] - lattice[indicesC4,7:9])) / (sqrt(sum((lattice[indicesC4 - dot(2,Nx),7:9] - lattice[indicesC4,7:9]) ** 2,2)))))),2),(((lattice[indicesC4 - dot(2,Nx),7:9] - lattice[indicesC4,7:9])) / (sqrt(sum((lattice[indicesC4 - dot(2,Nx),7:9] - lattice[indicesC4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesC4 + dot(dot(2,Nx),Ny),7:9] + lattice[indicesC4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC4,:] - vel[indicesC4 + dot(dot(2,Nx),Ny),:]),(((lattice[indicesC4 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesC4,7:9])) / (sqrt(sum((lattice[indicesC4 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesC4,7:9]) ** 2,2)))))),2),(((lattice[indicesC4 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesC4,7:9])) / (sqrt(sum((lattice[indicesC4 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesC4,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesC5,:]=Dfuncp[indicesC5,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesC5 + 2,7:9] + lattice[indicesC5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC5,:] - vel[indicesC5 + 2,:]),(((lattice[indicesC5 + 2,7:9] - lattice[indicesC5,7:9])) / (sqrt(sum((lattice[indicesC5 + 2,7:9] - lattice[indicesC5,7:9]) ** 2,2)))))),2),(((lattice[indicesC5 + 2,7:9] - lattice[indicesC5,7:9])) / (sqrt(sum((lattice[indicesC5 + 2,7:9] - lattice[indicesC5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesC5 + dot(2,Nx),7:9] + lattice[indicesC5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC5,:] - vel[indicesC5 + dot(2,Nx),:]),(((lattice[indicesC5 + dot(2,Nx),7:9] - lattice[indicesC5,7:9])) / (sqrt(sum((lattice[indicesC5 + dot(2,Nx),7:9] - lattice[indicesC5,7:9]) ** 2,2)))))),2),(((lattice[indicesC5 + dot(2,Nx),7:9] - lattice[indicesC5,7:9])) / (sqrt(sum((lattice[indicesC5 + dot(2,Nx),7:9] - lattice[indicesC5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesC5 - dot(dot(2,Nx),Ny),7:9] + lattice[indicesC5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC5,:] - vel[indicesC5 - dot(dot(2,Nx),Ny),:]),(((lattice[indicesC5 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesC5,7:9])) / (sqrt(sum((lattice[indicesC5 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesC5,7:9]) ** 2,2)))))),2),(((lattice[indicesC5 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesC5,7:9])) / (sqrt(sum((lattice[indicesC5 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesC5,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesC6,:]=Dfuncp[indicesC6,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesC6 - 2,7:9] + lattice[indicesC6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC6,:] - vel[indicesC6 - 2,:]),(((lattice[indicesC6 - 2,7:9] - lattice[indicesC6,7:9])) / (sqrt(sum((lattice[indicesC6 - 2,7:9] - lattice[indicesC6,7:9]) ** 2,2)))))),2),(((lattice[indicesC6 - 2,7:9] - lattice[indicesC6,7:9])) / (sqrt(sum((lattice[indicesC6 - 2,7:9] - lattice[indicesC6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesC6 + dot(2,Nx),7:9] + lattice[indicesC6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC6,:] - vel[indicesC6 + dot(2,Nx),:]),(((lattice[indicesC6 + dot(2,Nx),7:9] - lattice[indicesC6,7:9])) / (sqrt(sum((lattice[indicesC6 + dot(2,Nx),7:9] - lattice[indicesC6,7:9]) ** 2,2)))))),2),(((lattice[indicesC6 + dot(2,Nx),7:9] - lattice[indicesC6,7:9])) / (sqrt(sum((lattice[indicesC6 + dot(2,Nx),7:9] - lattice[indicesC6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesC6 - dot(dot(2,Nx),Ny),7:9] + lattice[indicesC6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC6,:] - vel[indicesC6 - dot(dot(2,Nx),Ny),:]),(((lattice[indicesC6 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesC6,7:9])) / (sqrt(sum((lattice[indicesC6 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesC6,7:9]) ** 2,2)))))),2),(((lattice[indicesC6 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesC6,7:9])) / (sqrt(sum((lattice[indicesC6 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesC6,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesC7,:]=Dfuncp[indicesC7,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesC7 - 2,7:9] + lattice[indicesC7,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC7,:] - vel[indicesC7 - 2,:]),(((lattice[indicesC7 - 2,7:9] - lattice[indicesC7,7:9])) / (sqrt(sum((lattice[indicesC7 - 2,7:9] - lattice[indicesC7,7:9]) ** 2,2)))))),2),(((lattice[indicesC7 - 2,7:9] - lattice[indicesC7,7:9])) / (sqrt(sum((lattice[indicesC7 - 2,7:9] - lattice[indicesC7,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesC7 - dot(2,Nx),7:9] + lattice[indicesC7,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC7,:] - vel[indicesC7 - dot(2,Nx),:]),(((lattice[indicesC7 - dot(2,Nx),7:9] - lattice[indicesC7,7:9])) / (sqrt(sum((lattice[indicesC7 - dot(2,Nx),7:9] - lattice[indicesC7,7:9]) ** 2,2)))))),2),(((lattice[indicesC7 - dot(2,Nx),7:9] - lattice[indicesC7,7:9])) / (sqrt(sum((lattice[indicesC7 - dot(2,Nx),7:9] - lattice[indicesC7,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesC7 - dot(dot(2,Nx),Ny),7:9] + lattice[indicesC7,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC7,:] - vel[indicesC7 - dot(dot(2,Nx),Ny),:]),(((lattice[indicesC7 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesC7,7:9])) / (sqrt(sum((lattice[indicesC7 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesC7,7:9]) ** 2,2)))))),2),(((lattice[indicesC7 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesC7,7:9])) / (sqrt(sum((lattice[indicesC7 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesC7,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesC8,:]=Dfuncp[indicesC8,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesC8 + 2,7:9] + lattice[indicesC8,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC8,:] - vel[indicesC8 + 2,:]),(((lattice[indicesC8 + 2,7:9] - lattice[indicesC8,7:9])) / (sqrt(sum((lattice[indicesC8 + 2,7:9] - lattice[indicesC8,7:9]) ** 2,2)))))),2),(((lattice[indicesC8 + 2,7:9] - lattice[indicesC8,7:9])) / (sqrt(sum((lattice[indicesC8 + 2,7:9] - lattice[indicesC8,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesC8 - dot(2,Nx),7:9] + lattice[indicesC8,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC8,:] - vel[indicesC8 - dot(2,Nx),:]),(((lattice[indicesC8 - dot(2,Nx),7:9] - lattice[indicesC8,7:9])) / (sqrt(sum((lattice[indicesC8 - dot(2,Nx),7:9] - lattice[indicesC8,7:9]) ** 2,2)))))),2),(((lattice[indicesC8 - dot(2,Nx),7:9] - lattice[indicesC8,7:9])) / (sqrt(sum((lattice[indicesC8 - dot(2,Nx),7:9] - lattice[indicesC8,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesC8 - dot(dot(2,Nx),Ny),7:9] + lattice[indicesC8,7:9])),t]),sum((multiply(sum((multiply((vel[indicesC8,:] - vel[indicesC8 - dot(dot(2,Nx),Ny),:]),(((lattice[indicesC8 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesC8,7:9])) / (sqrt(sum((lattice[indicesC8 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesC8,7:9]) ** 2,2)))))),2),(((lattice[indicesC8 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesC8,7:9])) / (sqrt(sum((lattice[indicesC8 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesC8,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesinternalF1,:]=Dfuncp[indicesinternalF1,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalF1 + 2,7:9] + lattice[indicesinternalF1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalF1,:] - vel[indicesinternalF1 + 2,:]),(((lattice[indicesinternalF1 + 2,7:9] - lattice[indicesinternalF1,7:9])) / (sqrt(sum((lattice[indicesinternalF1 + 2,7:9] - lattice[indicesinternalF1,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalF1 + 2,7:9] - lattice[indicesinternalF1,7:9])) / (sqrt(sum((lattice[indicesinternalF1 + 2,7:9] - lattice[indicesinternalF1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalF1 - 2,7:9] + lattice[indicesinternalF1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalF1,:] - vel[indicesinternalF1 - 2,:]),(((lattice[indicesinternalF1 - 2,7:9] - lattice[indicesinternalF1,7:9])) / (sqrt(sum((lattice[indicesinternalF1 - 2,7:9] - lattice[indicesinternalF1,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalF1 - 2,7:9] - lattice[indicesinternalF1,7:9])) / (sqrt(sum((lattice[indicesinternalF1 - 2,7:9] - lattice[indicesinternalF1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalF1 + dot(2,Nx),7:9] + lattice[indicesinternalF1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalF1,:] - vel[indicesinternalF1 + dot(2,Nx),:]),(((lattice[indicesinternalF1 + dot(2,Nx),7:9] - lattice[indicesinternalF1,7:9])) / (sqrt(sum((lattice[indicesinternalF1 + dot(2,Nx),7:9] - lattice[indicesinternalF1,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalF1 + dot(2,Nx),7:9] - lattice[indicesinternalF1,7:9])) / (sqrt(sum((lattice[indicesinternalF1 + dot(2,Nx),7:9] - lattice[indicesinternalF1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalF1 - dot(2,Nx),7:9] + lattice[indicesinternalF1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalF1,:] - vel[indicesinternalF1 - dot(2,Nx),:]),(((lattice[indicesinternalF1 - dot(2,Nx),7:9] - lattice[indicesinternalF1,7:9])) / (sqrt(sum((lattice[indicesinternalF1 - dot(2,Nx),7:9] - lattice[indicesinternalF1,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalF1 - dot(2,Nx),7:9] - lattice[indicesinternalF1,7:9])) / (sqrt(sum((lattice[indicesinternalF1 - dot(2,Nx),7:9] - lattice[indicesinternalF1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalF1 + dot(dot(2,Nx),Ny),7:9] + lattice[indicesinternalF1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalF1,:] - vel[indicesinternalF1 + dot(dot(2,Nx),Ny),:]),(((lattice[indicesinternalF1 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalF1,7:9])) / (sqrt(sum((lattice[indicesinternalF1 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalF1,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalF1 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalF1,7:9])) / (sqrt(sum((lattice[indicesinternalF1 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalF1,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesinternalF2,:]=Dfuncp[indicesinternalF2,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalF2 + 2,7:9] + lattice[indicesinternalF2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalF2,:] - vel[indicesinternalF2 + 2,:]),(((lattice[indicesinternalF2 + 2,7:9] - lattice[indicesinternalF2,7:9])) / (sqrt(sum((lattice[indicesinternalF2 + 2,7:9] - lattice[indicesinternalF2,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalF2 + 2,7:9] - lattice[indicesinternalF2,7:9])) / (sqrt(sum((lattice[indicesinternalF2 + 2,7:9] - lattice[indicesinternalF2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalF2 - 2,7:9] + lattice[indicesinternalF2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalF2,:] - vel[indicesinternalF2 - 2,:]),(((lattice[indicesinternalF2 - 2,7:9] - lattice[indicesinternalF2,7:9])) / (sqrt(sum((lattice[indicesinternalF2 - 2,7:9] - lattice[indicesinternalF2,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalF2 - 2,7:9] - lattice[indicesinternalF2,7:9])) / (sqrt(sum((lattice[indicesinternalF2 - 2,7:9] - lattice[indicesinternalF2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalF2 + dot(2,Nx),7:9] + lattice[indicesinternalF2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalF2,:] - vel[indicesinternalF2 + dot(2,Nx),:]),(((lattice[indicesinternalF2 + dot(2,Nx),7:9] - lattice[indicesinternalF2,7:9])) / (sqrt(sum((lattice[indicesinternalF2 + dot(2,Nx),7:9] - lattice[indicesinternalF2,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalF2 + dot(2,Nx),7:9] - lattice[indicesinternalF2,7:9])) / (sqrt(sum((lattice[indicesinternalF2 + dot(2,Nx),7:9] - lattice[indicesinternalF2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalF2 + dot(dot(2,Nx),Ny),7:9] + lattice[indicesinternalF2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalF2,:] - vel[indicesinternalF2 + dot(dot(2,Nx),Ny),:]),(((lattice[indicesinternalF2 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalF2,7:9])) / (sqrt(sum((lattice[indicesinternalF2 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalF2,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalF2 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalF2,7:9])) / (sqrt(sum((lattice[indicesinternalF2 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalF2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalF2 - dot(dot(2,Nx),Ny),7:9] + lattice[indicesinternalF2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalF2,:] - vel[indicesinternalF2 - dot(dot(2,Nx),Ny),:]),(((lattice[indicesinternalF2 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalF2,7:9])) / (sqrt(sum((lattice[indicesinternalF2 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalF2,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalF2 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalF2,7:9])) / (sqrt(sum((lattice[indicesinternalF2 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalF2,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesinternalF3,:]=Dfuncp[indicesinternalF3,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalF3 - 2,7:9] + lattice[indicesinternalF3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalF3,:] - vel[indicesinternalF3 - 2,:]),(((lattice[indicesinternalF3 - 2,7:9] - lattice[indicesinternalF3,7:9])) / (sqrt(sum((lattice[indicesinternalF3 - 2,7:9] - lattice[indicesinternalF3,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalF3 - 2,7:9] - lattice[indicesinternalF3,7:9])) / (sqrt(sum((lattice[indicesinternalF3 - 2,7:9] - lattice[indicesinternalF3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalF3 + dot(2,Nx),7:9] + lattice[indicesinternalF3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalF3,:] - vel[indicesinternalF3 + dot(2,Nx),:]),(((lattice[indicesinternalF3 + dot(2,Nx),7:9] - lattice[indicesinternalF3,7:9])) / (sqrt(sum((lattice[indicesinternalF3 + dot(2,Nx),7:9] - lattice[indicesinternalF3,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalF3 + dot(2,Nx),7:9] - lattice[indicesinternalF3,7:9])) / (sqrt(sum((lattice[indicesinternalF3 + dot(2,Nx),7:9] - lattice[indicesinternalF3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalF3 - dot(2,Nx),7:9] + lattice[indicesinternalF3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalF3,:] - vel[indicesinternalF3 - dot(2,Nx),:]),(((lattice[indicesinternalF3 - dot(2,Nx),7:9] - lattice[indicesinternalF3,7:9])) / (sqrt(sum((lattice[indicesinternalF3 - dot(2,Nx),7:9] - lattice[indicesinternalF3,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalF3 - dot(2,Nx),7:9] - lattice[indicesinternalF3,7:9])) / (sqrt(sum((lattice[indicesinternalF3 - dot(2,Nx),7:9] - lattice[indicesinternalF3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalF3 + dot(dot(2,Nx),Ny),7:9] + lattice[indicesinternalF3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalF3,:] - vel[indicesinternalF3 + dot(dot(2,Nx),Ny),:]),(((lattice[indicesinternalF3 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalF3,7:9])) / (sqrt(sum((lattice[indicesinternalF3 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalF3,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalF3 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalF3,7:9])) / (sqrt(sum((lattice[indicesinternalF3 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalF3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalF3 - dot(dot(2,Nx),Ny),7:9] + lattice[indicesinternalF3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalF3,:] - vel[indicesinternalF3 - dot(dot(2,Nx),Ny),:]),(((lattice[indicesinternalF3 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalF3,7:9])) / (sqrt(sum((lattice[indicesinternalF3 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalF3,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalF3 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalF3,7:9])) / (sqrt(sum((lattice[indicesinternalF3 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalF3,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesinternalF4,:]=Dfuncp[indicesinternalF4,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalF4 + 2,7:9] + lattice[indicesinternalF4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalF4,:] - vel[indicesinternalF4 + 2,:]),(((lattice[indicesinternalF4 + 2,7:9] - lattice[indicesinternalF4,7:9])) / (sqrt(sum((lattice[indicesinternalF4 + 2,7:9] - lattice[indicesinternalF4,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalF4 + 2,7:9] - lattice[indicesinternalF4,7:9])) / (sqrt(sum((lattice[indicesinternalF4 + 2,7:9] - lattice[indicesinternalF4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalF4 - 2,7:9] + lattice[indicesinternalF4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalF4,:] - vel[indicesinternalF4 - 2,:]),(((lattice[indicesinternalF4 - 2,7:9] - lattice[indicesinternalF4,7:9])) / (sqrt(sum((lattice[indicesinternalF4 - 2,7:9] - lattice[indicesinternalF4,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalF4 - 2,7:9] - lattice[indicesinternalF4,7:9])) / (sqrt(sum((lattice[indicesinternalF4 - 2,7:9] - lattice[indicesinternalF4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalF4 - dot(2,Nx),7:9] + lattice[indicesinternalF4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalF4,:] - vel[indicesinternalF4 - dot(2,Nx),:]),(((lattice[indicesinternalF4 - dot(2,Nx),7:9] - lattice[indicesinternalF4,7:9])) / (sqrt(sum((lattice[indicesinternalF4 - dot(2,Nx),7:9] - lattice[indicesinternalF4,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalF4 - dot(2,Nx),7:9] - lattice[indicesinternalF4,7:9])) / (sqrt(sum((lattice[indicesinternalF4 - dot(2,Nx),7:9] - lattice[indicesinternalF4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalF4 + dot(dot(2,Nx),Ny),7:9] + lattice[indicesinternalF4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalF4,:] - vel[indicesinternalF4 + dot(dot(2,Nx),Ny),:]),(((lattice[indicesinternalF4 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalF4,7:9])) / (sqrt(sum((lattice[indicesinternalF4 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalF4,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalF4 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalF4,7:9])) / (sqrt(sum((lattice[indicesinternalF4 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalF4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalF4 - dot(dot(2,Nx),Ny),7:9] + lattice[indicesinternalF4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalF4,:] - vel[indicesinternalF4 - dot(dot(2,Nx),Ny),:]),(((lattice[indicesinternalF4 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalF4,7:9])) / (sqrt(sum((lattice[indicesinternalF4 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalF4,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalF4 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalF4,7:9])) / (sqrt(sum((lattice[indicesinternalF4 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalF4,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesinternalF5,:]=Dfuncp[indicesinternalF5,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalF5 + 2,7:9] + lattice[indicesinternalF5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalF5,:] - vel[indicesinternalF5 + 2,:]),(((lattice[indicesinternalF5 + 2,7:9] - lattice[indicesinternalF5,7:9])) / (sqrt(sum((lattice[indicesinternalF5 + 2,7:9] - lattice[indicesinternalF5,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalF5 + 2,7:9] - lattice[indicesinternalF5,7:9])) / (sqrt(sum((lattice[indicesinternalF5 + 2,7:9] - lattice[indicesinternalF5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalF5 + dot(2,Nx),7:9] + lattice[indicesinternalF5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalF5,:] - vel[indicesinternalF5 + dot(2,Nx),:]),(((lattice[indicesinternalF5 + dot(2,Nx),7:9] - lattice[indicesinternalF5,7:9])) / (sqrt(sum((lattice[indicesinternalF5 + dot(2,Nx),7:9] - lattice[indicesinternalF5,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalF5 + dot(2,Nx),7:9] - lattice[indicesinternalF5,7:9])) / (sqrt(sum((lattice[indicesinternalF5 + dot(2,Nx),7:9] - lattice[indicesinternalF5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalF5 - dot(2,Nx),7:9] + lattice[indicesinternalF5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalF5,:] - vel[indicesinternalF5 - dot(2,Nx),:]),(((lattice[indicesinternalF5 - dot(2,Nx),7:9] - lattice[indicesinternalF5,7:9])) / (sqrt(sum((lattice[indicesinternalF5 - dot(2,Nx),7:9] - lattice[indicesinternalF5,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalF5 - dot(2,Nx),7:9] - lattice[indicesinternalF5,7:9])) / (sqrt(sum((lattice[indicesinternalF5 - dot(2,Nx),7:9] - lattice[indicesinternalF5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalF5 + dot(dot(2,Nx),Ny),7:9] + lattice[indicesinternalF5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalF5,:] - vel[indicesinternalF5 + dot(dot(2,Nx),Ny),:]),(((lattice[indicesinternalF5 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalF5,7:9])) / (sqrt(sum((lattice[indicesinternalF5 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalF5,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalF5 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalF5,7:9])) / (sqrt(sum((lattice[indicesinternalF5 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalF5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalF5 - dot(dot(2,Nx),Ny),7:9] + lattice[indicesinternalF5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalF5,:] - vel[indicesinternalF5 - dot(dot(2,Nx),Ny),:]),(((lattice[indicesinternalF5 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalF5,7:9])) / (sqrt(sum((lattice[indicesinternalF5 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalF5,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalF5 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalF5,7:9])) / (sqrt(sum((lattice[indicesinternalF5 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalF5,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesinternalF6,:]=Dfuncp[indicesinternalF6,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalF6 + 2,7:9] + lattice[indicesinternalF6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalF6,:] - vel[indicesinternalF6 + 2,:]),(((lattice[indicesinternalF6 + 2,7:9] - lattice[indicesinternalF6,7:9])) / (sqrt(sum((lattice[indicesinternalF6 + 2,7:9] - lattice[indicesinternalF6,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalF6 + 2,7:9] - lattice[indicesinternalF6,7:9])) / (sqrt(sum((lattice[indicesinternalF6 + 2,7:9] - lattice[indicesinternalF6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalF6 - 2,7:9] + lattice[indicesinternalF6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalF6,:] - vel[indicesinternalF6 - 2,:]),(((lattice[indicesinternalF6 - 2,7:9] - lattice[indicesinternalF6,7:9])) / (sqrt(sum((lattice[indicesinternalF6 - 2,7:9] - lattice[indicesinternalF6,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalF6 - 2,7:9] - lattice[indicesinternalF6,7:9])) / (sqrt(sum((lattice[indicesinternalF6 - 2,7:9] - lattice[indicesinternalF6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalF6 + dot(2,Nx),7:9] + lattice[indicesinternalF6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalF6,:] - vel[indicesinternalF6 + dot(2,Nx),:]),(((lattice[indicesinternalF6 + dot(2,Nx),7:9] - lattice[indicesinternalF6,7:9])) / (sqrt(sum((lattice[indicesinternalF6 + dot(2,Nx),7:9] - lattice[indicesinternalF6,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalF6 + dot(2,Nx),7:9] - lattice[indicesinternalF6,7:9])) / (sqrt(sum((lattice[indicesinternalF6 + dot(2,Nx),7:9] - lattice[indicesinternalF6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalF6 - dot(2,Nx),7:9] + lattice[indicesinternalF6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalF6,:] - vel[indicesinternalF6 - dot(2,Nx),:]),(((lattice[indicesinternalF6 - dot(2,Nx),7:9] - lattice[indicesinternalF6,7:9])) / (sqrt(sum((lattice[indicesinternalF6 - dot(2,Nx),7:9] - lattice[indicesinternalF6,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalF6 - dot(2,Nx),7:9] - lattice[indicesinternalF6,7:9])) / (sqrt(sum((lattice[indicesinternalF6 - dot(2,Nx),7:9] - lattice[indicesinternalF6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalF6 - dot(dot(2,Nx),Ny),7:9] + lattice[indicesinternalF6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalF6,:] - vel[indicesinternalF6 - dot(dot(2,Nx),Ny),:]),(((lattice[indicesinternalF6 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalF6,7:9])) / (sqrt(sum((lattice[indicesinternalF6 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalF6,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalF6 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalF6,7:9])) / (sqrt(sum((lattice[indicesinternalF6 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalF6,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesinternalE1,:]=Dfuncp[indicesinternalE1,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE1 + 2,7:9] + lattice[indicesinternalE1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE1,:] - vel[indicesinternalE1 + 2,:]),(((lattice[indicesinternalE1 + 2,7:9] - lattice[indicesinternalE1,7:9])) / (sqrt(sum((lattice[indicesinternalE1 + 2,7:9] - lattice[indicesinternalE1,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE1 + 2,7:9] - lattice[indicesinternalE1,7:9])) / (sqrt(sum((lattice[indicesinternalE1 + 2,7:9] - lattice[indicesinternalE1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE1 - 2,7:9] + lattice[indicesinternalE1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE1,:] - vel[indicesinternalE1 - 2,:]),(((lattice[indicesinternalE1 - 2,7:9] - lattice[indicesinternalE1,7:9])) / (sqrt(sum((lattice[indicesinternalE1 - 2,7:9] - lattice[indicesinternalE1,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE1 - 2,7:9] - lattice[indicesinternalE1,7:9])) / (sqrt(sum((lattice[indicesinternalE1 - 2,7:9] - lattice[indicesinternalE1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE1 + dot(2,Nx),7:9] + lattice[indicesinternalE1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE1,:] - vel[indicesinternalE1 + dot(2,Nx),:]),(((lattice[indicesinternalE1 + dot(2,Nx),7:9] - lattice[indicesinternalE1,7:9])) / (sqrt(sum((lattice[indicesinternalE1 + dot(2,Nx),7:9] - lattice[indicesinternalE1,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE1 + dot(2,Nx),7:9] - lattice[indicesinternalE1,7:9])) / (sqrt(sum((lattice[indicesinternalE1 + dot(2,Nx),7:9] - lattice[indicesinternalE1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE1 + dot(dot(2,Nx),Ny),7:9] + lattice[indicesinternalE1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE1,:] - vel[indicesinternalE1 + dot(dot(2,Nx),Ny),:]),(((lattice[indicesinternalE1 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE1,7:9])) / (sqrt(sum((lattice[indicesinternalE1 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE1,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE1 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE1,7:9])) / (sqrt(sum((lattice[indicesinternalE1 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE1,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesinternalE2,:]=Dfuncp[indicesinternalE2,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE2 - 2,7:9] + lattice[indicesinternalE2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE2,:] - vel[indicesinternalE2 - 2,:]),(((lattice[indicesinternalE2 - 2,7:9] - lattice[indicesinternalE2,7:9])) / (sqrt(sum((lattice[indicesinternalE2 - 2,7:9] - lattice[indicesinternalE2,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE2 - 2,7:9] - lattice[indicesinternalE2,7:9])) / (sqrt(sum((lattice[indicesinternalE2 - 2,7:9] - lattice[indicesinternalE2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE2 + dot(2,Nx),7:9] + lattice[indicesinternalE2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE2,:] - vel[indicesinternalE2 + dot(2,Nx),:]),(((lattice[indicesinternalE2 + dot(2,Nx),7:9] - lattice[indicesinternalE2,7:9])) / (sqrt(sum((lattice[indicesinternalE2 + dot(2,Nx),7:9] - lattice[indicesinternalE2,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE2 + dot(2,Nx),7:9] - lattice[indicesinternalE2,7:9])) / (sqrt(sum((lattice[indicesinternalE2 + dot(2,Nx),7:9] - lattice[indicesinternalE2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE2 - dot(2,Nx),7:9] + lattice[indicesinternalE2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE2,:] - vel[indicesinternalE2 - dot(2,Nx),:]),(((lattice[indicesinternalE2 - dot(2,Nx),7:9] - lattice[indicesinternalE2,7:9])) / (sqrt(sum((lattice[indicesinternalE2 - dot(2,Nx),7:9] - lattice[indicesinternalE2,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE2 - dot(2,Nx),7:9] - lattice[indicesinternalE2,7:9])) / (sqrt(sum((lattice[indicesinternalE2 - dot(2,Nx),7:9] - lattice[indicesinternalE2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE2 + dot(dot(2,Nx),Ny),7:9] + lattice[indicesinternalE2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE2,:] - vel[indicesinternalE2 + dot(dot(2,Nx),Ny),:]),(((lattice[indicesinternalE2 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE2,7:9])) / (sqrt(sum((lattice[indicesinternalE2 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE2,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE2 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE2,7:9])) / (sqrt(sum((lattice[indicesinternalE2 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE2,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesinternalE3,:]=Dfuncp[indicesinternalE3,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE3 + 2,7:9] + lattice[indicesinternalE3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE3,:] - vel[indicesinternalE3 + 2,:]),(((lattice[indicesinternalE3 + 2,7:9] - lattice[indicesinternalE3,7:9])) / (sqrt(sum((lattice[indicesinternalE3 + 2,7:9] - lattice[indicesinternalE3,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE3 + 2,7:9] - lattice[indicesinternalE3,7:9])) / (sqrt(sum((lattice[indicesinternalE3 + 2,7:9] - lattice[indicesinternalE3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE3 - 2,7:9] + lattice[indicesinternalE3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE3,:] - vel[indicesinternalE3 - 2,:]),(((lattice[indicesinternalE3 - 2,7:9] - lattice[indicesinternalE3,7:9])) / (sqrt(sum((lattice[indicesinternalE3 - 2,7:9] - lattice[indicesinternalE3,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE3 - 2,7:9] - lattice[indicesinternalE3,7:9])) / (sqrt(sum((lattice[indicesinternalE3 - 2,7:9] - lattice[indicesinternalE3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE3 - dot(2,Nx),7:9] + lattice[indicesinternalE3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE3,:] - vel[indicesinternalE3 - dot(2,Nx),:]),(((lattice[indicesinternalE3 - dot(2,Nx),7:9] - lattice[indicesinternalE3,7:9])) / (sqrt(sum((lattice[indicesinternalE3 - dot(2,Nx),7:9] - lattice[indicesinternalE3,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE3 - dot(2,Nx),7:9] - lattice[indicesinternalE3,7:9])) / (sqrt(sum((lattice[indicesinternalE3 - dot(2,Nx),7:9] - lattice[indicesinternalE3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE3 + dot(dot(2,Nx),Ny),7:9] + lattice[indicesinternalE3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE3,:] - vel[indicesinternalE3 + dot(dot(2,Nx),Ny),:]),(((lattice[indicesinternalE3 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE3,7:9])) / (sqrt(sum((lattice[indicesinternalE3 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE3,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE3 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE3,7:9])) / (sqrt(sum((lattice[indicesinternalE3 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE3,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesinternalE4,:]=Dfuncp[indicesinternalE4,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE4 + 2,7:9] + lattice[indicesinternalE4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE4,:] - vel[indicesinternalE4 + 2,:]),(((lattice[indicesinternalE4 + 2,7:9] - lattice[indicesinternalE4,7:9])) / (sqrt(sum((lattice[indicesinternalE4 + 2,7:9] - lattice[indicesinternalE4,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE4 + 2,7:9] - lattice[indicesinternalE4,7:9])) / (sqrt(sum((lattice[indicesinternalE4 + 2,7:9] - lattice[indicesinternalE4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE4 + dot(2,Nx),7:9] + lattice[indicesinternalE4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE4,:] - vel[indicesinternalE4 + dot(2,Nx),:]),(((lattice[indicesinternalE4 + dot(2,Nx),7:9] - lattice[indicesinternalE4,7:9])) / (sqrt(sum((lattice[indicesinternalE4 + dot(2,Nx),7:9] - lattice[indicesinternalE4,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE4 + dot(2,Nx),7:9] - lattice[indicesinternalE4,7:9])) / (sqrt(sum((lattice[indicesinternalE4 + dot(2,Nx),7:9] - lattice[indicesinternalE4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE4 - dot(2,Nx),7:9] + lattice[indicesinternalE4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE4,:] - vel[indicesinternalE4 - dot(2,Nx),:]),(((lattice[indicesinternalE4 - dot(2,Nx),7:9] - lattice[indicesinternalE4,7:9])) / (sqrt(sum((lattice[indicesinternalE4 - dot(2,Nx),7:9] - lattice[indicesinternalE4,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE4 - dot(2,Nx),7:9] - lattice[indicesinternalE4,7:9])) / (sqrt(sum((lattice[indicesinternalE4 - dot(2,Nx),7:9] - lattice[indicesinternalE4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE4 + dot(dot(2,Nx),Ny),7:9] + lattice[indicesinternalE4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE4,:] - vel[indicesinternalE4 + dot(dot(2,Nx),Ny),:]),(((lattice[indicesinternalE4 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE4,7:9])) / (sqrt(sum((lattice[indicesinternalE4 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE4,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE4 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE4,7:9])) / (sqrt(sum((lattice[indicesinternalE4 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE4,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesinternalE5,:]=Dfuncp[indicesinternalE5,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE5 + 2,7:9] + lattice[indicesinternalE5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE5,:] - vel[indicesinternalE5 + 2,:]),(((lattice[indicesinternalE5 + 2,7:9] - lattice[indicesinternalE5,7:9])) / (sqrt(sum((lattice[indicesinternalE5 + 2,7:9] - lattice[indicesinternalE5,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE5 + 2,7:9] - lattice[indicesinternalE5,7:9])) / (sqrt(sum((lattice[indicesinternalE5 + 2,7:9] - lattice[indicesinternalE5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE5 + dot(2,Nx),7:9] + lattice[indicesinternalE5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE5,:] - vel[indicesinternalE5 + dot(2,Nx),:]),(((lattice[indicesinternalE5 + dot(2,Nx),7:9] - lattice[indicesinternalE5,7:9])) / (sqrt(sum((lattice[indicesinternalE5 + dot(2,Nx),7:9] - lattice[indicesinternalE5,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE5 + dot(2,Nx),7:9] - lattice[indicesinternalE5,7:9])) / (sqrt(sum((lattice[indicesinternalE5 + dot(2,Nx),7:9] - lattice[indicesinternalE5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE5 + dot(dot(2,Nx),Ny),7:9] + lattice[indicesinternalE5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE5,:] - vel[indicesinternalE5 + dot(dot(2,Nx),Ny),:]),(((lattice[indicesinternalE5 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE5,7:9])) / (sqrt(sum((lattice[indicesinternalE5 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE5,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE5 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE5,7:9])) / (sqrt(sum((lattice[indicesinternalE5 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE5 - dot(dot(2,Nx),Ny),7:9] + lattice[indicesinternalE5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE5,:] - vel[indicesinternalE5 - dot(dot(2,Nx),Ny),:]),(((lattice[indicesinternalE5 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE5,7:9])) / (sqrt(sum((lattice[indicesinternalE5 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE5,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE5 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE5,7:9])) / (sqrt(sum((lattice[indicesinternalE5 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE5,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesinternalE6,:]=Dfuncp[indicesinternalE6,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE6 - 2,7:9] + lattice[indicesinternalE6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE6,:] - vel[indicesinternalE6 - 2,:]),(((lattice[indicesinternalE6 - 2,7:9] - lattice[indicesinternalE6,7:9])) / (sqrt(sum((lattice[indicesinternalE6 - 2,7:9] - lattice[indicesinternalE6,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE6 - 2,7:9] - lattice[indicesinternalE6,7:9])) / (sqrt(sum((lattice[indicesinternalE6 - 2,7:9] - lattice[indicesinternalE6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE6 + dot(2,Nx),7:9] + lattice[indicesinternalE6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE6,:] - vel[indicesinternalE6 + dot(2,Nx),:]),(((lattice[indicesinternalE6 + dot(2,Nx),7:9] - lattice[indicesinternalE6,7:9])) / (sqrt(sum((lattice[indicesinternalE6 + dot(2,Nx),7:9] - lattice[indicesinternalE6,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE6 + dot(2,Nx),7:9] - lattice[indicesinternalE6,7:9])) / (sqrt(sum((lattice[indicesinternalE6 + dot(2,Nx),7:9] - lattice[indicesinternalE6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE6 + dot(dot(2,Nx),Ny),7:9] + lattice[indicesinternalE6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE6,:] - vel[indicesinternalE6 + dot(dot(2,Nx),Ny),:]),(((lattice[indicesinternalE6 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE6,7:9])) / (sqrt(sum((lattice[indicesinternalE6 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE6,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE6 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE6,7:9])) / (sqrt(sum((lattice[indicesinternalE6 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE6 - dot(dot(2,Nx),Ny),7:9] + lattice[indicesinternalE6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE6,:] - vel[indicesinternalE6 - dot(dot(2,Nx),Ny),:]),(((lattice[indicesinternalE6 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE6,7:9])) / (sqrt(sum((lattice[indicesinternalE6 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE6,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE6 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE6,7:9])) / (sqrt(sum((lattice[indicesinternalE6 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE6,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesinternalE7,:]=Dfuncp[indicesinternalE7,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE7 - 2,7:9] + lattice[indicesinternalE7,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE7,:] - vel[indicesinternalE7 - 2,:]),(((lattice[indicesinternalE7 - 2,7:9] - lattice[indicesinternalE7,7:9])) / (sqrt(sum((lattice[indicesinternalE7 - 2,7:9] - lattice[indicesinternalE7,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE7 - 2,7:9] - lattice[indicesinternalE7,7:9])) / (sqrt(sum((lattice[indicesinternalE7 - 2,7:9] - lattice[indicesinternalE7,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE7 - dot(2,Nx),7:9] + lattice[indicesinternalE7,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE7,:] - vel[indicesinternalE7 - dot(2,Nx),:]),(((lattice[indicesinternalE7 - dot(2,Nx),7:9] - lattice[indicesinternalE7,7:9])) / (sqrt(sum((lattice[indicesinternalE7 - dot(2,Nx),7:9] - lattice[indicesinternalE7,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE7 - dot(2,Nx),7:9] - lattice[indicesinternalE7,7:9])) / (sqrt(sum((lattice[indicesinternalE7 - dot(2,Nx),7:9] - lattice[indicesinternalE7,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE7 + dot(dot(2,Nx),Ny),7:9] + lattice[indicesinternalE7,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE7,:] - vel[indicesinternalE7 + dot(dot(2,Nx),Ny),:]),(((lattice[indicesinternalE7 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE7,7:9])) / (sqrt(sum((lattice[indicesinternalE7 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE7,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE7 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE7,7:9])) / (sqrt(sum((lattice[indicesinternalE7 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE7,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE7 - dot(dot(2,Nx),Ny),7:9] + lattice[indicesinternalE7,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE7,:] - vel[indicesinternalE7 - dot(dot(2,Nx),Ny),:]),(((lattice[indicesinternalE7 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE7,7:9])) / (sqrt(sum((lattice[indicesinternalE7 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE7,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE7 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE7,7:9])) / (sqrt(sum((lattice[indicesinternalE7 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE7,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesinternalE8,:]=Dfuncp[indicesinternalE8,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE8 + 2,7:9] + lattice[indicesinternalE8,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE8,:] - vel[indicesinternalE8 + 2,:]),(((lattice[indicesinternalE8 + 2,7:9] - lattice[indicesinternalE8,7:9])) / (sqrt(sum((lattice[indicesinternalE8 + 2,7:9] - lattice[indicesinternalE8,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE8 + 2,7:9] - lattice[indicesinternalE8,7:9])) / (sqrt(sum((lattice[indicesinternalE8 + 2,7:9] - lattice[indicesinternalE8,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE8 - dot(2,Nx),7:9] + lattice[indicesinternalE8,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE8,:] - vel[indicesinternalE8 - dot(2,Nx),:]),(((lattice[indicesinternalE8 - dot(2,Nx),7:9] - lattice[indicesinternalE8,7:9])) / (sqrt(sum((lattice[indicesinternalE8 - dot(2,Nx),7:9] - lattice[indicesinternalE8,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE8 - dot(2,Nx),7:9] - lattice[indicesinternalE8,7:9])) / (sqrt(sum((lattice[indicesinternalE8 - dot(2,Nx),7:9] - lattice[indicesinternalE8,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE8 + dot(dot(2,Nx),Ny),7:9] + lattice[indicesinternalE8,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE8,:] - vel[indicesinternalE8 + dot(dot(2,Nx),Ny),:]),(((lattice[indicesinternalE8 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE8,7:9])) / (sqrt(sum((lattice[indicesinternalE8 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE8,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE8 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE8,7:9])) / (sqrt(sum((lattice[indicesinternalE8 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE8,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE8 - dot(dot(2,Nx),Ny),7:9] + lattice[indicesinternalE8,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE8,:] - vel[indicesinternalE8 - dot(dot(2,Nx),Ny),:]),(((lattice[indicesinternalE8 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE8,7:9])) / (sqrt(sum((lattice[indicesinternalE8 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE8,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE8 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE8,7:9])) / (sqrt(sum((lattice[indicesinternalE8 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE8,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesinternalE9,:]=Dfuncp[indicesinternalE9,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE9 + 2,7:9] + lattice[indicesinternalE9,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE9,:] - vel[indicesinternalE9 + 2,:]),(((lattice[indicesinternalE9 + 2,7:9] - lattice[indicesinternalE9,7:9])) / (sqrt(sum((lattice[indicesinternalE9 + 2,7:9] - lattice[indicesinternalE9,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE9 + 2,7:9] - lattice[indicesinternalE9,7:9])) / (sqrt(sum((lattice[indicesinternalE9 + 2,7:9] - lattice[indicesinternalE9,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE9 - 2,7:9] + lattice[indicesinternalE9,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE9,:] - vel[indicesinternalE9 - 2,:]),(((lattice[indicesinternalE9 - 2,7:9] - lattice[indicesinternalE9,7:9])) / (sqrt(sum((lattice[indicesinternalE9 - 2,7:9] - lattice[indicesinternalE9,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE9 - 2,7:9] - lattice[indicesinternalE9,7:9])) / (sqrt(sum((lattice[indicesinternalE9 - 2,7:9] - lattice[indicesinternalE9,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE9 + dot(2,Nx),7:9] + lattice[indicesinternalE9,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE9,:] - vel[indicesinternalE9 + dot(2,Nx),:]),(((lattice[indicesinternalE9 + dot(2,Nx),7:9] - lattice[indicesinternalE9,7:9])) / (sqrt(sum((lattice[indicesinternalE9 + dot(2,Nx),7:9] - lattice[indicesinternalE9,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE9 + dot(2,Nx),7:9] - lattice[indicesinternalE9,7:9])) / (sqrt(sum((lattice[indicesinternalE9 + dot(2,Nx),7:9] - lattice[indicesinternalE9,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE9 - dot(dot(2,Nx),Ny),7:9] + lattice[indicesinternalE9,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE9,:] - vel[indicesinternalE9 - dot(dot(2,Nx),Ny),:]),(((lattice[indicesinternalE9 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE9,7:9])) / (sqrt(sum((lattice[indicesinternalE9 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE9,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE9 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE9,7:9])) / (sqrt(sum((lattice[indicesinternalE9 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE9,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesinternalE10,:]=Dfuncp[indicesinternalE10,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE10 - 2,7:9] + lattice[indicesinternalE10,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE10,:] - vel[indicesinternalE10 - 2,:]),(((lattice[indicesinternalE10 - 2,7:9] - lattice[indicesinternalE10,7:9])) / (sqrt(sum((lattice[indicesinternalE10 - 2,7:9] - lattice[indicesinternalE10,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE10 - 2,7:9] - lattice[indicesinternalE10,7:9])) / (sqrt(sum((lattice[indicesinternalE10 - 2,7:9] - lattice[indicesinternalE10,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE10 + dot(2,Nx),7:9] + lattice[indicesinternalE10,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE10,:] - vel[indicesinternalE10 + dot(2,Nx),:]),(((lattice[indicesinternalE10 + dot(2,Nx),7:9] - lattice[indicesinternalE10,7:9])) / (sqrt(sum((lattice[indicesinternalE10 + dot(2,Nx),7:9] - lattice[indicesinternalE10,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE10 + dot(2,Nx),7:9] - lattice[indicesinternalE10,7:9])) / (sqrt(sum((lattice[indicesinternalE10 + dot(2,Nx),7:9] - lattice[indicesinternalE10,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE10 - dot(2,Nx),7:9] + lattice[indicesinternalE10,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE10,:] - vel[indicesinternalE10 - dot(2,Nx),:]),(((lattice[indicesinternalE10 - dot(2,Nx),7:9] - lattice[indicesinternalE10,7:9])) / (sqrt(sum((lattice[indicesinternalE10 - dot(2,Nx),7:9] - lattice[indicesinternalE10,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE10 - dot(2,Nx),7:9] - lattice[indicesinternalE10,7:9])) / (sqrt(sum((lattice[indicesinternalE10 - dot(2,Nx),7:9] - lattice[indicesinternalE10,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE10 - dot(dot(2,Nx),Ny),7:9] + lattice[indicesinternalE10,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE10,:] - vel[indicesinternalE10 - dot(dot(2,Nx),Ny),:]),(((lattice[indicesinternalE10 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE10,7:9])) / (sqrt(sum((lattice[indicesinternalE10 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE10,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE10 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE10,7:9])) / (sqrt(sum((lattice[indicesinternalE10 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE10,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesinternalE11,:]=Dfuncp[indicesinternalE11,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE11 + 2,7:9] + lattice[indicesinternalE11,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE11,:] - vel[indicesinternalE11 + 2,:]),(((lattice[indicesinternalE11 + 2,7:9] - lattice[indicesinternalE11,7:9])) / (sqrt(sum((lattice[indicesinternalE11 + 2,7:9] - lattice[indicesinternalE11,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE11 + 2,7:9] - lattice[indicesinternalE11,7:9])) / (sqrt(sum((lattice[indicesinternalE11 + 2,7:9] - lattice[indicesinternalE11,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE11 - 2,7:9] + lattice[indicesinternalE11,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE11,:] - vel[indicesinternalE11 - 2,:]),(((lattice[indicesinternalE11 - 2,7:9] - lattice[indicesinternalE11,7:9])) / (sqrt(sum((lattice[indicesinternalE11 - 2,7:9] - lattice[indicesinternalE11,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE11 - 2,7:9] - lattice[indicesinternalE11,7:9])) / (sqrt(sum((lattice[indicesinternalE11 - 2,7:9] - lattice[indicesinternalE11,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE11 - dot(2,Nx),7:9] + lattice[indicesinternalE11,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE11,:] - vel[indicesinternalE11 - dot(2,Nx),:]),(((lattice[indicesinternalE11 - dot(2,Nx),7:9] - lattice[indicesinternalE11,7:9])) / (sqrt(sum((lattice[indicesinternalE11 - dot(2,Nx),7:9] - lattice[indicesinternalE11,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE11 - dot(2,Nx),7:9] - lattice[indicesinternalE11,7:9])) / (sqrt(sum((lattice[indicesinternalE11 - dot(2,Nx),7:9] - lattice[indicesinternalE11,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE11 - dot(dot(2,Nx),Ny),7:9] + lattice[indicesinternalE11,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE11,:] - vel[indicesinternalE11 - dot(dot(2,Nx),Ny),:]),(((lattice[indicesinternalE11 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE11,7:9])) / (sqrt(sum((lattice[indicesinternalE11 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE11,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE11 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE11,7:9])) / (sqrt(sum((lattice[indicesinternalE11 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE11,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesinternalE12,:]=Dfuncp[indicesinternalE12,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE12 + 2,7:9] + lattice[indicesinternalE12,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE12,:] - vel[indicesinternalE12 + 2,:]),(((lattice[indicesinternalE12 + 2,7:9] - lattice[indicesinternalE12,7:9])) / (sqrt(sum((lattice[indicesinternalE12 + 2,7:9] - lattice[indicesinternalE12,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE12 + 2,7:9] - lattice[indicesinternalE12,7:9])) / (sqrt(sum((lattice[indicesinternalE12 + 2,7:9] - lattice[indicesinternalE12,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE12 + dot(2,Nx),7:9] + lattice[indicesinternalE12,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE12,:] - vel[indicesinternalE12 + dot(2,Nx),:]),(((lattice[indicesinternalE12 + dot(2,Nx),7:9] - lattice[indicesinternalE12,7:9])) / (sqrt(sum((lattice[indicesinternalE12 + dot(2,Nx),7:9] - lattice[indicesinternalE12,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE12 + dot(2,Nx),7:9] - lattice[indicesinternalE12,7:9])) / (sqrt(sum((lattice[indicesinternalE12 + dot(2,Nx),7:9] - lattice[indicesinternalE12,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE12 - dot(2,Nx),7:9] + lattice[indicesinternalE12,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE12,:] - vel[indicesinternalE12 - dot(2,Nx),:]),(((lattice[indicesinternalE12 - dot(2,Nx),7:9] - lattice[indicesinternalE12,7:9])) / (sqrt(sum((lattice[indicesinternalE12 - dot(2,Nx),7:9] - lattice[indicesinternalE12,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE12 - dot(2,Nx),7:9] - lattice[indicesinternalE12,7:9])) / (sqrt(sum((lattice[indicesinternalE12 - dot(2,Nx),7:9] - lattice[indicesinternalE12,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalE12 - dot(dot(2,Nx),Ny),7:9] + lattice[indicesinternalE12,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalE12,:] - vel[indicesinternalE12 - dot(dot(2,Nx),Ny),:]),(((lattice[indicesinternalE12 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE12,7:9])) / (sqrt(sum((lattice[indicesinternalE12 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE12,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalE12 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE12,7:9])) / (sqrt(sum((lattice[indicesinternalE12 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalE12,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesinternalC1,:]=Dfuncp[indicesinternalC1,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalC1 + 2,7:9] + lattice[indicesinternalC1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalC1,:] - vel[indicesinternalC1 + 2,:]),(((lattice[indicesinternalC1 + 2,7:9] - lattice[indicesinternalC1,7:9])) / (sqrt(sum((lattice[indicesinternalC1 + 2,7:9] - lattice[indicesinternalC1,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalC1 + 2,7:9] - lattice[indicesinternalC1,7:9])) / (sqrt(sum((lattice[indicesinternalC1 + 2,7:9] - lattice[indicesinternalC1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalC1 + dot(2,Nx),7:9] + lattice[indicesinternalC1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalC1,:] - vel[indicesinternalC1 + dot(2,Nx),:]),(((lattice[indicesinternalC1 + dot(2,Nx),7:9] - lattice[indicesinternalC1,7:9])) / (sqrt(sum((lattice[indicesinternalC1 + dot(2,Nx),7:9] - lattice[indicesinternalC1,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalC1 + dot(2,Nx),7:9] - lattice[indicesinternalC1,7:9])) / (sqrt(sum((lattice[indicesinternalC1 + dot(2,Nx),7:9] - lattice[indicesinternalC1,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalC1 + dot(dot(2,Nx),Ny),7:9] + lattice[indicesinternalC1,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalC1,:] - vel[indicesinternalC1 + dot(dot(2,Nx),Ny),:]),(((lattice[indicesinternalC1 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalC1,7:9])) / (sqrt(sum((lattice[indicesinternalC1 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalC1,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalC1 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalC1,7:9])) / (sqrt(sum((lattice[indicesinternalC1 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalC1,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesinternalC2,:]=Dfuncp[indicesinternalC2,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalC2 - 2,7:9] + lattice[indicesinternalC2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalC2,:] - vel[indicesinternalC2 - 2,:]),(((lattice[indicesinternalC2 - 2,7:9] - lattice[indicesinternalC2,7:9])) / (sqrt(sum((lattice[indicesinternalC2 - 2,7:9] - lattice[indicesinternalC2,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalC2 - 2,7:9] - lattice[indicesinternalC2,7:9])) / (sqrt(sum((lattice[indicesinternalC2 - 2,7:9] - lattice[indicesinternalC2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalC2 + dot(2,Nx),7:9] + lattice[indicesinternalC2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalC2,:] - vel[indicesinternalC2 + dot(2,Nx),:]),(((lattice[indicesinternalC2 + dot(2,Nx),7:9] - lattice[indicesinternalC2,7:9])) / (sqrt(sum((lattice[indicesinternalC2 + dot(2,Nx),7:9] - lattice[indicesinternalC2,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalC2 + dot(2,Nx),7:9] - lattice[indicesinternalC2,7:9])) / (sqrt(sum((lattice[indicesinternalC2 + dot(2,Nx),7:9] - lattice[indicesinternalC2,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalC2 + dot(dot(2,Nx),Ny),7:9] + lattice[indicesinternalC2,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalC2,:] - vel[indicesinternalC2 + dot(dot(2,Nx),Ny),:]),(((lattice[indicesinternalC2 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalC2,7:9])) / (sqrt(sum((lattice[indicesinternalC2 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalC2,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalC2 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalC2,7:9])) / (sqrt(sum((lattice[indicesinternalC2 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalC2,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesinternalC3,:]=Dfuncp[indicesinternalC3,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalC3 - 2,7:9] + lattice[indicesinternalC3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalC3,:] - vel[indicesinternalC3 - 2,:]),(((lattice[indicesinternalC3 - 2,7:9] - lattice[indicesinternalC3,7:9])) / (sqrt(sum((lattice[indicesinternalC3 - 2,7:9] - lattice[indicesinternalC3,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalC3 - 2,7:9] - lattice[indicesinternalC3,7:9])) / (sqrt(sum((lattice[indicesinternalC3 - 2,7:9] - lattice[indicesinternalC3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalC3 - dot(2,Nx),7:9] + lattice[indicesinternalC3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalC3,:] - vel[indicesinternalC3 - dot(2,Nx),:]),(((lattice[indicesinternalC3 - dot(2,Nx),7:9] - lattice[indicesinternalC3,7:9])) / (sqrt(sum((lattice[indicesinternalC3 - dot(2,Nx),7:9] - lattice[indicesinternalC3,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalC3 - dot(2,Nx),7:9] - lattice[indicesinternalC3,7:9])) / (sqrt(sum((lattice[indicesinternalC3 - dot(2,Nx),7:9] - lattice[indicesinternalC3,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalC3 + dot(dot(2,Nx),Ny),7:9] + lattice[indicesinternalC3,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalC3,:] - vel[indicesinternalC3 + dot(dot(2,Nx),Ny),:]),(((lattice[indicesinternalC3 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalC3,7:9])) / (sqrt(sum((lattice[indicesinternalC3 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalC3,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalC3 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalC3,7:9])) / (sqrt(sum((lattice[indicesinternalC3 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalC3,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesinternalC4,:]=Dfuncp[indicesinternalC4,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalC4 + 2,7:9] + lattice[indicesinternalC4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalC4,:] - vel[indicesinternalC4 + 2,:]),(((lattice[indicesinternalC4 + 2,7:9] - lattice[indicesinternalC4,7:9])) / (sqrt(sum((lattice[indicesinternalC4 + 2,7:9] - lattice[indicesinternalC4,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalC4 + 2,7:9] - lattice[indicesinternalC4,7:9])) / (sqrt(sum((lattice[indicesinternalC4 + 2,7:9] - lattice[indicesinternalC4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalC4 - dot(2,Nx),7:9] + lattice[indicesinternalC4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalC4,:] - vel[indicesinternalC4 - dot(2,Nx),:]),(((lattice[indicesinternalC4 - dot(2,Nx),7:9] - lattice[indicesinternalC4,7:9])) / (sqrt(sum((lattice[indicesinternalC4 - dot(2,Nx),7:9] - lattice[indicesinternalC4,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalC4 - dot(2,Nx),7:9] - lattice[indicesinternalC4,7:9])) / (sqrt(sum((lattice[indicesinternalC4 - dot(2,Nx),7:9] - lattice[indicesinternalC4,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalC4 + dot(dot(2,Nx),Ny),7:9] + lattice[indicesinternalC4,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalC4,:] - vel[indicesinternalC4 + dot(dot(2,Nx),Ny),:]),(((lattice[indicesinternalC4 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalC4,7:9])) / (sqrt(sum((lattice[indicesinternalC4 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalC4,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalC4 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalC4,7:9])) / (sqrt(sum((lattice[indicesinternalC4 + dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalC4,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesinternalC5,:]=Dfuncp[indicesinternalC5,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalC5 + 2,7:9] + lattice[indicesinternalC5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalC5,:] - vel[indicesinternalC5 + 2,:]),(((lattice[indicesinternalC5 + 2,7:9] - lattice[indicesinternalC5,7:9])) / (sqrt(sum((lattice[indicesinternalC5 + 2,7:9] - lattice[indicesinternalC5,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalC5 + 2,7:9] - lattice[indicesinternalC5,7:9])) / (sqrt(sum((lattice[indicesinternalC5 + 2,7:9] - lattice[indicesinternalC5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalC5 + dot(2,Nx),7:9] + lattice[indicesinternalC5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalC5,:] - vel[indicesinternalC5 + dot(2,Nx),:]),(((lattice[indicesinternalC5 + dot(2,Nx),7:9] - lattice[indicesinternalC5,7:9])) / (sqrt(sum((lattice[indicesinternalC5 + dot(2,Nx),7:9] - lattice[indicesinternalC5,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalC5 + dot(2,Nx),7:9] - lattice[indicesinternalC5,7:9])) / (sqrt(sum((lattice[indicesinternalC5 + dot(2,Nx),7:9] - lattice[indicesinternalC5,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalC5 - dot(dot(2,Nx),Ny),7:9] + lattice[indicesinternalC5,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalC5,:] - vel[indicesinternalC5 - dot(dot(2,Nx),Ny),:]),(((lattice[indicesinternalC5 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalC5,7:9])) / (sqrt(sum((lattice[indicesinternalC5 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalC5,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalC5 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalC5,7:9])) / (sqrt(sum((lattice[indicesinternalC5 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalC5,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesinternalC6,:]=Dfuncp[indicesinternalC6,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalC6 - 2,7:9] + lattice[indicesinternalC6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalC6,:] - vel[indicesinternalC6 - 2,:]),(((lattice[indicesinternalC6 - 2,7:9] - lattice[indicesinternalC6,7:9])) / (sqrt(sum((lattice[indicesinternalC6 - 2,7:9] - lattice[indicesinternalC6,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalC6 - 2,7:9] - lattice[indicesinternalC6,7:9])) / (sqrt(sum((lattice[indicesinternalC6 - 2,7:9] - lattice[indicesinternalC6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalC6 + dot(2,Nx),7:9] + lattice[indicesinternalC6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalC6,:] - vel[indicesinternalC6 + dot(2,Nx),:]),(((lattice[indicesinternalC6 + dot(2,Nx),7:9] - lattice[indicesinternalC6,7:9])) / (sqrt(sum((lattice[indicesinternalC6 + dot(2,Nx),7:9] - lattice[indicesinternalC6,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalC6 + dot(2,Nx),7:9] - lattice[indicesinternalC6,7:9])) / (sqrt(sum((lattice[indicesinternalC6 + dot(2,Nx),7:9] - lattice[indicesinternalC6,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalC6 - dot(dot(2,Nx),Ny),7:9] + lattice[indicesinternalC6,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalC6,:] - vel[indicesinternalC6 - dot(dot(2,Nx),Ny),:]),(((lattice[indicesinternalC6 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalC6,7:9])) / (sqrt(sum((lattice[indicesinternalC6 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalC6,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalC6 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalC6,7:9])) / (sqrt(sum((lattice[indicesinternalC6 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalC6,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesinternalC7,:]=Dfuncp[indicesinternalC7,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalC7 - 2,7:9] + lattice[indicesinternalC7,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalC7,:] - vel[indicesinternalC7 - 2,:]),(((lattice[indicesinternalC7 - 2,7:9] - lattice[indicesinternalC7,7:9])) / (sqrt(sum((lattice[indicesinternalC7 - 2,7:9] - lattice[indicesinternalC7,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalC7 - 2,7:9] - lattice[indicesinternalC7,7:9])) / (sqrt(sum((lattice[indicesinternalC7 - 2,7:9] - lattice[indicesinternalC7,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalC7 - dot(2,Nx),7:9] + lattice[indicesinternalC7,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalC7,:] - vel[indicesinternalC7 - dot(2,Nx),:]),(((lattice[indicesinternalC7 - dot(2,Nx),7:9] - lattice[indicesinternalC7,7:9])) / (sqrt(sum((lattice[indicesinternalC7 - dot(2,Nx),7:9] - lattice[indicesinternalC7,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalC7 - dot(2,Nx),7:9] - lattice[indicesinternalC7,7:9])) / (sqrt(sum((lattice[indicesinternalC7 - dot(2,Nx),7:9] - lattice[indicesinternalC7,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalC7 - dot(dot(2,Nx),Ny),7:9] + lattice[indicesinternalC7,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalC7,:] - vel[indicesinternalC7 - dot(dot(2,Nx),Ny),:]),(((lattice[indicesinternalC7 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalC7,7:9])) / (sqrt(sum((lattice[indicesinternalC7 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalC7,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalC7 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalC7,7:9])) / (sqrt(sum((lattice[indicesinternalC7 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalC7,7:9]) ** 2,2)))))) ** 2,2))
    Dfuncp[indicesinternalC8,:]=Dfuncp[indicesinternalC8,:] + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalC8 + 2,7:9] + lattice[indicesinternalC8,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalC8,:] - vel[indicesinternalC8 + 2,:]),(((lattice[indicesinternalC8 + 2,7:9] - lattice[indicesinternalC8,7:9])) / (sqrt(sum((lattice[indicesinternalC8 + 2,7:9] - lattice[indicesinternalC8,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalC8 + 2,7:9] - lattice[indicesinternalC8,7:9])) / (sqrt(sum((lattice[indicesinternalC8 + 2,7:9] - lattice[indicesinternalC8,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalC8 - dot(2,Nx),7:9] + lattice[indicesinternalC8,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalC8,:] - vel[indicesinternalC8 - dot(2,Nx),:]),(((lattice[indicesinternalC8 - dot(2,Nx),7:9] - lattice[indicesinternalC8,7:9])) / (sqrt(sum((lattice[indicesinternalC8 - dot(2,Nx),7:9] - lattice[indicesinternalC8,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalC8 - dot(2,Nx),7:9] - lattice[indicesinternalC8,7:9])) / (sqrt(sum((lattice[indicesinternalC8 - dot(2,Nx),7:9] - lattice[indicesinternalC8,7:9]) ** 2,2)))))) ** 2,2)) + multiply(dot(0.5,dbehandle[multiply(0.5,(lattice[indicesinternalC8 - dot(dot(2,Nx),Ny),7:9] + lattice[indicesinternalC8,7:9])),t]),sum((multiply(sum((multiply((vel[indicesinternalC8,:] - vel[indicesinternalC8 - dot(dot(2,Nx),Ny),:]),(((lattice[indicesinternalC8 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalC8,7:9])) / (sqrt(sum((lattice[indicesinternalC8 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalC8,7:9]) ** 2,2)))))),2),(((lattice[indicesinternalC8 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalC8,7:9])) / (sqrt(sum((lattice[indicesinternalC8 - dot(dot(2,Nx),Ny),7:9] - lattice[indicesinternalC8,7:9]) ** 2,2)))))) ** 2,2))
    ##
    
    Dfunc=sum(Dfuncp)
    return Dfuncp,Dfunc